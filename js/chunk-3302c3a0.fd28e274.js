(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3302c3a0"],{"0167":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"report-form full working-hours"},[t("div",{staticClass:"report-form-inner"},[t("div",{staticClass:"report-form-inner-header",staticStyle:{height:"35px"}},[t("div",{staticClass:"f_left"},[t("MultiChoiceVehicle",{on:{onSelectDevice:e.onSelectDevice}})],1),t("div",{staticClass:"f_left"},[t("SelectDate",{attrs:{dateType:"datetimerange"},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),t("div",{staticClass:"f_left"},[t("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.handleQuery}},[e._v(e._s(e.$t("common.query")))])],1),t("div",{staticClass:"f_left"},[t("el-popover",{attrs:{placement:"bottom",width:"236",trigger:"click"}},[t("div",[t("el-button",{staticStyle:{width:"100px"},attrs:{slot:"reference",type:"primary",plain:"",loading:e.exportLoading1},on:{click:e.exportData},slot:"reference"},[e._v(e._s(e.$t("common.summary")))]),t("el-button",{staticStyle:{width:"100px"},attrs:{slot:"reference",type:"primary",loading:e.exportLoading2,plain:""},on:{click:e.exportDetailData},slot:"reference"},[e._v(e._s(e.$t("reportForm.detailed")))])],1),t("el-button",{attrs:{slot:"reference",type:"primary"},slot:"reference"},[e._v(e._s(e.$t("common.export")))])],1)],1)]),t("div",{staticClass:"report-form-inner-content",staticStyle:{top:"45px"},attrs:{"auto-resize":""}},[t("vxe-table",{ref:"xTable",attrs:{"sort-config":e.sortConfig,"menu-config":e.tableMenu,border:"",resizable:"","show-overflow":"","highlight-hover-row":"",size:"mini",height:"auto",data:e.totalList},on:{"menu-click":e.handleClickTableMenu}},[t("vxe-table-column",{attrs:{type:"seq",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{title:e.$t("reportForm.action"),width:"80"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleClickRow(a.row)}}},[e._v(e._s(e.$t("reportForm.calendar")))])],1)]}}])}),t("vxe-table-column",{attrs:{type:"expand",width:"36"},scopedSlots:e._u([{key:"content",fn:function(a){var r=a.row;a.rowIndex;return[[t("div",{staticStyle:{"padding-left":"60px"}},[t("vxe-table",{staticClass:"mytable-scrollbar",attrs:{"menu-config":e.tableMenu,border:"",resizable:"","auto-resize":"",height:r.tableHeight,"show-overflow":"","highlight-hover-row":"",size:"mini",data:r.days},on:{"menu-click":e.handleClickTableMenu}},[t("vxe-table-column",{attrs:{field:"statisticsday",width:"120",title:e.$t("reportForm.date")}}),t("vxe-table-column",{attrs:{field:"totaldistance",align:"right",formatter:e.numberToFixed2,title:e.$t("reportForm.mileage"),sortable:""}}),t("vxe-table-column",{attrs:{field:"totalacc",align:"right",formatter:e.numberToFixed2,title:e.$t("reportForm.workingDuration")+"(H)",sortable:""}}),t("vxe-table-column",{attrs:{field:"avgspeed",align:"right",formatter:e.numberToFixed2,title:e.$t("reportForm.avgSpeed"),sortable:""}})],1)],1)]]}}])}),t("vxe-table-column",{attrs:{field:"devicename",title:e.$t("alarm.devName"),sortable:""}}),t("vxe-table-column",{attrs:{field:"deviceid",title:e.$t("alarm.devNum"),sortable:""}}),t("vxe-table-column",{attrs:{field:"creater",title:e.$t("reportForm.creater"),sortable:""},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{attrs:{placement:"bottom",trigger:"click"}},[t("div",{staticClass:"parents-wrapper"},e._l(e.parentsList,(function(a){return t("div",{key:a.username},[e._v(e._s(a.username)+"("+e._s(a.usertypeStr)+")")])})),0),t("el-button",{staticStyle:{color:"#000000"},attrs:{slot:"reference",type:"text"},on:{click:function(t){return e.queryParents(a.row.creater)}},slot:"reference"},[e._v(e._s(a.row.creater))])],1)]}}])}),t("vxe-table-column",{attrs:{field:"groupname",title:e.$t("reportForm.groupName"),sortable:""}}),t("vxe-table-column",{attrs:{field:"totaldistance",align:"right",formatter:e.numberToFixed2,title:e.$t("reportForm.mileage"),sortable:""}}),t("vxe-table-column",{attrs:{field:"totalacc",align:"right",formatter:e.numberToFixed2,title:e.$t("reportForm.workingDuration")+"(H)",sortable:""}}),t("vxe-table-column",{attrs:{field:"avgspeed",align:"right",formatter:e.numberToFixed2,title:e.$t("reportForm.avgSpeed"),sortable:""}})],1)],1)]),t("WorkingHoursCalendar",{ref:"calendar",model:{value:e.calendarDialog,callback:function(t){e.calendarDialog=t},expression:"calendarDialog"}})],1)},o=[],i=(a("14d9"),a("d3b7"),a("159b"),a("4795"),a("e561")),s=a("d462"),n=a("2584"),l=a("5101"),c=a("1c31"),d=a("6e52"),u=a("4c3c"),m=a("a05b"),p=a("0c87"),h=a("c276"),g={name:"workingHours",data:function(){return{dateRange:[new Date(l["a"].format(new Date,"yyyy-MM-dd")+" 00:00:00"),new Date(l["a"].format(new Date,"yyyy-MM-dd")+" 23:59:59")],loading:!1,calendarDialog:!1,exportLoading1:!1,exportLoading2:!1,totalList:[],chartDataList:[]}},mixins:[u["a"],m["a"],p["a"]],components:{MultiChoiceVehicle:i["a"],SelectDate:s["a"],WorkingHoursCalendar:n["a"]},watch:{dateRange:function(){this.loading||this.handleQuery()}},methods:{numberToFixed2:h["nb"],handleClickRow:function(e){var t=this;this.calendarDialog=!0,setTimeout((function(){t.$refs.calendar.setDeviceId(e.deviceid)}),300)},onSelectDevice:function(e){this.deviceids=e},handleQuery:function(){var e=this,t=this.deviceids,a=this.dateRange;if(0!=t.length)if(0!=a.length){this.loading=!0;var r=l["a"].format(a[0],"yyyy-MM-dd HH:mm:ss"),o=l["a"].format(a[1],"yyyy-MM-dd HH:mm:ss"),i={begintime:r,endtime:o,offset:l["a"].getOffset(),deviceids:t};Object(c["Z"])(i).then((function(t){var a=t.records,i=t.status;e.queryDateRange=r+"  -  "+o;var s=[];0==i?a.forEach((function(e){var t=e.deviceid,a=e.days,r=e.summary,o=d["a"].deviceInfos[t];r.deviceid=t,r.devicename=d["a"].getDeviceNameByDeviceId(t),r.creater=d["a"].getShowName(o.creater),r.groupname=o.groupname;var i=r.totalacc/1e3/3600;r.totaldistance=r.totaldistance/1e3,r.totalacc=i,r.avgspeed=r.avgspeed,r.days=a,r.tableHeight=0==a.length?72:36*a.length+36,a.forEach((function(e){e.deviceid=t,e.devicename=r.devicename;var a=e.totalacc/1e3/3600,o=e.totalidle/1e3/3600;e.totaldistance=e.totaldistance/1e3,e.totalacc=a,e.totalidle=o,e.avgspeed=e.avgspeed})),s.push(r)})):1==i?e.$XModal.message({message:e.$t("tips.deviceExceeds100"),status:"error",zIndex:9999}):2==i&&e.$XModal.message({message:e.$t("tips.dayExceeds2"),status:"error",zIndex:9999}),e.loading=!1,e.totalList=s,1==s.length&&e.$refs.xTable.setRowExpand(s[0],!0)}))}else this.$XModal.message({message:this.$t("tips.selectTime"),status:"error",zIndex:9999});else this.$XModal.message({message:this.$t("tips.selectDevice"),status:"error",zIndex:9999})},exportData:function(){if(0!=this.totalList.length){var e=[[this.$t("reportForm.index"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("reportForm.creater"),this.$t("reportForm.groupName"),this.$t("reportForm.mileage"),this.$t("reportForm.workingDuration")+"(H)",this.$t("reportForm.avgSpeed")]];this.totalList.forEach((function(t,a){var r=[];r.push(a+1),r.push(t.devicename),r.push(t.deviceid),r.push(t.creater),r.push(t.groupname),r.push(Object(h["nb"])(t.totaldistance)),r.push(Object(h["nb"])(t.totalacc)),r.push(Object(h["nb"])(t.avgspeed)),e.push(r)}));var t={title:this.$t("reportForm.workingHours")+"_"+this.$t("common.summary"),data:e,dateRange:this.queryDateRange};this.exportLoading1=!0,new ExcelCls(t).exportExcel(this)}},exportDetailData:function(){if(0!=this.totalList.length){var e=[[this.$t("reportForm.index"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("reportForm.creater"),this.$t("reportForm.groupName"),this.$t("reportForm.date"),this.$t("reportForm.mileage"),this.$t("reportForm.workingDuration")+"(H)",this.$t("reportForm.avgSpeed")]];this.totalList.forEach((function(t,a){t.days.forEach((function(a,r){var o=[];o.push(r+1),o.push(t.devicename),o.push(t.deviceid),o.push(t.creater),o.push(t.groupname),o.push(a.statisticsday),o.push(Object(h["nb"])(a.totaldistance)),o.push(Object(h["nb"])(a.totalacc)),o.push(Object(h["nb"])(a.avgspeed)),e.push(o)}));var r=[];r.push(""),r.push(""),r.push(""),r.push(""),r.push(""),r.push(""),r.push(Object(h["nb"])(t.totaldistance)),r.push(Object(h["nb"])(t.totalacc)),r.push(Object(h["nb"])(t.avgspeed)),e.push(r)}));var t={title:this.$t("reportForm.workingHours")+"_"+this.$t("reportForm.detailed"),data:e,dateRange:this.queryDateRange};this.exportLoading2=!0,new ExcelCls(t).exportExcel(this)}}},mounted:function(){this.deviceids=[]}},v=g,f=(a("c835e"),a("2877")),b=Object(f["a"])(v,r,o,!1,null,null,null),x=b.exports;t["default"]=x},"9dfd":function(e,t,a){},c835e:function(e,t,a){"use strict";a("9dfd")}}]);