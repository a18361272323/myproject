(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cbb098fc"],{"17f2":function(t,e,i){"use strict";i("6d43")},"3fee":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"report-form full"},[e("div",{staticClass:"report-form-inner"},[e("div",{staticClass:"report-form-inner-header",staticStyle:{height:"35px"}},[e("div",{staticClass:"f_left"},[e("MultiChoiceVehicle",{on:{onSelectDevice:t.onSelectDevice}})],1),e("div",{staticClass:"f_left",staticStyle:{width:"164px"}},[e("LabelWrap",{attrs:{label:t.$t("common.duration")}},[e("el-select",{model:{value:t.duration,callback:function(e){t.duration=e},expression:"duration"}},t._l(t.optionList,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),e("div",{staticClass:"f_left"},[e("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.handleQuery}},[t._v(t._s(t.$t("common.query")))])],1),e("div",{staticClass:"f_left"},[e("el-button",{attrs:{type:"primary",loading:t.exportLoading1},on:{click:t.exportData}},[t._v(t._s(t.$t("common.export")))])],1),e("div",{staticClass:"f_center"}),e("div",{staticClass:"f_right"},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.importDialog=!0}}},[t._v(t._s(t.$t("common.importQuery")))])],1)]),e("div",{staticClass:"report-form-inner-content",staticStyle:{top:"39px"}},[e("vxe-table",{ref:"xTable",staticClass:"mytable-scrollbar",attrs:{"sort-config":t.sortConfig,"menu-config":t.tableMenu,border:"",resizable:"","auto-resize":"","show-overflow":"","highlight-hover-row":"",size:"mini",height:"auto",data:t.totalList},on:{"menu-click":t.handleClickTableMenu}},[e("vxe-table-column",{attrs:{type:"seq",width:"60",title:t.$t("reportForm.index")}}),e("vxe-table-column",{attrs:{field:"creater",title:t.$t("reportForm.creater"),width:"120",sortable:""},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-popover",{attrs:{placement:"bottom",trigger:"click"}},[e("div",{staticClass:"parents-wrapper"},t._l(t.parentsList,(function(i){return e("div",{key:i.username},[t._v(t._s(i.username)+"("+t._s(i.usertypeStr)+")")])})),0),e("el-button",{staticStyle:{color:"#000000"},attrs:{slot:"reference",type:"text"},on:{click:function(e){return t.queryParents(i.row.creater)}},slot:"reference"},[t._v(t._s(i.row.creater))])],1)]}}])}),e("vxe-table-column",{attrs:{field:"groupname",title:t.$t("reportForm.groupName"),width:"120",sortable:""}}),e("vxe-table-column",{attrs:{field:"devicename",title:t.$t("alarm.devName"),width:"120",sortable:""}}),e("vxe-table-column",{attrs:{field:"deviceid",title:t.$t("alarm.devNum"),width:"120",sortable:""}}),e("vxe-table-column",{attrs:{field:"deviceType",title:t.$t("reportForm.deviceType"),width:"120"}}),e("vxe-table-column",{attrs:{field:"updatetimeStr",title:t.$t("reportForm.offlineTime"),width:"145",sortable:""}}),e("vxe-table-column",{attrs:{field:"durationStr",align:"right",title:t.$t("common.duration"),width:"135",sortable:""}}),e("vxe-table-column",{attrs:{field:"sim",title:t.$t("reportForm.sim"),width:"125",sortable:""}}),e("vxe-table-column",{attrs:{field:"strstatus",title:t.$t("reportForm.status"),width:"180",sortable:""}}),e("vxe-table-column",{attrs:{field:"firstloctimeStr",title:t.$t("bgManage.firstloctimeStr"),width:"125",sortable:""}}),e("vxe-table-column",{attrs:{field:"overdueTime",title:t.$t("alarm.expireTime"),width:"125",sortable:""}}),e("vxe-table-column",{attrs:{field:"simiccid",title:"ICCID",width:"180",sortable:""}}),e("vxe-table-column",{attrs:{field:"remark",title:t.$t("reportForm.remarks"),width:"145",sortable:""}})],1)],1)]),e("ImportDeviceidsDialog",{on:{"on-import":t.onImportDevice},model:{value:t.importDialog,callback:function(e){t.importDialog=e},expression:"importDialog"}})],1)},r=[],s=i("5530"),o=(i("14d9"),i("4e82"),i("a9e3"),i("d3b7"),i("159b"),i("e561")),n=i("201d"),l=i("5bca"),c=i("1c31"),d=i("6e52"),u=i("5101"),m=i("c276"),p=i("2f62"),h=i("0c87"),v=i("a05b"),f={name:"offlineReport",data:function(){return{loading:!1,importDialog:!1,exportLoading1:!1,duration:"1",optionList:[],totalList:[],sortConfig:{sortMethod:function(t){var e=t.data,i=t.sortList,a=i[0],r=a.property,s=a.order,o=[];return o="durationStr"==r?"desc"===s?e.sort((function(t,e){return e.duration-t.duration})):"asc"===s?e.sort((function(t,e){return t.duration-e.duration})):e.sort():"desc"===s?e.sort((function(t,e){var i=e[r]+"";return i.localeCompare(t[r])})):"asc"===s?e.sort((function(t,e){var i=t[r]+"";return i.localeCompare(e[r])})):e.sort(),o}}}},mixins:[v["a"],h["a"]],components:{MultiChoiceVehicle:o["a"],LabelWrap:n["a"],ImportDeviceidsDialog:l["a"]},computed:Object(s["a"])({},Object(p["b"])(["isZh","deviceTypes"])),methods:{onSelectDevice:function(t){this.deviceids=t},onImportDevice:function(t){var e=this,i=cacheMgr.deviceInfos,a=this.deviceTypes,r=[],s=Object(m["r"])(i),o=s.simMap,n=s.iccidMap;t.forEach((function(t,s){var l=Object(m["lb"])(i,o,n,t);if(l){var c=cacheMgr.lastPositions[l.deviceid];if(c){var p=c.deviceid,h=d["a"].deviceInfos[p],v=h.devicename,f=h.simnum,g=a[h.devicetype].typename,b=0!=h.firstloctime?u["a"].format(new Date(h.firstloctime),"yyyy-MM-dd"):"-",y=u["a"].format(new Date(h.expirenotifytime),"yyyy-MM-dd");r.push({creater:h.creater,groupname:h.groupname,deviceid:p,devicename:v,deviceType:g,updatetimeStr:u["a"].longToLocalDateTimeStr(c.updatetime),duration:u["a"].getCurrentUTC()-c.updatetime,durationStr:Object(m["Hb"])(u["a"].getCurrentUTC()-c.updatetime,!0),strstatus:e.isZh?c.strstatus:c.strstatusen,sim:f,firstloctimeStr:b,overdueTime:y,simiccid:h.simiccid?h.simiccid:"",remark:Object(m["u"])(h)})}}})),this.totalList=r},handleQuery:function(){var t=this,e=this.deviceids;if(e.length>0){this.loading=!0;var i={deviceids:e,offlinehours:Number(this.duration)};Object(c["V"])(i).then((function(e){var i=e.records;t.loading=!1;var a=t.deviceTypes,r=[];i&&i.forEach((function(e){var i=e.deviceid,s=d["a"].deviceInfos[i],o=s.devicename,n=s.simnum,l=a[e.devicetype].typename,c=0!=s.firstloctime?u["a"].format(new Date(s.firstloctime),"yyyy-MM-dd"):"-",p=u["a"].format(new Date(s.expirenotifytime),"yyyy-MM-dd");r.push({creater:s.creater,groupname:s.groupname,deviceid:i,devicename:o,deviceType:l,updatetimeStr:u["a"].longToLocalDateTimeStr(e.updatetime),duration:u["a"].getCurrentUTC()-e.updatetime,durationStr:Object(m["Hb"])(u["a"].getCurrentUTC()-e.updatetime,!0),strstatus:t.isZh?e.strstatus:e.strstatusen,sim:n,firstloctimeStr:c,overdueTime:p,simiccid:s.simiccid?s.simiccid:"",remark:Object(m["u"])(s)})})),t.totalList=r})).catch((function(e){t.loading=!1}))}else this.$XModal.message({message:this.$t("tips.selectDevice"),status:"error",zIndex:9999})},exportData:function(){var t=[[this.$t("reportForm.index"),this.$t("reportForm.creater"),this.$t("reportForm.groupName"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("reportForm.deviceType"),this.$t("reportForm.offlineTime"),this.$t("common.duration"),this.$t("reportForm.sim"),this.$t("reportForm.status"),this.$t("bgManage.firstloctimeStr"),this.$t("alarm.expireTime"),"ICCID",this.$t("reportForm.remarks")]],e=this.$refs.xTable.getTableData().visibleData;if(0!=e.length){e.forEach((function(e,i){var a=[];a.push(i+1),a.push(e.creater),a.push(e.groupname),a.push(e.devicename),a.push(e.deviceid),a.push(e.deviceType),a.push(e.updatetimeStr),a.push(e.durationStr),a.push(e.sim?e.sim:""),a.push(e.strstatus),a.push(e.firstloctimeStr),a.push(e.overdueTime),a.push(e.simiccid),a.push(e.remark),t.push(a)}));var i={title:this.$t("reportForm.offlineReport"),data:t};this.exportLoading1=!0,new ExcelCls(i).exportExcel(this)}}},mounted:function(){var t=this;this.deviceids=[],this.$nextTick((function(){var e=t.$t("monitor.hour"),i=t.$t("reportForm.d");t.optionList=[{label:"1"+e,value:"1"},{label:"6"+e,value:"6"},{label:"12"+e,value:"12"},{label:"1"+i,value:"24"},{label:"7"+i,value:"168"},{label:"15"+i,value:"360"},{label:"30"+i,value:"720"},{label:t.$t("reportForm.halfYear"),value:"4320"},{label:t.$t("reportForm.oneYear"),value:"8760"}]}))}},g=f,b=(i("17f2"),i("2877")),y=Object(b["a"])(g,a,r,!1,null,null,null),$=y.exports;e["default"]=$},"5bca":function(t,e,i){"use strict";var a=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:t.$t("bgManage.importDeviceID")+"/SIM/ICCID",visible:t.value,center:"",width:"560px","append-to-body":"","close-on-click-modal":!1},on:{close:t.handleClose}},[e("TextareaIds",{ref:"textareaIds",on:{"on-change":t.onChange}}),e("el-row",{staticClass:"margin_b10",attrs:{gutter:10}},[e("el-col",{staticStyle:{"text-align":"center"},attrs:{span:8,offset:8}},[e("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:t.loading},on:{click:t.handleClick}},[t._v(t._s(t.$t("common.determine")))])],1)],1)],1)},r=[],s=i("5530"),o=i("2f62"),n=i("9c0e1"),l=i("201d"),c={name:"ImportDeviceidsDialog",props:{value:{type:Boolean,default:!1}},data:function(){return{loading:!1}},components:{TextareaIds:n["a"],LabelWrap:l["a"]},computed:Object(s["a"])({},Object(o["b"])(["isZh"])),methods:{handleClick:function(){this.loading=!0,this.$refs.textareaIds.immediatelyMatching(),this.loading=!1,this.$emit("on-import",this.deviceids),this.handleClose()},handleClose:function(){this.$emit("input",!1)},onChange:function(t){this.deviceids=t,this.loading=!1}},mounted:function(){this.deviceids=[]}},d=c,u=i("2877"),m=Object(u["a"])(d,a,r,!1,null,null,null);e["a"]=m.exports},"6d43":function(t,e,i){},"7d2c":function(t,e,i){"use strict";i("be1c")},"9c0e1":function(t,e,i){"use strict";var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"textarea-ids"},[e("el-row",{attrs:{gutter:10}},[e("el-col",{staticClass:"textarea-ids-red-star",attrs:{span:1}},[t._v("*")]),e("el-col",{attrs:{span:11}},[e("span",[t._v(" "+t._s(t.$t("common.deviceids")))]),t.showTips?t._e():e("span",{attrs:{span:""}},[t._v("/SIM/ICCID")]),t.showTips?e("el-tooltip",{attrs:{placement:"top",effect:"light"}},[e("div",{attrs:{slot:"content"},slot:"content"},[e("div",[t._v(t._s(t.$t("tips.addNewDeviceTip1")))]),e("div",[t._v(t._s(t.$t("tips.addNewDeviceTip2")))]),e("div",[t._v(t._s(t.$t("tips.addNewDeviceTip3")))]),e("div",[t._v(t._s(t.$t("tips.addNewDeviceTip4")))])]),e("i",{staticClass:"el-icon-warning-outline new-add-tips-icon",staticStyle:{position:"relative",top:"-1px"}})]):t._e(),e("div",{staticClass:"tips_clear noselect"},[e("div",{staticClass:"small-clear",on:{click:t.handleClear}},[t._v(t._s(t.$t("tips.clear")))])])],1),e("el-col",{attrs:{span:11}},[e("span",[t._v(t._s(t.$t("reportForm.result")))])])],1),e("el-row",{staticClass:"margin_b10",attrs:{gutter:10}},[e("el-col",{attrs:{span:11,offset:1}},[e("el-input",{attrs:{type:"textarea",autosize:{minRows:10,maxRows:10},rows:10,placeholder:t.textPlaceholder},on:{input:t.onChange},model:{value:t.ids,callback:function(e){t.ids=e},expression:"ids"}})],1),e("el-col",{class:[t.isOk?"correct":"error"],attrs:{span:11}},[e("el-input",{attrs:{type:"textarea",readonly:!0,disabled:"",autosize:{minRows:10,maxRows:10},rows:10},model:{value:t.errorTips,callback:function(e){t.errorTips=e},expression:"errorTips"}})],1)],1)],1)},r=[],s=(i("99af"),i("c975"),i("a15b"),i("14d9"),i("d3b7"),i("ac1f"),i("5319"),i("498a"),i("159b"),i("4795"),i("c276")),o={name:"Temp",props:{showTips:{type:Boolean,default:!1},textPlaceholder:{type:String,default:function(){return this.$t("tips.textareaids")}}},data:function(){return{ids:"",isOk:!1,isMatchingCompletado:!0,errorTips:""}},methods:{handleClear:function(){this.ids="",this.errorTips="",this.isOk=!1,this.isMatchingCompletado=!0,this.$emit("on-change",[])},onChange:function(t){if(""==t)return this.errorTips="",this.isOk=!1,void this.$emit("on-change",[]);t=t.replace(/\s+/g,"\n");var e=/[0-9A-Za-z]/g.exec(t);if(e){this.isMatchingCompletado=!1;var i=e.input;this.matchingDeviceIds(this,i)}else this.errorTips=this.$t("tips.deviceIdTips")},submitFailTips:function(t){var e=this,i="";t.forEach((function(t){var a=t.deviceid,r=t.cause,s=t.status,o=t.creater,n="";n=1==s?null!=o&&o.length>0?e.$t("tips.occupiedUser")+o:e.$t("tips.occupiedOtherUser"):r,i+="".concat(a,":").concat(n,"\n")})),this.errorTips=i,this.isOk=!1},immediatelyMatching:function(){var t=this,e=this.ids;if(t.isMatchingCompletado=!0,e&&e.length>0){var i=t.filtered(e),a=i.length;t.errorTips=t.$t("missing.totalNumber")+" : "+a,t.isOk=!0,t.ids=i.join("\n"),t.$emit("on-change",i)}else t.errorTips=t.$t("missing.adjustDeviceidLength"),t.isOk=!1,t.$emit("on-change",[]);setTimeout((function(){t.isMatchingCompletado=!1}),2e3)},matchingDeviceIds:Object(s["e"])((function(t,e){if(0==t.isMatchingCompletado)if(t.isMatchingCompletado=!0,e&&e.length>0){var i=t.filtered(e),a=i.length;t.errorTips=t.$t("missing.totalNumber")+" : "+a,t.isOk=!0,t.ids=i.join("\n"),console.log("newArr",i),t.$emit("on-change",i)}else t.errorTips=t.$t("missing.adjustDeviceidLength"),t.isOk=!1,t.$emit("on-change",[])}),2e3),filtered:function(t){function e(t){for(var e=[],i=0;i<t.length;i++)-1==e.indexOf(t[i])&&e.push(t[i]);return e}var i=[];return t.split("\n").forEach((function(t){t=t.trim(),t&&i.push(t)})),e(i)}},mounted:function(){}},n=o,l=(i("7d2c"),i("2877")),c=Object(l["a"])(n,a,r,!1,null,null,null);e["a"]=c.exports},be1c:function(t,e,i){},e561:function(t,e,i){"use strict";var a=i("ea22");e["a"]=a["a"]}}]);