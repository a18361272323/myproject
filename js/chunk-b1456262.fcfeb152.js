(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b1456262"],{"676b":function(e,t,i){"use strict";i("6aba")},"6aba":function(e,t,i){},a2dd:function(e,t,i){"use strict";i("c8e1")},c8e1:function(e,t,i){},ebbc:function(e,t,i){"use strict";i.r(t);i("c975");var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"expire-mgr full"},[t("div",{staticClass:"expire-mgr-left"},[t("div",{staticClass:"expire-mgr-left-title"},[t("i",{staticClass:"circle"}),t("b",[e._v(e._s(e.$t("common.selectDevice")))])]),t("div",{staticClass:"expire-mgr-left-content"},[t("SearchDeviceZtree",{ref:"deviceZtree",attrs:{showClear:""},on:{onTreeCheck:e.onTreeCheck}})],1)]),t("div",{staticClass:"expire-mgr-right"},[t("div",{staticStyle:{position:"absolute",top:"0px",left:"0px",right:"0px","z-index":"999","border-right":"1px solid #E4E7ED","border-left":"1px solid #E4E7ED","border-top":"1px solid #E4E7ED","overflow-x":"auto","overflow-y":"hidden"}},[t("div",{staticClass:"expire-mgr-right-title"},[t("div",{staticClass:"f_left radio-wrap2",staticStyle:{width:"120px"}},[t("div",[t("div",{staticStyle:{"padding-left":"10px"},on:{click:function(t){return e.handleSelectRadio("0")}}},[t("el-radio",{attrs:{label:"0"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(e._s(e.$t("monitor.all"))+"("+e._s(e.totalCount)+")")])],1),t("div",{staticStyle:{"padding-left":"10px"},on:{click:function(t){return e.handleSelectRadio("-2")}}},[t("el-radio",{attrs:{label:"-2"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(e._s(e.$t("common.notActive"))+"("+e._s(e.notActiveCount)+")")])],1)])]),t("div",{staticClass:"f_left radio-title"},[t("div",[e._v(e._s(e.$t("bgManage.dueSoon")))])]),t("div",{staticClass:"f_left radio-wrap4"},[t("div",{staticStyle:{"padding-top":"14px"}},[t("div",{on:{click:function(t){return e.handleSelectRadio("30")}}},[t("el-radio",{attrs:{label:"30"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(e._s(e.$t("common.within30Days"))+"("+e._s(e.effective30)+")")])],1),t("div",{on:{click:function(t){return e.handleSelectRadio("60")}}},[t("el-radio",{attrs:{label:"60"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(e._s(e.$t("common.within60Days"))+"("+e._s(e.effective60)+")")])],1),t("div",{on:{click:function(t){return e.handleSelectRadio("90")}}},[t("el-radio",{attrs:{label:"90"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(e._s(e.$t("common.within90Days"))+"("+e._s(e.effective90)+")")])],1)])]),t("div",{staticClass:"f_left radio-title"},[t("div",[e._v(e._s(e.$t("device.expired")))])]),t("div",{staticClass:"f_left radio-wrap4"},[t("div",{staticStyle:{"padding-top":"4px"}},[t("div",{on:{click:function(t){return e.handleSelectRadio("-30")}}},[t("el-radio",{attrs:{label:"-30"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(e._s(e.$t("common.within30Days"))+"("+e._s(e.invalid30)+")")])],1),t("div",{on:{click:function(t){return e.handleSelectRadio("-60")}}},[t("el-radio",{attrs:{label:"-60"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(e._s(e.$t("common.within60Days"))+"("+e._s(e.invalid60)+")")])],1),t("div",{on:{click:function(t){return e.handleSelectRadio("-90")}}},[t("el-radio",{attrs:{label:"-90"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(e._s(e.$t("common.within90Days"))+"("+e._s(e.invalid90)+")")])],1),t("div",{on:{click:function(t){return e.handleSelectRadio("-91")}}},[t("el-radio",{attrs:{label:"-91"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(e._s(e.$t("common.exceed90Days"))+"("+e._s(e.exceed90)+")")])],1)])]),t("div",{staticClass:"f_left",staticStyle:{"margin-left":"10px"}},[t("div",{staticClass:"hover-btn",staticStyle:{"margin-top":"4px"}},[t("el-button",{attrs:{type:"primary"},on:{click:e.handleSettingDate}},[e._v(e._s(e.$t("bgManage.setOverdueTime")))])],1),t("div",{staticClass:"hover-btn",staticStyle:{"margin-top":"4px"}},[t("el-button",{staticStyle:{width:"94px"},attrs:{type:"primary"},on:{click:function(t){e.importDialog=!0}}},[e._v(e._s(e.$t("common.importQuery")))])],1),t("div",{staticClass:"hover-btn",staticStyle:{"margin-top":"4px"}},[t("el-popover",{attrs:{placement:"bottom",width:"236",trigger:"click"}},[t("div",[t("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary",size:"mini",plain:"",loading:e.exportLoading1},on:{click:e.exportAllData}},[e._v(e._s(e.$t("monitor.all")))]),t("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary",size:"mini",plain:"",loading:e.exportLoading2},on:{click:e.exportData}},[e._v(e._s(e.$t("missing.checked")))])],1),t("el-button",{staticStyle:{width:"94px"},attrs:{slot:"reference",size:"mini"},slot:"reference"},[e._v(e._s(e.$t("common.exportData")))])],1)],1)]),t("div",{staticClass:"f_left",staticStyle:{padding:"0px 0px 0px 10px"}},[t("div",{staticClass:"hover-btn",staticStyle:{"padding-top":"4px"}},[t("el-button",{staticStyle:{width:"94px"},attrs:{type:"primary"},on:{click:e.clearTable}},[e._v(e._s(e.$t("common.clearList")))])],1),t("div",{staticClass:"hover-btn",staticStyle:{"padding-top":"4px"}},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.transferDialog=!0}}},[e._v(e._s(e.$t("bgManage.batchTransfer")))])],1)])])]),t("div",{staticClass:"expire-mgr-right-table",staticStyle:{bottom:"40px"}},[t("vxe-table",{ref:"xTable",attrs:{"sort-config":e.sortConfig,"menu-config":e.tableMenu,"auto-resize":"",border:"",resizable:"","show-overflow":"","highlight-hover-row":"","highlight-current-row":"",size:"mini",height:"auto",data:e.tableList},on:{"menu-click":e.handleClickTableMenu,"checkbox-all":e.selectAllEvent,"checkbox-change":e.selectChangeEvent,"cell-click":e.cellclick,"cell-dblclick":e.cellDblclick}},[t("vxe-table-column",{attrs:{type:"checkbox",width:"50"}}),t("vxe-table-column",{attrs:{type:"seq",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{field:"devicename",width:"140",title:e.$t("alarm.devName"),sortable:""}}),t("vxe-table-column",{attrs:{field:"deviceid",width:"140",title:e.$t("alarm.devNum"),sortable:""}}),t("vxe-table-column",{attrs:{field:"simnum",title:e.$t("common.simnum"),sortable:"",width:"140"}}),t("vxe-table-column",{attrs:{field:"roleStr",type:"html",title:e.$t("bgManage.useState"),formatter:e.formatRole,sortable:"",width:"115"}}),e.isHasRecharge?t("vxe-table-column",{attrs:{field:"overdueTime",title:e.$t("alarm.overdueTime"),width:"110",sortable:""}}):e._e(),t("vxe-table-column",{attrs:{field:"expirenotifyTime",title:e.$t("alarm.expireTime"),width:"110",sortable:""}}),t("vxe-table-column",{attrs:{field:"lastValidpoistiontime",title:e.$t("bgManage.lastOnlineTime"),width:"110",sortable:""}}),t("vxe-table-column",{attrs:{field:"firstloctimeStr",title:e.$t("bgManage.firstloctimeStr"),width:"125",sortable:""}}),t("vxe-table-column",{attrs:{field:"createTime",title:e.$t("alarm.createTime"),width:"125",sortable:""}}),t("vxe-table-column",{attrs:{field:"deviceType",title:e.$t("reportForm.deviceType"),width:"115",sortable:""}}),t("vxe-table-column",{attrs:{field:"creater",width:"140",title:e.$t("reportForm.creater"),sortable:""}}),t("vxe-table-column",{attrs:{field:"groupname",width:"120",title:e.$t("reportForm.groupName"),sortable:""}}),t("vxe-table-column",{attrs:{field:"simiccid",title:"ICCID",width:"140"}}),e.permissionList.indexOf("monitor-viewsimdetail")>-1?t("vxe-table-column",{attrs:{title:e.$t("common.simDetail"),width:"85"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleSeeSim(i)}}},[e._v(e._s(e.$t("common.see")))])]}}],null,!1,1974703607)}):e._e(),t("vxe-table-column",{attrs:{field:"packagesStr",sortable:"",title:e.$t("systemManage.packages"),width:"200"}})],1)],1),t("div",{staticStyle:{position:"absolute",left:"0px",right:"0px",bottom:"0px",height:"40px","padding-top":"8px"}},[t("div",{staticStyle:{float:"left","line-height":"28px"}},[t("span",{staticStyle:{"font-size":"14px",color:"#409EFF"}},[e._v(" "+e._s(e.$t("missing.checked"))+e._s(e.selectList.length))])]),t("div",{staticStyle:{float:"left"}},[t("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,40,50,100,200,500],"page-size":e.pageSize,layout:"sizes, prev, pager, next",total:e.tableTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)])]),t("ExpireTimeDialog",{attrs:{tableList:e.selectList},on:{onRenewSucc:e.onRenewSucc},model:{value:e.expireDialog,callback:function(t){e.expireDialog=t},expression:"expireDialog"}}),t("ImportDeviceidsDialog",{on:{"on-import":e.onImportDevice},model:{value:e.importDialog,callback:function(t){e.importDialog=t},expression:"importDialog"}}),t("CustomerServiceDialog",{model:{value:e.serviceDialog,callback:function(t){e.serviceDialog=t},expression:"serviceDialog"}}),t("EditDevice",{attrs:{deviceid:e.deviceid,info:e.currentRow},on:{editSucc:e.onEditSucc},model:{value:e.editDialog,callback:function(t){e.editDialog=t},expression:"editDialog"}}),t("TransferDeviceDialog",{attrs:{selectList:e.selectList},on:{transferSucc:e.transferSucc},model:{value:e.transferDialog,callback:function(t){e.transferDialog=t},expression:"transferDialog"}})],1)},s=[],r=i("5530"),c=(i("99af"),i("14d9"),i("fb6a"),i("a434"),i("a9e3"),i("d3b7"),i("159b"),i("4795"),i("2f62")),o=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:e.$t("bgManage.setOverdueTime"),center:"",visible:e.value,width:"366px","append-to-body":"","close-on-click-modal":!1},on:{close:e.handleClose}},[t("div",[e.isZh?t("el-row",{staticClass:"renew-row"},[t("el-col",{staticClass:"renew-col-label",attrs:{span:8}},[e._v(" "+e._s(e.$t("missing.selectedDevice"))+" ")]),t("el-col",{staticClass:"renew-col-value",attrs:{span:4}},[t("span",{domProps:{textContent:e._s(e.tableList.length)}})])],1):e._e(),t("el-row",{staticClass:"renew-row"},[t("el-col",{staticClass:"renew-col-label",attrs:{span:8}},[e._v(" "+e._s(e.$t("insure.dueDate"))+": ")]),t("el-col",{staticClass:"renew-col-value",attrs:{span:16}},[t("el-radio",{attrs:{label:0},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(e._s(e.$t("common.selectDate")))]),t("el-radio",{attrs:{label:1},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(e._s(e.$t("common.platformExpirationDate")))])],1)],1),t("el-row",{directives:[{name:"show",rawName:"v-show",value:0==e.radio,expression:"radio == 0"}],staticClass:"renew-row"},[t("el-col",{staticClass:"renew-col-value",attrs:{span:16,offset:8}},[t("el-date-picker",{attrs:{type:"date","picker-options":e.unicoPickerOptions,clearable:!1},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1)],1),t("el-row",{staticStyle:{"margin-top":"20px"}},[t("el-col",{attrs:{span:8,offset:8}},[t("el-button",{staticStyle:{width:"100%"},on:{click:e.batchOperate}},[e._v(e._s(e.$t("common.determine")))])],1)],1)],1)])},n=[],l=(i("d81d"),i("5867")),d=i("e285"),m=i("6e52"),p={name:"ExpireTimeDialog",props:{value:{type:Boolean,default:!1},tableList:{type:Array,default:function(){return[]}}},mixins:[l["a"]],data:function(){return{radio:0,date:new Date(Date.now()+31536e6)}},computed:Object(r["a"])({},Object(c["b"])(["isZh"])),methods:{handleClose:function(){this.$emit("input",!1)},batchOperate:function(){var e=this,t=this.tableList.map((function(e){var t=e.deviceid;return t}));if(t.length>0){var i={deviceids:t,showfreelife:0,action:"modifyexpiretime",expiretime:this.date.getTime(),syncoverduetime:this.radio};Object(d["l"])(i).then((function(i){var a=i.status,s=i.successrecords,r=i.cause;0==a?(s.forEach((function(e){var t=e.device,i=e.deviceid,a=m["a"].deviceInfos[i];a.expirenotifytime=t.expirenotifytime,a.isfree=t.isfree})),e.$XModal.message({message:e.$t("tips.setSucc"),status:"success",zIndex:9999}),e.$emit("onRenewSucc",t),e.handleClose()):e.$XModal.message({message:e.$t("tips.setFail")+":"+r,status:"error",zIndex:9999})}))}else this.$XModal.message({message:this.$t("tips.selectDevice"),status:"error",zIndex:9999})}}},u=p,v=(i("a2dd"),i("2877")),f=Object(v["a"])(u,o,n,!1,null,null,null),h=f.exports,y=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{"close-on-click-modal":!1,visible:e.value,center:"",width:"320px","append-to-body":""},on:{close:e.handleClose}},[t("template",{slot:"title"},[t("span",{staticStyle:{color:"red"},domProps:{textContent:e._s(e.$t("tips.contactRenewTip"))}})]),t("div",{staticClass:"margin_b10"},[t("el-row",[t("el-col",{attrs:{span:6}},[t("div",{staticStyle:{padding:"5px 0px 0px 10px"}},[e._v(e._s(e.$t("common.name"))+":")])]),t("el-col",{attrs:{span:12}},[t("div",{staticStyle:{padding:"5px 0px 0px 10px"}},[t("span",{staticStyle:{"padding-right":"6px"},domProps:{textContent:e._s(e.myInfo.creatername)}}),t("i",{staticClass:"el-icon-document-copy",staticStyle:{"font-size":"14px",cursor:"pointer"},on:{click:function(t){return e.handleClick(e.myInfo.creatername)}}})])])],1)],1),t("div",{staticClass:"margin_b10"},[t("el-row",[t("el-col",{attrs:{span:6}},[t("div",{staticStyle:{padding:"5px 0px 0px 10px"}},[e._v(e._s(e.$t("common.email"))+":")])]),t("el-col",{attrs:{span:12}},[t("div",{staticStyle:{padding:"5px 0px 0px 10px"}},[t("span",{staticStyle:{"padding-right":"6px"},domProps:{textContent:e._s(e.myInfo.createremail)}}),t("i",{staticClass:"el-icon-document-copy",staticStyle:{"font-size":"14px",cursor:"pointer"},on:{click:function(t){return e.handleClick(e.myInfo.createremail)}}})])])],1)],1),t("div",{staticClass:"margin_b10"},[t("el-row",[t("el-col",{attrs:{span:6}},[t("div",{staticStyle:{padding:"5px 0px 0px 10px"}},[e._v(e._s(e.$t("common.phone"))+":")])]),t("el-col",{attrs:{span:12}},[t("div",{staticStyle:{padding:"5px 0px 0px 10px"}},[t("span",{staticStyle:{"padding-right":"6px"},domProps:{textContent:e._s(e.myInfo.createrphone)}}),t("i",{staticClass:"el-icon-document-copy",staticStyle:{"font-size":"14px",cursor:"pointer"},on:{click:function(t){return e.handleClick(e.myInfo.createrphone)}}})])])],1)],1),t("div",{staticClass:"margin_b10"},[t("el-row",[t("el-col",{attrs:{span:6}},[t("div",{staticStyle:{padding:"5px 0px 0px 10px"}},[e._v(e._s(e.$t("common.wechat"))+":")])]),t("el-col",{attrs:{span:12}},[t("div",{staticStyle:{padding:"5px 0px 0px 10px"}},[t("span",{staticStyle:{"padding-right":"6px"},domProps:{textContent:e._s(e.myInfo.createrwechat)}}),t("i",{staticClass:"el-icon-document-copy",staticStyle:{"font-size":"14px",cursor:"pointer"},on:{click:function(t){return e.handleClick(e.myInfo.createrwechat)}}})])])],1)],1)],2)},g=[],b=i("201d"),x={name:"CustomerServiceDialog",props:{value:{type:Boolean,default:!1}},data:function(){return{}},computed:Object(r["a"])({},Object(c["b"])(["myInfo"])),components:{LabelWrap:b["a"]},methods:{handleClose:function(){this.$emit("input",!1)},handleClick:function(e){window.onClikCopyDevice(e)}}},w=x,D=Object(v["a"])(w,y,g,!1,null,null,null),S=D.exports,T=i("5bca"),$=i("ae31"),k=i("7e15"),C=i("f1b2"),M=i("5101"),_=i("a05b"),L=i("4c3c"),O=i("b562"),E=i("7cf8"),I=i("c276"),j=i("e173"),R={name:"DeviceExpire",data:function(){return{totalColumns:["creater","groupname","devicename","deviceid","simnum","deviceType","roleStr","overdueTime","expirenotifyTime","lastValidpoistiontime","firstloctimeStr","createTime","simiccid"],deleteIcon:j,radio:"0",exportLoading1:!1,exportLoading2:!1,expireDialog:!1,importDialog:!1,serviceDialog:!1,transferDialog:!1,tableList:[],selectList:[],editDialog:!1,deviceid:"",currentRow:{},totalCount:0,notActiveCount:0,notRecharged:0,effective30:0,effective60:0,effective90:0,invalid30:0,invalid60:0,invalid90:0,exceed90:0,currentPage:1,pageSize:200,tableTotal:0}},mixins:[_["a"],L["a"]],components:{SearchDeviceZtree:k["a"],ExpireTimeDialog:h,ImportDeviceidsDialog:T["a"],CustomerServiceDialog:S,EditDevice:C["a"],TransferDeviceDialog:$["a"]},computed:Object(r["a"])(Object(r["a"])({},Object(c["b"])(["isZh","deviceTypes","permissionList"])),{},{userType:function(){return this.$store.state.user.userType},isHasRecharge:function(){return-1!=this.permissionList.indexOf("manage-manageoverdue-recharge")}}),watch:{expireDialog:function(e){if(0==e){var t=this.$refs.xTable.getCheckboxRecords();this.selectList=t}}},methods:{clearTable:function(){this.tableList=[],this.$refs.deviceZtree.ztreeIns.checkAllNodes(!1),this.$refs.deviceZtree.selectedDeviceIds={}},transferSucc:function(){var e=this.tableList;this.$refs.deviceZtree.updateZtreeIns(),this.selectList.forEach((function(t){for(var i=t.deviceid,a=0;a<e.length;a++){var s=e[a];if(s.deviceid==i){s=m["a"].deviceInfos[i],t.creater=s.creater,t.groupname=s.groupname;break}}}))},handleSeeSim:function(e){var t=this,i=e.row.deviceid;Object(E["T"])(i).then((function(e){var i=e.status,a=e.accessurl;if(0==i){var s=document.createElement("a");s.setAttribute("target","_blank"),s.href=a,s.click()}else 1==i?t.$XModal.message({message:t.$t("tips.noPermission"),status:"success",zIndex:9999}):2==i?t.$XModal.message({message:t.$t("tips.deviceNotIncludedSim"),status:"success",zIndex:9999}):3==i&&t.$XModal.message({message:t.$t("tips.notFoundSim"),status:"success",zIndex:9999})}))},handleSelectRadio:function(e){this.setTableList(e)},handleSizeChange:function(e){this.pageSize=e,this.splitCacheToTableList()},handleCurrentChange:function(){this.splitCacheToTableList()},splitCacheToTableList:function(){var e=this,t=this.currentPage-1,i=this.pageSize,a=t*i;this.tableList=this.cacheList.slice(a,a+i),this.$refs.xTable.scrollTo(0,0),setTimeout((function(){e.$refs.xTable.setAllCheckboxRow(!0),e.selectList=e.tableList}),30)},cellclick:function(e){var t=e.row,i=t.isfree;5==i&&(this.serviceDialog=!0)},onEditSucc:function(e){var t=m["a"].deviceInfos[e.deviceid];t.offlinedelay=e.offlinedelay,this.row.devicename=e.devicename,this.$refs.deviceZtree.updateNodes([e.deviceid])},cellDblclick:function(e){var t=e.column,i=e.row;"devicename"==t.property&&(this.row=i,this.currentRow={creater:i.creater},this.deviceid=i.deviceid,this.editDialog=!0)},handleSettingDate:function(){this.expireDialog=!0},selectAllEvent:function(e){e.checked;var t=e.records;this.selectList=t},selectChangeEvent:function(e){e.checked;var t=e.records;this.selectList=t},handleDelete:function(e){var t=e.rowIndex,i=e.row.deviceid;this.$delete(this.tableList,t);var a=[];this.cacheDeviceids.forEach((function(e){e!=i&&a.push(e)})),this.cacheDeviceids=a,this.$refs.deviceZtree.cancelCheckNode(i),this.calcStateCount()},exportAllData:function(){var e=this;if(0!=this.cacheDeviceids.length){var t=this.isHasRecharge,i=[[this.$t("reportForm.index"),this.$t("reportForm.creater"),this.$t("reportForm.groupName"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("common.simnum"),this.$t("reportForm.deviceType"),this.$t("bgManage.useState"),this.$t("alarm.createTime"),this.$t("bgManage.firstloctimeStr"),this.$t("bgManage.lastOnlineTime")]];t?(i[0].push(this.$t("alarm.overdueTime")),i[0].push(this.$t("alarm.expireTime")),i[0].push("ICCID")):(i[0].push(this.$t("alarm.expireTime")),i[0].push("ICCID"));var a=this.deviceTypes,s=m["a"].deviceInfos;this.cacheDeviceids.forEach((function(r,c){var o=s[r],n=a[o.devicetype],l=n.typename,d=M["a"].format(new Date(o.createtime),"yyyy-MM-dd"),m=0!=o.firstloctime?M["a"].format(new Date(o.firstloctime),"yyyy-MM-dd"):"-",p=0!=o.lastactivetime?M["a"].format(new Date(o.lastactivetime),"yyyy-MM-dd"):"-",u=e.getOverdueTimeStr(o),v=0==o.expirenotifytime?"-":M["a"].format(new Date(o.expirenotifytime),"yyyy-MM-dd"),f=[];f.push(c+1),f.push(o.creater),f.push(o.groupname),f.push(o.devicename),f.push(o.deviceid),f.push(o.simnum?o.simnum:""),f.push(l),f.push(Object(I["t"])(o.isfree).stateStr),f.push(d),f.push(m),f.push(p),t&&f.push(u),f.push(v),f.push(o.simiccid?o.simiccid:""),i.push(f)}));var r={title:this.$t("bgManage.platformExpire"),data:i,exportMaxLength:1e5};this.exportLoading1=!0,new ExcelCls(r).exportExcel(this)}},getOverdueTimeStr:function(e){var t="-";return 0==e.overduetime?e.firstloctime>0&&(t=M["a"].format(new Date(e.firstloctime+2592e6),"yyyy-MM-dd")):t=M["a"].format(new Date(e.overduetime),"yyyy-MM-dd"),t},exportData:function(){if(0!=this.tableList.length){var e=this.isHasRecharge,t=this.$refs.xTable.getTableData().visibleData,i=[[this.$t("reportForm.index"),this.$t("reportForm.creater"),this.$t("reportForm.groupName"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("common.simnum"),this.$t("reportForm.deviceType"),this.$t("bgManage.useState"),this.$t("alarm.createTime"),this.$t("bgManage.firstloctimeStr"),this.$t("bgManage.lastOnlineTime")]];e?(i[0].push(this.$t("alarm.overdueTime")),i[0].push(this.$t("alarm.expireTime")),i[0].push("ICCID")):(i[0].push(this.$t("alarm.expireTime")),i[0].push("ICCID")),t.forEach((function(t,a){var s=[];s.push(a+1),s.push(t.creater),s.push(t.groupname),s.push(t.devicename),s.push(t.deviceid),s.push(t.simnum?t.simnum:""),s.push(t.deviceType),s.push(Object(I["t"])(t.isfree).stateStr),s.push(t.createTime),s.push(t.firstloctimeStr),s.push(t.lastValidpoistiontime),e&&s.push(t.overdueTime),s.push(t.expirenotifyTime),s.push(t.simiccid?t.simiccid:""),i.push(s)}));var a={title:this.$t("bgManage.platformExpire"),data:i,exportMaxLength:1e5};this.exportLoading2=!0,new ExcelCls(a).exportExcel(this)}},onImportDevice:function(e){this.radio="0";var t=[],i=m["a"].deviceInfos,a=Object(I["r"])(i),s=a.simMap,r=a.iccidMap;e.forEach((function(e){var a=Object(I["lb"])(i,s,r,e);a&&t.push(a.deviceid)})),this.cacheDeviceids=t,this.calcStateCount(),this.setTableList(this.radio)},onRenewSucc:function(e){this.calcStateCount();var t=[];this.tableList.forEach((function(e){var i=e.deviceid,a=m["a"].deviceInfos[i];e.isfree=a.isfree,e.expirenotifyTime=M["a"].format(new Date(a.expirenotifytime),"yyyy-MM-dd"),t.push(e)})),this.tableList=t,this.$refs.deviceZtree.updateNodes(e)},formatRole:function(e){var t=e.row,i=Object(I["t"])(t.isfree);return'<span style="color:'.concat(i.color,'">').concat(i.stateStr,"</span>")},noRepeat:function(e){for(var t=0;t<e.length-1;t++)for(var i=t+1;i<e.length;i++)e[t]===e[i]&&(e.splice(i,1),i--);return e},onTreeCheck:function(e){this.cacheDeviceids=e,this.calcStateCount(),this.setTableList(this.radio)},calcStateCount:function(){var e=0,t=0,i=0,a=0,s=0,r=0,c=0,o=0,n=0,l=Date.now(),d=864e5,p=30*d,u=60*d,v=90*d;this.cacheDeviceids.forEach((function(d){var f=m["a"].deviceInfos[d];if(f){var h=f.expirenotifytime-l;0==f.firstloctime?e++:(0==f.overduetime&&t++,h>=0?(h<p&&i++,p<=h&&h<=u&&a++,u<=h&&h<=v&&s++):0!==f.firstloctime&&0!==f.expirenotifytime&&(h=Math.abs(h),h>v&&n++,h<p&&r++,p<=h&&h<=u&&c++,u<=h&&h<=v&&o++))}})),this.notActiveCount=e,this.notRecharged=t,this.effective30=i,this.effective60=a,this.effective90=s,this.invalid30=r,this.invalid60=c,this.invalid90=o,this.exceed90=n,this.totalCount=this.cacheDeviceids.length},setTableList:function(e){var t=[];switch(e){case"-1":t=this.getNotRechargedTableList();break;case"0":t=this.getAllTableList();break;case"-2":t=this.getUnactiveTableList();break;case"30":case"60":case"90":t=this.getFastExpirationTableList(Number(e));break;case"-30":case"-60":case"-90":case"-91":t=this.getExpirationTableList(Number(e));break}this.currentPage=1,this.tableTotal=t.length,this.cacheList=t,this.splitCacheToTableList()},getAllTableList:function(){var e=this,t=this.packages,i=[],a=this.deviceTypes;return this.cacheDeviceids.forEach((function(s){var r=m["a"].deviceInfos[s];if(r){var c=a[r.devicetype].typename;r.deviceType=c;var o=0==r.expirenotifytime?"-":M["a"].format(new Date(r.expirenotifytime),"yyyy-MM-dd"),n={creater:r.creater,deviceid:r.deviceid,devicename:r.devicename,groupname:r.groupname,deviceType:c,isfree:r.isfree,roleStr:Object(I["t"])(r.isfree).stateStr,createTime:M["a"].format(new Date(r.createtime),"yyyy-MM-dd"),firstloctimeStr:0!=r.firstloctime?M["a"].format(new Date(r.firstloctime),"yyyy-MM-dd"):"-",lastValidpoistiontime:0!=r.lastactivetime?M["a"].format(new Date(r.lastactivetime),"yyyy-MM-dd"):"-",overdueTime:e.getOverdueTimeStr(r),expirenotifyTime:o,simnum:r.simnum?r.simnum:"",simiccid:r.simiccid?r.simiccid:""};Object(I["qb"])(n,t,r.packageids),i.push(n)}})),i},getUnactiveTableList:function(){var e=this,t=this.packages,i=[],a=this.deviceTypes;return this.cacheDeviceids.forEach((function(s){var r=m["a"].deviceInfos[s];if(r){var c=a[r.devicetype].typename;if(r.deviceType=c,0==r.firstloctime){var o=0==r.expirenotifytime?"-":M["a"].format(new Date(r.expirenotifytime),"yyyy-MM-dd"),n={creater:r.creater,deviceid:r.deviceid,devicename:r.devicename,groupname:r.groupname,deviceType:c,isfree:r.isfree,roleStr:Object(I["t"])(r.isfree).stateStr,createTime:M["a"].format(new Date(r.createtime),"yyyy-MM-dd"),firstloctimeStr:0!=r.firstloctime?M["a"].format(new Date(r.firstloctime),"yyyy-MM-dd"):"-",lastValidpoistiontime:0!=r.lastactivetime?M["a"].format(new Date(r.lastactivetime),"yyyy-MM-dd"):"-",expirenotifyTime:o,overdueTime:e.getOverdueTimeStr(r),simnum:r.simnum?r.simnum:"",simiccid:r.simiccid?r.simiccid:""};Object(I["qb"])(n,t,r.packageids),i.push(n)}}})),i},getNotRechargedTableList:function(){var e=this,t=this.packages,i=[],a=this.deviceTypes;return this.cacheDeviceids.forEach((function(s){var r=m["a"].deviceInfos[s];if(r){var c=a[r.devicetype].typename;if(r.deviceType=c,0==r.firstloctime)return;if(0!==r.overduetime)return;var o=0==r.expirenotifytime?"-":M["a"].format(new Date(r.expirenotifytime),"yyyy-MM-dd"),n={creater:r.creater,deviceid:r.deviceid,devicename:r.devicename,groupname:r.groupname,deviceType:c,isfree:r.isfree,roleStr:Object(I["t"])(r.isfree).stateStr,createTime:M["a"].format(new Date(r.createtime),"yyyy-MM-dd"),firstloctimeStr:0!=r.firstloctime?M["a"].format(new Date(r.firstloctime),"yyyy-MM-dd"):"-",lastValidpoistiontime:0!=r.lastactivetime?M["a"].format(new Date(r.lastactivetime),"yyyy-MM-dd"):"-",overdueTime:e.getOverdueTimeStr(r),expirenotifyTime:o,simnum:r.simnum?r.simnum:"",simiccid:r.simiccid?r.simiccid:""};Object(I["qb"])(n,t,r.packageids),i.push(n)}})),i},getFastExpirationTableList:function(e){var t=this,i=this.packages,a=Date.now(),s=[],r=this.deviceTypes,c=2592e6,o=5184e6,n=7776e6;return this.cacheDeviceids.forEach((function(l){var d=m["a"].deviceInfos[l];if(d){var p=d.expirenotifytime,u=r[d.devicetype].typename;d.deviceType=u;var v=p-a;if(0==d.firstloctime)return;if(v>=0)if(30==e&&v<=c){var f=0==d.expirenotifytime?"-":M["a"].format(new Date(d.expirenotifytime),"yyyy-MM-dd"),h={creater:d.creater,deviceid:d.deviceid,devicename:d.devicename,groupname:d.groupname,deviceType:u,isfree:d.isfree,roleStr:Object(I["t"])(d.isfree).stateStr,createTime:M["a"].format(new Date(d.createtime),"yyyy-MM-dd"),firstloctimeStr:0!=d.firstloctime?M["a"].format(new Date(d.firstloctime),"yyyy-MM-dd"):"-",lastValidpoistiontime:0!=d.lastactivetime?M["a"].format(new Date(d.lastactivetime),"yyyy-MM-dd"):"-",overdueTime:t.getOverdueTimeStr(d),expirenotifyTime:f,simnum:d.simnum?d.simnum:"",simiccid:d.simiccid?d.simiccid:""};Object(I["qb"])(h,i,d.packageids),s.push(h)}else if(60==e&&c<=v&&v<=o){var y=0==d.expirenotifytime?"-":M["a"].format(new Date(d.expirenotifytime),"yyyy-MM-dd"),g={creater:d.creater,deviceid:d.deviceid,devicename:d.devicename,groupname:d.groupname,deviceType:u,isfree:d.isfree,roleStr:Object(I["t"])(d.isfree).stateStr,createTime:M["a"].format(new Date(d.createtime),"yyyy-MM-dd"),firstloctimeStr:0!=d.firstloctime?M["a"].format(new Date(d.firstloctime),"yyyy-MM-dd"):"-",lastValidpoistiontime:0!=d.lastactivetime?M["a"].format(new Date(d.lastactivetime),"yyyy-MM-dd"):"-",overdueTime:t.getOverdueTimeStr(d),expirenotifyTime:y,simnum:d.simnum?d.simnum:"",simiccid:d.simiccid?d.simiccid:""};Object(I["qb"])(g,i,d.packageids),s.push(g)}else if(90==e&&o<=v&&v<=n){var b=0==d.expirenotifytime?"-":M["a"].format(new Date(d.expirenotifytime),"yyyy-MM-dd"),x={creater:d.creater,deviceid:d.deviceid,devicename:d.devicename,groupname:d.groupname,deviceType:u,isfree:d.isfree,roleStr:Object(I["t"])(d.isfree).stateStr,createTime:M["a"].format(new Date(d.createtime),"yyyy-MM-dd"),firstloctimeStr:0!=d.firstloctime?M["a"].format(new Date(d.firstloctime),"yyyy-MM-dd"):"-",lastValidpoistiontime:0!=d.lastactivetime?M["a"].format(new Date(d.lastactivetime),"yyyy-MM-dd"):"-",overdueTime:t.getOverdueTimeStr(d),expirenotifyTime:b,simnum:d.simnum?d.simnum:"",simiccid:d.simiccid?d.simiccid:""};Object(I["qb"])(x,i,d.packageids),s.push(x)}}})),s},getExpirationTableList:function(e){var t=this,i=this.packages,a=24*e*3600*1e3,s=Date.now(),r=[],c=this.deviceTypes,o=2592e6,n=5184e6,l=7776e6;return this.cacheDeviceids.forEach((function(d){var p=m["a"].deviceInfos[d];if(p){var u=p.expirenotifytime-s;if(0!==p.firstloctime&&0!==p.expirenotifytime&&u<0){var v=!1;if(u=Math.abs(u),a=Math.abs(a),"-91"==e?u>7776e6&&(v=!0):u<=a&&("-30"==e?u<=o&&(v=!0):"-60"==e?o<=u&&u<=n&&(v=!0):"-90"==e&&n<=u&&u<=l&&(v=!0)),v){var f=0==p.expirenotifytime?"-":M["a"].format(new Date(p.expirenotifytime),"yyyy-MM-dd"),h=c[p.devicetype],y=h.typename,g=h.price,b=h.price3,x=h.price5,w=h.price10,D={creater:p.creater,deviceid:p.deviceid,devicename:p.devicename,groupname:p.groupname,deviceType:y,isfree:p.isfree,roleStr:Object(I["t"])(p.isfree).stateStr,createTime:M["a"].format(new Date,"yyyy-MM-dd"),firstloctimeStr:0!=p.firstloctime?M["a"].format(new Date(p.firstloctime),"yyyy-MM-dd"):"-",lastValidpoistiontime:0!=p.lastactivetime?M["a"].format(new Date(p.lastactivetime),"yyyy-MM-dd"):"-",overdueTime:t.getOverdueTimeStr(p),expirenotifyTime:f,price:g,price3:b,price5:x,price10:w,simnum:p.simnum?p.simnum:"",simiccid:p.simiccid?p.simiccid:""};Object(I["qb"])(D,i,p.packageids),r.push(D)}}}})),r}},mounted:function(){var e=this;this.packages=[],this.cacheDeviceids=[],Object(O["X"])({filterenabled:0}).then((function(t){var i=t.packages;i=i||[],i.forEach((function(t){t.packagename=e.$t("systemManage.package"+t.packageid)})),e.packages=i}))}},z=R,N=(i("676b"),Object(v["a"])(z,a,s,!1,null,null,null)),F=N.exports;t["default"]=F}}]);