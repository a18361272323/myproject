(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f01f90e4"],{"0595":function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"quick-time-range"},[t("div",{staticClass:"quick-time-range-wrapper"},e._l(e.list,(function(a){return t("div",{key:a.type,style:{color:a.type==e.type?"#409EFF":""},on:{click:function(t){return e.selectDate(a.type)}}},[e._v(e._s(a.label))])})),0),t("div",{staticClass:"quick-time-range-space"}),t("div",{staticClass:"quick-time-range-btn",on:{click:function(t){e.isCollapse=!e.isCollapse}}},[e.isCollapse?t("i",{staticClass:"el-icon-arrow-right"}):t("i",{staticClass:"el-icon-arrow-left"})])])},r=[],s=a("5101"),n={name:"QuickTimeRange",props:{value:{type:Array,default:function(){return[]}},dateType:{type:String,default:"date"}},watch:{isCollapse:function(){this.setList()}},data:function(){return{isCollapse:!0,type:0,list:[]}},methods:{setList:function(){this.isCollapse?this.list=[{label:this.$t("reportForm.toDay"),type:0},{label:this.$t("reportForm.yesterDay"),type:1},{label:this.$t("reportForm.recent3Days"),type:3}]:this.list=[{label:this.$t("reportForm.recent7Days"),type:7},{label:this.$t("reportForm.recent10Days"),type:10},{label:this.$t("reportForm.recent30Days"),type:30}]},selectDate:function(e){var t="datetimerange"==this.dateType,a=[],i=new Date,r=new Date;switch(t&&(i=new Date(s["a"].format(new Date,"yyyy-MM-dd")+" 00:00:00"),r=new Date(s["a"].format(new Date,"yyyy-MM-dd")+" 23:59:59")),e){case 0:a=[new Date(s["a"].format(i,"yyyy-MM-dd")+" 00:00:00"),new Date(s["a"].format(r,"yyyy-MM-dd")+" 23:59:59")];break;case 1:i.setTime(i.getTime()-864e5),a=[i,r];break;case 3:i.setTime(i.getTime()-2592e5),a=[i,r];break;case 7:i.setTime(i.getTime()-6048e5),a=[i,r];break;case 10:i.setTime(i.getTime()-864e6),a=[i,r];break;case 30:i.setTime(i.getTime()-2592e6),a=[i,r];break}this.type=e,this.$emit("input",a)}},mounted:function(){var e=this;this.$nextTick((function(){e.setList()}))}},o=n,l=(a("c51d"),a("2877")),c=Object(l["a"])(o,i,r,!1,null,null,null);t["a"]=c.exports},"271ae":function(e,t,a){},"2ddc":function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"multi-choice",style:e.warpStyle},[t("div",{staticClass:"multi-choice-input"},["daterange"==e.dateType?t("div",[t("el-date-picker",{attrs:{type:e.dateType,"picker-options":e.pickerOptions,"range-separator":"-",align:"center","unlink-panels":"",clearable:!1,"start-placeholder":e.$t("device.driverinitialdate"),"end-placeholder":e.$t("device.drivereffectivedate")},on:{change:e.onChange},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1):e._e(),"date"==e.dateType?t("div",[t("el-date-picker",{attrs:{type:"date","picker-options":e.datePickerOptions},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1):e._e(),"datetimerange"==e.dateType?t("div",{staticClass:"datetimerange"},[t("el-date-picker",{attrs:{type:e.dateType,"range-separator":"-","picker-options":e.pickerOptionsTime,align:"center","unlink-panels":"",clearable:!1,"start-placeholder":e.$t("device.driverinitialdate"),"end-placeholder":e.$t("device.drivereffectivedate"),"default-time":["00:00:00","23:59:59"]},on:{change:e.onChange},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1):e._e(),"month"==e.dateType?t("div",[t("el-date-picker",{attrs:{type:"month"},model:{value:e.month,callback:function(t){e.month=t},expression:"month"}})],1):e._e()])])},r=[],s=(a("99af"),a("5101")),n=a("5867"),o={name:"SelectDate",props:{value:{type:Array|Date,default:function(){return[]}},dateType:{type:String,default:"daterange"},label:{type:String,default:function(){return this.$t("common.selectTime")}}},computed:{isDaterange:function(){return"daterange"==this.dateType},warpStyle:function(){var e=200;switch(this.dateType){case"date":e=120;break;case"daterange":e=230;break;case"datetimerange":e=310;break}return{width:"".concat(e,"px")}}},mixins:[n["a"]],data:function(){var e=864e5;return{dateRange:[],date:new Date,month:new Date,pickerOptions:{shortcuts:[{text:this.$t("reportForm.toDay"),onClick:function(e){var t=new Date;e.$emit("pick",[t,t])}},{text:this.$t("reportForm.yesterDay"),onClick:function(t){var a=new Date;a.setTime(a.getTime()-e),t.$emit("pick",[a,a])}},{text:this.$t("missing.theWeek"),onClick:function(t){var a=new Date,i=new Date,r=a.getDay();a.setTime(a.getTime()-e*(r-1)),i.setTime(a.getTime()+6*e),t.$emit("pick",[a,i])}},{text:this.$t("missing.lastWeek"),onClick:function(t){var a=new Date,i=new Date,r=a.getDay(),s=a.getTime()-e*(r-1);a.setTime(s-7*e),i.setTime(s-e),t.$emit("pick",[a,i])}},{text:this.$t("missing.thisMonth"),onClick:function(e){var t=new Date,a=t.getFullYear(),i=t.getMonth()+1,r=new Date("".concat(a,"-").concat(i,"-01")),s=new Date("".concat(a,"-").concat(i,"-01 00:00:00"));s.setMonth(s.getMonth()+1),s=new Date(s.getTime()-1e3),e.$emit("pick",[r,s])}},{text:this.$t("missing.lastMonth"),onClick:function(e){var t=new Date;t.setMonth(t.getMonth()-1);var a=t.getFullYear(),i=t.getMonth()+1,r=new Date(new Date(a,i,1)-1).getDate(),s=new Date("".concat(a,"-").concat(i,"-01")),n=new Date("".concat(a,"-").concat(i,"-").concat(r));e.$emit("pick",[s,n])}}]},pickerOptionsTime:{shortcuts:[{text:this.$t("reportForm.toDay"),onClick:function(e){var t=new Date(s["a"].format(new Date,"yyyy-MM-dd")+" 00:00:00"),a=new Date(s["a"].format(new Date,"yyyy-MM-dd")+" 23:59:59");e.$emit("pick",[t,a])}},{text:this.$t("reportForm.yesterDay"),onClick:function(t){var a=new Date;a.setTime(a.getTime()-e),t.$emit("pick",[new Date(s["a"].format(a,"yyyy-MM-dd")+" 00:00:00"),new Date(s["a"].format(a,"yyyy-MM-dd")+" 23:59:59")])}},{text:this.$t("missing.theWeek"),onClick:function(t){var a=new Date,i=new Date,r=a.getDay();a.setTime(a.getTime()-e*(r-1)),i.setTime(a.getTime()+6*e),t.$emit("pick",[new Date(s["a"].format(a,"yyyy-MM-dd")+" 00:00:00"),new Date(s["a"].format(i,"yyyy-MM-dd")+" 23:59:59")])}},{text:this.$t("missing.lastWeek"),onClick:function(t){var a=new Date,i=new Date,r=a.getDay(),n=a.getTime()-e*(r-1);a.setTime(n-7*e),i.setTime(n-e),t.$emit("pick",[new Date(s["a"].format(a,"yyyy-MM-dd")+" 00:00:00"),new Date(s["a"].format(i,"yyyy-MM-dd")+" 23:59:59")])}},{text:this.$t("missing.thisMonth"),onClick:function(e){var t=new Date,a=t.getFullYear(),i=t.getMonth()+1,r=new Date("".concat(a,"-").concat(i,"-01")),n=new Date("".concat(a,"-").concat(i,"-01 00:00:00"));n.setMonth(n.getMonth()+1),n=new Date(n.getTime()-1e3),e.$emit("pick",[new Date(s["a"].format(r,"yyyy-MM-dd")+" 00:00:00"),new Date(s["a"].format(n,"yyyy-MM-dd")+" 23:59:59")])}},{text:this.$t("missing.lastMonth"),onClick:function(e){var t=new Date;t.setMonth(t.getMonth()-1);var a=t.getFullYear(),i=t.getMonth()+1,r=new Date(new Date(a,i,1)-1).getDate(),n=new Date("".concat(a,"-").concat(i,"-01")),o=new Date("".concat(a,"-").concat(i,"-").concat(r));e.$emit("pick",[new Date(s["a"].format(n,"yyyy-MM-dd")+" 00:00:00"),new Date(s["a"].format(o,"yyyy-MM-dd")+" 23:59:59")])}}]}}},watch:{dateRange:function(e){null==e?this.$emit("input",[]):this.$emit("input",e)},value:function(e){this.dateRange=e},date:function(e){this.$emit("input",e)},month:function(e){this.$emit("input",e)}},methods:{onChange:function(e){this.$emit("input",e)}},mounted:function(){"date"==this.dateType?this.date=this.value:"month"==this.dateType?this.month=this.value:this.dateRange=this.value}},l=o,c=(a("e716"),a("2877")),d=Object(c["a"])(l,i,r,!1,null,"5dbb8594",null);t["a"]=d.exports},"2e48":function(e,t,a){"use strict";a("91de")},"3b2d":function(e,t,a){"use strict";a("a881")},"4c3c":function(e,t,a){"use strict";a("4e82");t["a"]={data:function(){return{sortConfig:{sortMethod:function(e){var t=e.data,a=e.sortList,i=a[0],r=i.property,s=i.order,n=[];return n="desc"===s?t.sort((function(e,t){var a=e[r],i=t[r];if(isNaN(a)&&!isNaN(Date.parse(a))&&isNaN(i)&&!isNaN(Date.parse(i)))return Date.parse(i)-Date.parse(a);if(a=parseFloat(a),i=parseFloat(i),isNaN(a)||isNaN(i)){var s=t[r]+"";return s.localeCompare(e[r])}return i-a})):"asc"===s?t.sort((function(e,t){var a=e[r],i=t[r];if(isNaN(a)&&!isNaN(Date.parse(a))&&isNaN(i)&&!isNaN(Date.parse(i)))return Date.parse(a)-Date.parse(i);if(a=parseFloat(e[r]),i=parseFloat(t[r]),isNaN(a)||isNaN(i)){var s=e[r]+"";return s.localeCompare(t[r])}return a-i})):t.sort(),n}}}}}},"57c9":function(e,t,a){"use strict";var i=a("0595");t["a"]=i["a"]},"6fb3":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"report-form full"},[t("div",{staticClass:"report-form-inner"},[t("div",{staticClass:"report-form-inner-header",staticStyle:{height:"35px"}},[t("div",{staticClass:"f_left"},[t("MultiChoiceVehicle",{ref:"multiChoiceVehicle",on:{onSelectDevice:e.onSelectDevice}})],1),t("div",{staticClass:"f_left"},[t("el-button",{on:{click:e.handleSelectAlarm}},[e._v(e._s(e.$t("alarm.selectAlarmType")))])],1),t("div",{staticClass:"f_left"},[t("SelectDate",{model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),t("div",{staticClass:"f_left"},[t("QuickTimeRange",{model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),t("div",{staticClass:"f_left"},[t("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.handleQuery}},[e._v(e._s(e.$t("common.query")))])],1),t("div",{staticClass:"f_left"},[t("el-button",{attrs:{type:"primary",loading:e.exportLoading1},on:{click:e.exportData}},[e._v(e._s(e.$t("common.export")))])],1),t("div",[t("el-popconfirm",{attrs:{placement:"top",icon:"el-icon-info","icon-color":"red","confirm-button-text":e.$t("common.confirm"),"cancel-button-text":e.$t("common.cancel"),title:e.deleteAlarmTip},on:{confirm:e.handleBatchDelete}},[t("el-button",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[e._v(e._s(e.$t("missing.batchDelete")))])],1)],1)]),t("div",{staticClass:"report-form-inner-content",staticStyle:{top:"39px"}},[t("split-pane",{style:{height:"100%"},attrs:{direction:"vertical",verticalMode:e.verticalMode},on:{"on-resize":e.onSplitPaneResize},model:{value:e.triggerOffsetV,callback:function(t){e.triggerOffsetV=t},expression:"triggerOffsetV"}},[t("div",{staticStyle:{position:"relative",height:"100%",border:""},attrs:{slot:"top"},slot:"top"},[t("div",{staticStyle:{position:"absolute",left:"-4px",right:"-4px",top:"0px",bottom:"0px"}},[t("vxe-table",{ref:"xTable",staticClass:"mytable-scrollbar",attrs:{"sort-config":e.sortConfig,"menu-config":e.tableMenu,border:"","auto-resize":"",resizable:"","show-overflow":"","highlight-current-row":"","highlight-hover-row":"",size:"mini",height:"auto",data:e.totalList},on:{"menu-click":e.handleClickTableMenu,"checkbox-all":e.selectChangeRow,"checkbox-change":e.selectChangeRow,"cell-click":e.cellClickRow}},[t("vxe-table-column",{attrs:{type:"checkbox",width:"50"}}),t("vxe-table-column",{attrs:{title:e.$t("reportForm.action"),width:"110"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text",disabled:1==a.row.disposestatus,size:"mini"},on:{click:function(t){return e.disposeAlarm(a.row)}}},[e._v(e._s(e.$t("common.processAlarm")))]),t("span",{staticStyle:{padding:"0px 5px"}}),t("el-popconfirm",{attrs:{placement:"top",icon:"el-icon-info","icon-color":"red","confirm-button-text":e.$t("common.confirm"),"cancel-button-text":e.$t("common.cancel"),title:e.$t("tips.confirmDelete")},on:{confirm:function(t){return e.handleDelete(a)}}},[t("el-button",{attrs:{slot:"reference",type:"text",size:"mini"},slot:"reference"},[e._v(e._s(e.$t("common.delete")))])],1)]}}])}),t("vxe-table-column",{attrs:{field:"index",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{field:"devicename",title:e.$t("alarm.devName"),width:"130",sortable:""}}),t("vxe-table-column",{attrs:{field:"deviceid",title:e.$t("alarm.devNum"),width:"130",sortable:""}}),t("vxe-table-column",{attrs:{field:"creater",title:e.$t("reportForm.creater"),width:"100",sortable:""},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{attrs:{placement:"bottom",trigger:"click"}},[t("div",{staticClass:"parents-wrapper"},e._l(e.parentsList,(function(a){return t("div",{key:a.username},[e._v(e._s(a.username)+"("+e._s(a.usertypeStr)+")")])})),0),t("el-button",{staticStyle:{color:"#000000"},attrs:{slot:"reference",type:"text"},on:{click:function(t){return e.queryParents(a.row.creater)}},slot:"reference"},[e._v(e._s(a.row.creater))])],1)]}}])}),t("vxe-table-column",{attrs:{field:"groupname",title:e.$t("reportForm.groupName"),width:"100",sortable:""}}),t("vxe-table-column",{attrs:{field:"startalarmtimeStr",title:e.$t("reportForm.startTime"),width:"156",sortable:""}}),t("vxe-table-column",{attrs:{field:"lastalarmtimeStr",title:e.$t("reportForm.endTime"),width:"156",sortable:""}}),t("vxe-table-column",{attrs:{field:"stralarm",title:e.$t("alarm.alarmType"),width:"90",sortable:""}}),t("vxe-table-column",{attrs:{field:"alarmcount",title:e.$t("alarm.alarmCount"),width:"95",sortable:""}}),t("vxe-table-column",{attrs:{field:"isdispose",title:e.$t("reportForm.status"),width:"90",sortable:""}}),t("vxe-table-column",{attrs:{field:"disposecontent",title:e.$t("common.note"),width:"120",sortable:""}}),t("vxe-table-column",{attrs:{field:"address",title:e.$t("reportForm.address"),width:"200"}})],1)],1)]),t("div",{staticStyle:{height:"100%"},attrs:{slot:"bottom"},slot:"bottom"},[t("ReportMap",{ref:"mapIns"})],1)])],1),t("AlarmFilterDialog",{attrs:{forcealarm:e.forcealarm},on:{onChange:e.onChange},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}}),t("DisposeAlarmDialog",{ref:"disposeAlarmDialog",model:{value:e.alarmDialog,callback:function(t){e.alarmDialog=t},expression:"alarmDialog"}}),t("SafetyDetailReport",{ref:"safetyDetail",model:{value:e.safetyDrawer,callback:function(t){e.safetyDrawer=t},expression:"safetyDrawer"}})],1)])},r=[],s=a("5530"),n=(a("99af"),a("caad"),a("d81d"),a("14d9"),a("b64b"),a("d3b7"),a("2532"),a("159b"),a("589f"),a("e561")),o=a("acb6"),l=a("fd61"),c=a("d462"),d=a("57c9"),m=a("632c"),u=a("32eb"),h=a("1c31"),p=a("7cf8"),f=a("6e52"),v=a("5101"),g=a("b562"),y=a("2f62"),b=a("c276"),w=a("4c3c"),D=a("a05b"),k=a("0c87"),x=a("d91c"),$={name:"allAlarm",data:function(){return{loading:!1,dialog:!1,alarmDialog:!1,exportLoading1:!1,safetyDrawer:!1,dateRange:[new Date,new Date],totalList:[],selectRowList:[],forcealarm:"11111111111111111111111111111111111111111111111111111111111111111111111111111",triggerOffsetV:50,verticalMode:"move"}},mixins:[w["a"],D["a"],k["a"]],computed:Object(s["a"])(Object(s["a"])({},Object(y["b"])(["isZh","alarmTypeList","reportTagList"])),{},{deleteAlarmTip:function(){return this.selectRowList.length?this.$t("tips.confirmDeleteAlarm",{count:this.selectRowList.length}):this.$t("tips.selectDeleteAlarm")}}),components:{MultiChoiceVehicle:n["a"],AlarmFilterDialog:o["a"],SelectDate:c["a"],QuickTimeRange:d["a"],SplitPane:m["a"],ReportMap:u["a"],DisposeAlarmDialog:l["a"],SafetyDetailReport:x["a"]},watch:{dateRange:function(){this.handleQuery()}},activated:function(){this.autoQueryAllDeviceAlarms()},methods:Object(s["a"])(Object(s["a"])({},Object(y["c"])(["setAllAlarmList","setUrgentAlarmList","setReportTagList"])),{},{onSplitPaneResize:function(e){this.verticalMode=e},autoQueryAllDeviceAlarms:function(){var e=this,t=this.$route.params.autoQuery,a=this.loading;if(t&&0==a){var i=this.reportTagList;0==i.includes("allAlarm")&&(i=i.concat(["allAlarm"]),this.setReportTagList(i)),this.$refs.multiChoiceVehicle.clearText();var r=Object.keys(f["a"].deviceInfos),s=this.dateRange,n=v["a"].format(s[0],"yyyy-MM-dd"),o=v["a"].format(s[1],"yyyy-MM-dd"),l={devices:r,needalarm:this.forcealarm,startday:n,endday:o,offset:v["a"].getOffset(),needaddress:1};this.loading=!0,this.queryDetailDateRange=l.startday+"  "+l.endday,Object(h["C"])(l).then((function(t){var a=t.alarmrecords,i=t.addressmap;e.loading=!1,e.selectRowList=[];var r=[];if(null!=a){var s=a.length;a.forEach((function(t,a){var n=f["a"].deviceInfos[t.deviceid],o=0===t.disposestatus?e.$t("reportForm.untreated"):e.$t("reportForm.handled");r.push({index:s-a,deviceid:t.deviceid,devicename:n.devicename,creater:f["a"].getShowName(n.creater),groupname:n.groupname,alarmcount:t.alarmcount,startalarmtimeStr:v["a"].longToLocalDateTimeStr(t.startalarmtime),lastalarmtimeStr:v["a"].longToLocalDateTimeStr(t.lastalarmtime),isdispose:o,stralarm:e.isZh?t.stralarm:Object(b["Ob"])(t.stralarmen),disposeperson:t.disposeperson?t.disposeperson:"",disposestatus:t.disposestatus,disposecontent:t.disposecontent,createrrecords:[],callat:t.lat,callon:t.lon,alarm:t.alarm,alarmtype:t.alarmtype,devicealarmid:t.devicealarmid,av:t.av,startalarmtime:t.startalarmtime,address:Object(b["L"])(i,t.lat,t.lon)})}))}if(e.totalList=r,r.length){var n=r[0];e.$refs.xTable.setCurrentRow(n),e.$refs.xTable.scrollToRow(n),e.cellClickRow({row:n})}}))}},handleDelete:function(e){var t=this,a=e.rowIndex,i=e.row;Object(h["d"])({alarms:[i]}).then((function(e){var i=e.status;0==i?(t.$delete(t.totalList,a),t.$XModal.message({message:t.$t("tips.deleteSucc"),status:"success",zIndex:9999})):t.$XModal.message({message:t.$t("tips.deleteFail"),status:"error",zIndex:9999})}))},handleBatchDelete:function(){var e=this;if(this.selectRowList.length>0){var t=this.$loading({lock:!0,text:this.$t("missing.loading"),spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),a=this.selectRowList.map((function(e){return{deviceid:e.deviceid,devicealarmid:e.devicealarmid}}));Object(h["d"])({alarms:a}).then((function(i){var r=i.status;if(t.close(),0==r){var s=[];e.totalList.forEach((function(e){var t=e.devicealarmid,i=!1;a.forEach((function(e){e.devicealarmid==t&&(i=!0)})),0==i&&s.push(e)})),e.totalList=s,e.$XModal.message({message:e.$t("tips.deleteSucc"),status:"success",zIndex:9999}),e.selectRowList=[]}else e.$XModal.message({message:e.$t("tips.deleteFail"),status:"error",zIndex:9999})})).catch((function(e){console.log(e),t.close()}))}},disposeAlarm:function(e){this.alarmDialog=!0,this.$refs.disposeAlarmDialog.setDeviceInfo(e)},cellClickRow:function(e){var t=e.row;this.$refs.mapIns.singleMarkerToMap(t),this.queryActiveSafetyRecord(t)},queryActiveSafetyRecord:function(e){var t=this,a=35184372088832;if(e.alarm==a){var i={deviceid:e.deviceid,updatetime:e.startalarmtime,activesafetyid:e.av};Object(p["z"])(i).then((function(e){var a=e.playrootpath,i=e.record;if(i){i._localPlayRootPath=a;var r=i.alarmtype;100==r?i.event=Object(b["A"])(i):101==r?i.event=Object(b["k"])(i):103==r&&(i.event=Object(b["l"])(i)),i.dateStr=v["a"].longToLocalDateTimeStr(i.updatetime),t.$refs.safetyDetail.setRecordInfo(i),t.safetyDrawer=!0}}))}},isNeedForceAlarm:function(e){var t=!1,a=this.$store.state.forcealarm;if(e&&a)for(var i=e.length,r=a.length,s=Math.min(i,r),n=0;n<s;++n){var o=e.charAt(n),l=a.charAt(n);if("1"==l&&"1"==o){t=!0;break}}return t},handleSelectAlarm:function(){var e=this;0==this.alarmTypeList.length?Object(g["L"])().then((function(t){if(0==t.status){var a=[],i=t.records;i.forEach((function(e,t){e.show=!0,e.index=t+1,a.push(e)})),e.$store.commit("setAlarmTypeList",a),e.dialog=!0}})):this.dialog=!0},onSelectDevice:function(e){this.deviceids=e},selectChangeRow:function(e){var t=e.records;this.selectRowList=t},exportData:function(){var e=this,t=[[this.$t("reportForm.index"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("reportForm.startTime"),this.$t("reportForm.endTime"),this.$t("alarm.alarmType"),this.$t("alarm.alarmCount"),this.$t("reportForm.status"),this.$t("reportForm.address"),this.$t("monitor.coordinate")]];if(this.totalList.length){var a=this.$refs.xTable.getTableData().visibleData;a.forEach((function(a,i){var r=0===a.disposestatus?e.$t("reportForm.untreated"):e.$t("reportForm.handled"),s=[];s.push(i+1),s.push(a.devicename),s.push(a.deviceid),s.push(a.startalarmtimeStr),s.push(a.lastalarmtimeStr),s.push(a.stralarm),s.push(a.alarmcount),s.push(r),s.push(a.address),s.push(a.callon+","+a.callat),t.push(s)}));var i={title:this.$t("reportForm.allAlarm"),data:t,dateRange:this.queryDetailDateRange};this.exportLoading1=!0,new ExcelCls(i).exportExcel(this)}},handleQuery:function(){var e=this,t=this.deviceids,a=this.dateRange;if(0!=t.length){var i=v["a"].format(a[0],"yyyy-MM-dd"),r=v["a"].format(a[1],"yyyy-MM-dd"),s={devices:t,needalarm:this.forcealarm,startday:i,endday:r,offset:v["a"].getOffset(),needaddress:1};this.loading=!0,this.queryDetailDateRange=s.startday+"  "+s.endday,Object(h["C"])(s).then((function(t){var a=t.alarmrecords,i=t.addressmap;e.loading=!1,e.selectRowList=[];var r=[];if(null!=a){var s=a.length;a.forEach((function(t,a){var n=f["a"].deviceInfos[t.deviceid],o=0===t.disposestatus?e.$t("reportForm.untreated"):e.$t("reportForm.handled");r.push({index:s-a,deviceid:t.deviceid,devicename:n.devicename,creater:n.creater,groupname:n.groupname,alarmcount:t.alarmcount,lastalarmtimeStr:v["a"].longToLocalDateTimeStr(t.lastalarmtime),startalarmtimeStr:v["a"].longToLocalDateTimeStr(t.startalarmtime),isdispose:o,stralarm:e.isZh?t.stralarm:Object(b["Ob"])(t.stralarmen),disposeperson:t.disposeperson?t.disposeperson:"",disposestatus:t.disposestatus,disposecontent:t.disposecontent,createrrecords:[],callat:t.lat,callon:t.lon,alarm:t.alarm,devicealarmid:t.devicealarmid,av:t.av,startalarmtime:t.startalarmtime,address:Object(b["L"])(i,t.lat,t.lon)})}))}if(e.totalList=r,r.length){var n=r[0];e.$refs.xTable.setCurrentRow(n),e.$refs.xTable.scrollToRow(n),e.$refs.mapIns.singleMarkerToMap(n)}}))}else this.$XModal.message({message:this.$t("tips.selectDevice"),status:"error",zIndex:9999})},onChange:function(e){this.forcealarm=e}}),mounted:function(){this.deviceids=[],this.autoQueryAllDeviceAlarms()}},T=$,C=(a("2e48"),a("2877")),M=Object(C["a"])(T,i,r,!1,null,null,null),L=M.exports;t["default"]=L},"91de":function(e,t,a){},a881:function(e,t,a){},acb6:function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:e.$t("alarm.selectAlarmType"),visible:e.value,center:"",width:"560px","append-to-body":"","close-on-click-modal":!1},on:{close:e.handleClose}},[t("el-row",[t("el-col",{attrs:{span:16}},[t("el-input",{attrs:{"prefix-icon":"el-icon-search",clearable:""},on:{clear:e.handleClear},model:{value:e.sosoValue,callback:function(t){e.sosoValue=t},expression:"sosoValue"}})],1),t("el-col",{staticStyle:{"text-align":"center","line-height":"32px"},attrs:{span:4}},[t("el-checkbox",{on:{change:e.onChangeAll},model:{value:e.isSelectAll,callback:function(t){e.isSelectAll=t},expression:"isSelectAll"}},[e._v(" "+e._s(e.$t("common.selectAll")))])],1),t("el-col",{staticStyle:{"text-align":"center","line-height":"32px"},attrs:{span:4}},[e._v(" "+e._s(e.$t("reportForm.selectedAlarm")+e.selectLength)+" ")])],1),t("div",{staticClass:"checkbox-wrap"},e._l(e.copyAlarmTypeList,(function(a,i){return t("div",{directives:[{name:"show",rawName:"v-show",value:a.show,expression:"item.show"}],key:i},[t("el-checkbox",{on:{change:e.onChange},model:{value:e.checkboxObj[a.index],callback:function(t){e.$set(e.checkboxObj,a.index,t)},expression:"checkboxObj[item.index]"}},[e._v(" "+e._s(a.alarmname))])],1)})),0),t("el-row",[t("el-col",{attrs:{span:20,offset:2}},[t("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.handleComfirm}},[e._v(e._s(e.$t("common.determine")))])],1)],1)],1)},r=[],s=a("5530"),n=(a("c975"),a("14d9"),a("d3b7"),a("159b"),a("2f62")),o={name:"AlarmFilterDialog",props:{value:{type:Boolean,default:!1},forcealarm:{type:String,default:"1111111111111111111111111111111111111111111111111111111111111111111111"}},data:function(){return{sosoValue:"",selectLength:0,checkboxObjLength:0,checkboxObj:{},isSelectAll:!0,copyAlarmTypeList:[]}},computed:Object(s["a"])({},Object(n["b"])(["alarmTypeList","isZh"])),watch:{value:function(e){var t=this;if(e){var a=[];this.alarmTypeList.forEach((function(e,i){a.push(e);var r="1"==t.forcealarm.charAt(i);t.$set(t.checkboxObj,e.index,r)})),this.checkboxObjLength=this.alarmTypeList.length,this.copyAlarmTypeList=a,this.calcSelectLength()}},sosoValue:function(e){0==e.length?this.copyAlarmTypeList.forEach((function(e){e.show=!0})):(e=e.toLowerCase(),this.copyAlarmTypeList.forEach((function(t){var a=t.alarmname.toLowerCase();-1!=a.indexOf(e)?t.show=!0:t.show=!1})))}},methods:{calcSelectLength:function(){for(var e=0,t=0;t<this.checkboxObjLength;t++){var a=this.checkboxObj[t+1];a&&e++}this.selectLength=e},getForceAlarmData:function(){for(var e="",t=this.checkboxObjLength,a=0;a<t;a++){var i=this.checkboxObj[a+1];e+=i?"1":"0"}return e},onChange:function(){this.checkingSelectState(),this.calcSelectLength()},onChangeAll:function(e){var t=0,a=this.checkboxObj;for(var i in a)a[i]=e,e&&t++;this.selectLength=t},handleClose:function(){this.$emit("input",!1)},handleClear:function(){this.sosoValue=""},checkingSelectState:function(){var e=this.checkboxObj,t=!0;for(var a in e)0==e[a]&&(t=!1);this.isSelectAll=t},handleComfirm:function(){var e=this.getForceAlarmData();this.$emit("onChange",e),this.$emit("input",!1)}}},l=o,c=(a("3b2d"),a("2877")),d=Object(c["a"])(l,i,r,!1,null,"11110ee4",null),m=d.exports;t["a"]=m},c51d:function(e,t,a){"use strict";a("ecfc")},d462:function(e,t,a){"use strict";var i=a("2ddc");t["a"]=i["a"]},e561:function(e,t,a){"use strict";var i=a("ea22");t["a"]=i["a"]},e716:function(e,t,a){"use strict";a("271ae")},ecfc:function(e,t,a){}}]);