(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2a3962fc"],{"33d2":function(e,t,s){"use strict";s.r(t);s("c975");var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"edit-user full"},[t("div",{staticClass:"edit-user-left"},[t("div",{staticClass:"edit-user-inner full"},[t("div",{staticClass:"edit-user-inner-title"},[t("i",{staticClass:"circle"}),t("b",{domProps:{textContent:e._s(e.$t("bgManage.editUserTitle1"))}}),t("span",{domProps:{textContent:e._s(e.$t("bgManage.editUserDesc1"))}})]),t("div",{staticClass:"edit-user-inner-content"},[t("div",{staticClass:"edit-user-inner-content-search"},[t("div",[t("el-input",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:e.$t("bgManage.pleaseEnterUsernameOrGroupname")},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}},[t("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),t("div",{on:{click:e.refreshZtree}},[t("i",{staticClass:"el-icon-refresh"})])]),t("div",{staticClass:"edit-user-inner-content-ztree"},[t("el-scrollbar",{staticStyle:{height:"100%"}},[t("ul",{staticClass:"ztree",attrs:{id:e.ztreeId}})])],1)])])]),t("div",{staticClass:"edit-user-right"},[t("div",{staticClass:"edit-user-inner full"},[t("div",{staticClass:"edit-user-inner-title"},[t("i",{staticClass:"circle"}),t("b",{domProps:{textContent:e._s(e.rightTitle)}}),t("span",{domProps:{textContent:e._s(e.$t("bgManage.editUserDesc2"))}})]),t("div",{staticClass:"edit-user-inner-content"},[t("div",{staticClass:"full",staticStyle:{overflow:"hidden"}},["user"==e.activeTab?t("div",{staticClass:"user"},[t("el-row",{directives:[{name:"show",rawName:"v-show",value:e.username!==e.userName,expression:"username !== userName"}],staticClass:"margin_b12"},[t("el-col",{staticClass:"red-star",attrs:{span:1}},[e._v("*")]),t("el-col",{attrs:{span:23}},[t("DropdownZtreeUser",{ref:"ztreeUser",attrs:{showLabel:"",label:e.$t("reportForm.creater")},model:{value:e.creater,callback:function(t){e.creater=t},expression:"creater"}})],1)],1),t("el-row",{staticClass:"margin_b12"},[t("el-col",{staticClass:"red-star",attrs:{span:1}},[e._v("*")]),t("el-col",{attrs:{span:11}},[t("LabelWrap",{attrs:{label:e.$t("bgManage.loginUser")}},[t("el-input",{staticStyle:{width:"100%"},attrs:{disabled:!0},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1)],1),t("el-col",{attrs:{span:11,offset:1}},[t("LabelWrap",{attrs:{label:e.$t("bgManage.contacts")}},[t("el-input",{staticStyle:{width:"100%"},attrs:{disabled:e.disabled,placeholder:e.$t("bgManage.pleaseEnterContacts")},model:{value:e.cardname,callback:function(t){e.cardname=t},expression:"cardname"}})],1)],1)],1),t("el-row",{staticClass:"margin_b12"},[t("el-col",{staticClass:"red-star",attrs:{span:1}},[e._v("*")]),t("el-col",{attrs:{span:11}},[t("LabelWrap",{attrs:{label:e.$t("bgManage.accountLevel")}},[t("el-select",{staticStyle:{width:"100%"},attrs:{disabled:e.disabled},model:{value:e.userLevel,callback:function(t){e.userLevel=t},expression:"userLevel"}},e._l(e.userOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:11,offset:1}},[t("LabelWrap",{staticStyle:{width:"100%"},attrs:{label:e.$t("device.driverphone")}},[t("el-input",{attrs:{disabled:e.disabled,placeholder:e.$t("bgManage.pleaseEnterPhone")},model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}})],1)],1)],1),t("el-row",{staticClass:"margin_b12"},[t("el-col",{attrs:{span:11,offset:1}},[t("LabelWrap",{attrs:{label:e.$t("bgManage.nickname")}},[t("el-input",{staticStyle:{width:"100%"},attrs:{disabled:e.disabled,placeholder:e.$t("bgManage.pleaseEnterNickname")},model:{value:e.showname,callback:function(t){e.showname=t},expression:"showname"}})],1)],1),t("el-col",{attrs:{span:11,offset:1}},[t("LabelWrap",{attrs:{label:e.$t("common.email")}},[t("el-input",{staticStyle:{width:"100%"},attrs:{disabled:e.disabled,placeholder:e.$t("bgManage.pleaseEnterEmail")},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})],1)],1)],1),t("el-row",{staticClass:"margin_b12"},[t("el-col",{attrs:{span:11,offset:1}},[t("LabelWrap",{attrs:{label:e.$t("bgManage.moreLanding")}},[t("el-select",{staticStyle:{width:"100%"},attrs:{disabled:e.disabled},model:{value:e.multilogin,callback:function(t){e.multilogin=t},expression:"multilogin"}},e._l(e.loginOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:11,offset:1}},[t("LabelWrap",{attrs:{label:e.$t("common.weChat")}},[t("el-input",{staticStyle:{width:"100%"},attrs:{disabled:e.disabled,placeholder:e.$t("bgManage.pleaseEnterWeChat")},model:{value:e.wechat,callback:function(t){e.wechat=t},expression:"wechat"}})],1)],1)],1),t("el-row",{staticClass:"margin_b12"},[t("el-col",{attrs:{span:11,offset:1}},[t("LabelWrap",{attrs:{label:e.$t("bgManage.companyName")}},[t("el-input",{staticStyle:{width:"100%"},attrs:{disabled:e.disabled,placeholder:e.$t("bgManage.pleaseEnterCorporateName")},model:{value:e.companyname,callback:function(t){e.companyname=t},expression:"companyname"}})],1)],1),t("el-col",{attrs:{span:11,offset:1}},[t("LabelWrap",{attrs:{label:"QQ"}},[t("el-input",{staticStyle:{width:"100%"},attrs:{disabled:e.disabled,placeholder:e.$t("bgManage.pleaseEnterQQ")},model:{value:e.qq,callback:function(t){e.qq=t},expression:"qq"}})],1)],1)],1),t("el-row",{staticClass:"margin_b12"},[t("el-col",{attrs:{span:23,offset:1}},[t("LabelWrap",{attrs:{label:e.$t("bgManage.companyAddress")}},[t("el-input",{staticStyle:{width:"100%"},attrs:{disabled:e.disabled,placeholder:e.$t("bgManage.pleaseEnterCorporateAddress")},model:{value:e.address,callback:function(t){e.address=t},expression:"address"}})],1)],1)],1),t("el-row",{staticClass:"margin_b12"},[t("el-col",{staticStyle:{"text-align":"center","padding-top":"10px"},attrs:{span:23,offset:1}},[t("el-button",{staticStyle:{width:"90px"},attrs:{type:"primary",loading:e.loading,disabled:e.disabled},on:{click:e.handleClickSave}},[e._v(e._s(e.$t("common.save")))]),e._v("       "),t("el-popconfirm",{attrs:{placement:"top","confirm-button-text":e.$t("common.confirm"),"cancel-button-text":e.$t("common.cancel"),icon:"el-icon-info","icon-color":"red",title:e.$t("tips.confirmDelete")},on:{confirm:e.onDeleteUser}},[t("el-button",{staticStyle:{width:"90px"},attrs:{slot:"reference",type:"danger",disabled:e.disabled},slot:"reference"},[e._v(e._s(e.$t("common.delete")))])],1),e._v("       "),e.username!=e.userName?t("el-popover",{attrs:{placement:"top",width:"200"},model:{value:e.visible2,callback:function(t){e.visible2=t},expression:"visible2"}},[t("div",{staticStyle:{"text-align":"center"}},[t("div",{staticStyle:{"border-bottom":"1px solid #EBEEF5",height:"30px"}},[e._v(e._s(e.$t("common.resetPass")))]),t("div",{staticStyle:{"margin-top":"20px"}},[e._v(" "+e._s(e.$t("common.defaultPassword"))+" ")])]),t("div",{staticStyle:{"text-align":"center","margin-top":"20px"}},[t("el-button",{staticStyle:{width:"70px"},attrs:{size:"mini"},on:{click:function(t){e.visible2=!1}}},[e._v(e._s(e.$t("common.cancel")))]),t("span",{staticStyle:{padding:"10px"}}),t("el-button",{staticStyle:{width:"70px"},attrs:{type:"primary",size:"mini"},on:{click:e.onRsetPassword}},[e._v(e._s(e.$t("common.determine")))])],1),t("el-button",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(e.$t("common.resetPass")))])],1):e._e()],1)],1)],1):e._e(),"group"==e.activeTab?t("div",{staticClass:"group"},[t("el-row",{staticClass:"margin_b12"},[t("el-col",{staticClass:"red-star",attrs:{span:1}},[e._v("*")]),t("el-col",{attrs:{span:23}},[0==e.groupid?t("LabelWrap",{attrs:{label:e.$t("reportForm.creater")}},[t("div",{staticClass:"full",staticStyle:{padding:"6px 0px 0px 15px","font-size":"13px","background-color":"#F5F7FA",color:"#C0C4CC"},domProps:{textContent:e._s(e.groupCreater)}})]):t("DropdownZtreeUser",{ref:"ztreeGourpUser",attrs:{showLabel:"",label:e.$t("reportForm.creater")},model:{value:e.groupCreater,callback:function(t){e.groupCreater=t},expression:"groupCreater"}})],1)],1),t("el-row",{staticClass:"margin_b12"},[t("el-col",{attrs:{span:23,offset:1}},[t("LabelWrap",{attrs:{label:e.$t("reportForm.groupName")}},[t("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("bgManage.pleaseEnterGroupName"),disabled:e.isDisabled},model:{value:e.groupname,callback:function(t){e.groupname=t},expression:"groupname"}})],1)],1)],1),t("el-row",{staticClass:"margin_b12"},[t("el-col",{staticStyle:{"text-align":"center","padding-top":"10px"},attrs:{span:23,offset:1}},[t("el-button",{staticStyle:{width:"90px"},attrs:{type:"primary",loading:e.editGroupLoading,disabled:e.isDisabled},on:{click:e.handleEditGroup}},[e._v(e._s(e.$t("common.save")))]),e._v("       "),t("el-button",{staticStyle:{width:"90px"},attrs:{loading:e.deleteLoading,type:"danger",disabled:e.isDisabled},on:{click:e.handleDeleteGroup}},[e._v(e._s(e.$t("common.delete")))]),e._v("       "),0!=e.groupid?t("el-button",{staticStyle:{width:"90px"},attrs:{type:"primary",plain:""},on:{click:function(t){e.modal=!0}}},[e._v(e._s(e.$t("missing.shareGroup")))]):e._e()],1)],1)],1):e._e()])])])]),t("el-dialog",{attrs:{title:e.groupname+" - "+e.$t("bgManage.shareGroup")+"("+e.tocreaters.length+")",center:"",visible:e.modal,width:"760px","append-to-body":"","close-on-click-modal":!1},on:{close:function(t){e.modal=!1}}},[t("el-row",{staticClass:"margin_b12"},[t("el-col",{attrs:{span:24}},[t("vxe-table",{ref:"xTable",attrs:{border:"",resizable:"","auto-resize":"","show-overflow":"","highlight-current-row":"",size:"mini",height:"300",data:e.userList},on:{"checkbox-all":e.selectAllEvent,"checkbox-change":e.selectChangeEvent}},[t("vxe-table-column",{attrs:{type:"seq",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{type:"checkbox",width:"50"}}),t("vxe-table-column",{attrs:{field:"username",title:e.$t("bgManage.user"),filters:[{username:""}],"filter-method":e.filterAgeMethod},scopedSlots:e._u([{key:"filter",fn:function(s){var a=s.$panel,r=s.column;return[e._l(r.filters,(function(s,r){return[t("div",{staticStyle:{padding:"5px"}},[t("div",{staticClass:"el-input--small"},[t("input",{directives:[{name:"model",rawName:"v-model",value:s.data,expression:"option.data"}],key:r,staticClass:"el-input__inner",attrs:{type:"type",placeholder:"按回车确认筛选"},domProps:{value:s.data},on:{input:[function(t){t.target.composing||e.$set(s,"data",t.target.value)},function(e){return a.changeOption(e,!!s.data,s)}],keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:a.confirmFilter()}}})])])]}))]}}])}),t("vxe-table-column",{attrs:{field:"showname",title:e.$t("bgManage.displayName"),sortable:""}}),t("vxe-table-column",{attrs:{title:e.$t("reportForm.creater"),field:"creater",sortable:""}})],1)],1)],1),t("el-row",{staticClass:"margin_b12"},[t("el-col",{staticStyle:{"text-align":"center"},attrs:{span:24}},[t("el-button",{staticStyle:{width:"120px"},attrs:{type:"primary",loading:e.saveLoading},on:{click:e.addShareGroup}},[e._v(e._s(e.$t("common.save")))])],1)],1)],1)],1)},r=[],n=s("5530"),i=(s("99af"),s("d81d"),s("14d9"),s("4e82"),s("b0c0"),s("e9c4"),s("a9e3"),s("b680"),s("b64b"),s("d3b7"),s("498a"),s("159b"),s("4795"),s("c276")),o=s("cd6d"),l=s.n(o),c=s("6e52"),d=s("c7bc"),u=s("0139"),p=s("2f62"),m=s("b562"),h=s("e285"),g=s("0d33"),v=s("7fa8"),b={name:"editUser",data:function(){return{loading:!1,isUser:!0,modal:!1,visible2:!1,activeTab:"user",creater:"",groupCreater:"",tocreater:"",tocreaters:[],username:"",password:"123456",companyname:"",address:"",userIcon:g,groupIcon:v,userLevel:"",showname:"",cardname:"",email:"",qq:"",wechat:"",phone:"",userOptions:[],multilogin:1,loginOptions:[],groupname:"",groupid:"",searchText:"",isDisabled:!1,editGroupLoading:!1,deleteLoading:!1,saveLoading:!1,userList:[]}},computed:Object(n["a"])(Object(n["a"])({},Object(p["b"])(["isZh","userName","userLevelList","isQueryInitData","userType"])),{},{ztreeId:function(){return"ztreeEl_".concat(this._uid)},rightTitle:function(){return this.isZh?this.isUser?"编辑用户":"编辑分组":this.isUser?"Edit user":"Edit group"},disabled:function(){return this.username==this.userName}}),watch:{searchText:function(e){this.searchZtree(this,e.trim())},isQueryInitData:function(e){e&&this.init()},creater:function(e){if(this.isTreeCheck)this.isTreeCheck=!1;else{var t=c["a"].getUserByUserName(e);t&&(this.userOptions=this.getUserOptions(t.usertype,11==t.usertype),this.userOptions.length>0&&(this.userLevel=this.userOptions[0].value))}},modal:function(e){var t=this;if(e){var s=this.groupCreater,a=this.cacheList,r=[];a.forEach((function(e){e.username!=s&&r.push(JSON.parse(JSON.stringify(e)))})),this.userList=r,setTimeout((function(){var e=t.$refs.xTable;Object(h["tb"])(t.groupid).then((function(s){var a=s.groups;if(a){var r=a.map((function(e){return e.tocreater})),n=t.userList;r.forEach((function(t){n.forEach((function(s){s.username==t&&e.setCheckboxRow(s,!0)}))})),t.tocreaters=r}}))}),300)}else{var n=this.$refs.xTable;n.setAllCheckboxRow(!1)}}},components:{DropdownZtreeUser:d["a"],LabelWrap:u["a"]},methods:Object(n["a"])(Object(n["a"])({},Object(p["c"])(["setIsReloadRootuser","setReportTagList"])),{},{filterAgeMethod:function(e){var t=e.option,s=e.row;return-1!=s.username.indexOf(t.data)},selectAllEvent:function(e){e.checked;var t=e.records;this.tocreaters=t.map((function(e){return e.username}))},selectChangeEvent:function(e){e.checked;var t=e.records;this.tocreaters=t.map((function(e){return e.username}))},searchZtree:Object(i["e"])((function(e,t){if(e.ztreeIns.destroy(),0==t.length)e.ztreeIns=$.fn.zTree.init($("#".concat(e.ztreeId)),e.setting,e.treeNodes);else{var s=e.variableDeepSearch(e.treeNodes,t);e.ztreeIns=$.fn.zTree.init($("#".concat(e.ztreeId)),e.setting,s)}}),300),onDeleteUser:function(){var e=this;if(null!=this.treeId){var t=[this.username];Object(h["I"])(t).then((function(s){var a=s.status,r=s.cause,n=s.count,i=s.bonuspoints,o=s.addvaluepoints,l=s.commission;if(0==a)c["a"].removeUser(t[0]),e.treeNodes=e.castUsersTreeToDevicesTree(c["a"].rootuser),e.ztreeIns.removeNode(e.ztreeIns.getNodeByTId(e.treeId)),e.treeId=null,e.$XModal.message({message:e.$t("tips.deleteSucc"),status:"success",zIndex:9999}),e.setReportTagList([]),e.setIsReloadRootuser(!0);else if(1==a)e.$XModal.message({message:e.$t("tips.accountAndDevice",{count:n}),status:"error",zIndex:9999});else if(2==a){var d="";i>0&&(d+=e.$t("bgManage.bonuspoints")+" "+i.toFixed(0)),o>0&&(d.length>0&&(d+=","),d+=e.$t("bgManage.addvaluepoints")+" "+Number(o.toFixed(2))),l>0&&(d.length>0&&(d+=","),d+=e.$t("bgManage.commission")+" "+Number(l.toFixed(2))),e.$XModal.message({message:e.$t("tips.accountAndGoldenBean",{str:d}),status:"error",zIndex:9999})}else e.$XModal.message({message:e.$t("tips.deleteFail")+r,status:"error",zIndex:9999})}))}},onRsetPassword:function(){var e=this;if(null!=this.treeId){var t=this.username;Object(h["ec"])(t).then((function(t){var s=t.status,a=(t.newpass,t.cause);0==s?e.$XModal.message({message:e.$t("tips.resetPassSucc"),status:"success",zIndex:9999}):e.$XModal.message({message:e.$t("tips.resetPassFail")+a,status:"error",zIndex:9999})}))}},handleClickSave:function(){var e=this;if(null!=this.oilCreater){var t={creater:this.creater,username:this.username,showname:this.showname,companyaddr:this.address,multilogin:this.multilogin,email:this.email,wechat:this.wechat,phone:this.phone,usertype:this.userLevel,companyname:this.companyname,cardname:this.cardname,qq:this.qq};this.loading=!0,Object(h["V"])(t).then((function(s){var a=s.status,r=s.cause;if(e.loading=!1,0==a){if(e.oilCreater==t.creater){var n=e.ztreeIns.getNodeByTId(e.treeId);n.name=t.showname?t.showname:t.username,n.name=n.name+"("+n.totalCount+")",e.ztreeIns.updateNode(n),c["a"].editUser(e.oilCreater,t),e.treeNodes=e.castUsersTreeToDevicesTree(c["a"].rootuser)}else e.oilCreater=null,Object(m["S"])().then((function(s){var a=s.status,r=s.rootuser;0==a&&(c["a"].rootuser=r,c["a"].setDeviceInfos(r),e.initZtree(),e.$refs.ztreeUser.initZtree(),e.$refs.ztreeUser.selectedUser(t.creater))}));e.setReportTagList([]),e.setIsReloadRootuser(!0),e.$XModal.message({message:e.$t("tips.saveSucc"),status:"success",zIndex:9999})}else 1==a?e.$XModal.message({message:e.$t("tips.noPermissionToCreater"),status:"error",zIndex:9999}):e.$XModal.message({message:e.$t("tips.saveFail")+r,status:"error",zIndex:9999})}))}},handleEditGroup:function(){var e=this,t=this.groupCreater,s=this.groupid,a=this.groupname;if(t&&s&&a){this.editGroupLoading=!0;var r={creater:t,groupid:s,groupname:a};Object(h["R"])(r).then((function(n){var i=n.status,o=n.cause;if(e.editGroupLoading=!1,0==i){var l=e.ztreeIns.getNodeByTId(e.treeId),d=l.getParentNode(),u=d.username;l.name=a+"("+l.totalCount+")",l.groupname=a,t==u?(e.ztreeIns.updateNode(l),c["a"].editGroup(d.username,r),e.treeNodes=e.castUsersTreeToDevicesTree(c["a"].rootuser)):(e.ztreeIns.removeNode(l),c["a"].removeGroupAndAdd(u,t,s),e.initZtree()),e.setReportTagList([]),e.setIsReloadRootuser(!0),e.$XModal.message({message:e.$t("tips.saveSucc"),status:"success",zIndex:9999})}else 2==i?e.$XModal.message({message:e.$t("tips.editDeviceFailTip3"),status:"error",zIndex:9999}):e.$XModal.message({message:e.$t("tips.saveFail")+o,status:"error",zIndex:9999})}))}},handleDeleteGroup:function(){var e=this,t=this.groupid,s=this.groupname;if(t&&s){var a=this.ztreeIns.getNodeByTId(this.treeId);if(a){var r=this.ztreeIns.getNodeByTId(a.parentTId),n={groupid:t,username:r.username};this.deleteLoading=!0,Object(h["D"])(n).then((function(s){var r=s.status,i=s.cause,o=s.count;e.deleteLoading=!1,0==r?(e.username="",e.ztreeIns.removeNode(a),c["a"].removeGroup(n.username,t),e.setReportTagList([]),e.setIsReloadRootuser(!0),e.$XModal.message({message:e.$t("tips.deleteSucc"),status:"success",zIndex:9999})):1==r?e.$XModal.message({message:e.$t("tips.deleteGroupFail",{count:o}),status:"error",zIndex:9999}):e.$XModal.message({message:e.$t("tips.deleteFail")+i,status:"error",zIndex:9999})})).catch((function(t){e.deleteLoading=!1}))}}},addShareGroup:function(){var e=this,t=this.groupid,s=this.groupname,a=this.tocreaters;if(0!=a.length){var r=this.ztreeIns.getNodeByTId(this.treeId),n=this.ztreeIns.getNodeByTId(r.parentTId),i={groupid:t,groupname:s,fromcreater:n.username,tocreaters:a};this.saveLoading=!0,Object(h["j"])(i).then((function(t){var s=t.status,a=t.cause;e.saveLoading=!1,0==s?(e.modal=!1,e.$XModal.message({message:e.$t("tips.shareSucc"),status:"success",zIndex:9999})):e.$XModal.message({message:e.$t("tips.shareFail")+a,status:"error",zIndex:9999})}))}else this.$XModal.message({message:this.$t("tips.selectUser"),status:"success",zIndex:9999})},refreshZtree:function(){this.ztreeIns.destroy(),this.initZtree()},getTreeNodeByUsername:function(e,t){var s=null;function a(e,t){for(var r in e){var n=e[r];"user"===n.nodeType&&n.username&&n.username==t?s=n:n.children&&n.children.length>0&&a(n.children,t)}}return a(e,t),s},initZtree:function(){var e=this.castUsersTreeToDevicesTree(c["a"].rootuser);this.treeNodes=e,this.ztreeIns=$.fn.zTree.init($("#".concat(this.ztreeId)),this.setting,e),this.selectedRoot()},variableDeepSearch:function(e,t){t=t.toLowerCase();for(var s=[],a=this,r=0;r<e.length;r++){var n=null,i=e[r];if(null!=i){var o=!1;if((-1!=i.name.toLowerCase().indexOf(t)||i.username&&-1!=i.username.toLowerCase().indexOf(t))&&(n=l()(i),n.open=!1,o=!0),0==o&&i.children&&i.children.length>0){var c=a.variableDeepSearch(i.children,t);c&&c.length>0&&(n=l()(i),n.children=c,n.open=!0,o=!0)}1==o&&s.push(n)}}return s},selectedRoot:function(){var e=this.ztreeIns.getNodes()[0];e&&this.ztreeIns.checkNode(e,!0)},castUsersTreeToDevicesTree:function(e){var t={name:"",icon:g,username:"",open:!0,nodeType:c["a"].NodeType_User};if(null!=e){var s=e.username,a=e.subusers;e.showname;t.name=s,t.username=s;var r=this.getDeviceListGroups(e.groups,s);if(null!=s&&null!=a&&a.length>0){var n=this.doCastUsersTreeToDevicesTree(a);n&&n.length&&(t.children=n)}var o=r.concat(t.children?t.children:[]);o.length&&(t.children=o,Object(i["Gb"])(t.children));var l=0;if(t.children)for(var d=0;d<t.children.length;++d){var u=t.children[d];void 0!=u.totalCount?l+=u.totalCount:l++}t.totalCount=l,t.name+="("+l+")"}return[t]},doCastUsersTreeToDevicesTree:function(e){var t=[];if(null!=e&&e.length>0)for(var s=0;s<e.length;++s){var a=e[s],r=a.username,n=a.subusers,o=a.showname,l={name:o||r,icon:g,username:r,nodeType:c["a"].NodeType_User};if(null!=r&&null!=n&&n.length>0){var d=this.doCastUsersTreeToDevicesTree(n);d&&d.length&&(l.children=d)}var u=this.getDeviceListGroups(a.groups,r),p=u.concat(l.children?l.children:[]);p.length&&(l.children=p,Object(i["Gb"])(l.children));var m=0;if(l.children)for(var h=0;h<l.children.length;++h){var v=l.children[h];void 0!=v.totalCount?m+=v.totalCount:m++}l.totalCount=m,l.name+="("+m+")",t.push(l)}return t},getDeviceListGroups:function(e,t){var s=[];if(e){for(var a=this.$t("common.defaultGroup"),r=0;r<e.length;++r){var n=e[r],i=void 0===n.shared?0:n.shared,o=n.groupid>0,l=o?n.groupname:a,d={groupid:n.groupid,name:l+"("+n.devices.length+")",groupname:l,icon:v,id:t+"_"+n.groupid,nodeType:c["a"].NodeType_Group,totalCount:n.devices.length,shared:i};o?1!==i&&s.push(d):n.devices.length>0&&s.push(d)}s.sort((function(e,t){return e.groupid-t.groupid}))}return s},getUserOptions:function(e,t){var s=[],a=!1;return this.userLevelList.forEach((function(r){var n=r.name,i=r.type;0==a&&t&&e==i&&(s.push({label:n,value:Number(i)}),a=!0),i>e&&i<=11&&s.push({label:n,value:Number(i)})})),s},init:function(){var e=this;this.$nextTick((function(){Object(h["Rb"])(e.userName,0).then((function(t){var s=t.userlists,a=[];s&&s.forEach((function(e){e.usertype<20&&a.push(e)})),e.cacheList=a})),Object(h["Qb"])(e.userName).then((function(t){e.username=t.username,e.showname=t.showname,e.cardname=t.cardname,e.companyname=t.companyname,e.address=t.companyaddr,e.multilogin=t.multilogin,e.email=t.email,e.wechat=t.wechat,e.phone=t.phone,e.qq=t.qq,e.userLevel=Number(t.usertype),e.oilCreater=t.creater,e.creater=t.creater,e.$refs.ztreeUser&&e.$refs.ztreeUser.selectedUser(t.creater);var s=c["a"].getUserByUserName(e.userName);s&&(e.userLevel=s.usertype,e.userOptions=e.getUserOptions(s.usertype,!0),e.userOptions.length&&(e.userLevel=e.userOptions[0].value)),e.initZtree()}))}))},onTreeCheck:function(e,t,s){var a=this;this.treeId=s.tId;var r=s.nodeType;if(this.activeTab=r,r==c["a"].NodeType_User){this.isUser=!0,this.groupname="",this.groupid="";var n=s.username;this.isTreeCheck=!0,Object(h["Qb"])(n).then((function(e){a.username=e.username,a.showname=e.showname,a.cardname=e.cardname,a.companyname=e.companyname,a.address=e.companyaddr,a.multilogin=e.multilogin,a.email=e.email,a.wechat=e.wechat,a.phone=e.phone,a.qq=e.qq,a.userLevel=Number(e.usertype),a.oilCreater=e.creater,a.creater=e.creater,a.$refs.ztreeUser&&a.$refs.ztreeUser.selectedUser(e.creater);var t=c["a"].getUserByUserName(e.creater);a.userOptions=t?a.getUserOptions(t.usertype,!1):a.getUserOptions(a.userType,!0)}))}else{this.isUser=!1,this.groupname=s.groupname,this.groupid=s.groupid;var i=s.getParentNode();this.groupCreater=i.username,0!=s.groupid?setTimeout((function(){a.$refs.ztreeGourpUser&&a.$refs.ztreeGourpUser.selectedUser(a.groupCreater)}),800):this.tocreaters=[],this.oilCreater=null,this.isDisabled=0==s.groupid}},zTreeOnClick:function(e,t,s){this.ztreeIns.checkNode(s),this.onTreeCheck(e,t,s)}}),created:function(){this.isTreeCheck=!1,this.treeId=null,this.oilCreater=null,this.groupname="",this.groupid="",this.setting={view:{dblClickExpand:!1},check:{enable:!0,chkStyle:"radio",radioType:"all"},callback:{onCheck:this.onTreeCheck,onClick:this.zTreeOnClick}}},mounted:function(){var e=this;this.isQueryInitData&&this.init(),this.$nextTick((function(){e.loginOptions=[{label:e.$t("bgManage.singleLongin"),value:0},{label:e.$t("bgManage.multipleLogin"),value:1}]}))}},f=b,y=(s("f3f6"),s("2877")),C=Object(y["a"])(f,a,r,!1,null,null,null),x=C.exports;t["default"]=x},c0a2:function(e,t,s){},f3f6:function(e,t,s){"use strict";s("c0a2")}}]);