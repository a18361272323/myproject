(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a7797274"],{"0595":function(e,t,i){"use strict";var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"quick-time-range"},[t("div",{staticClass:"quick-time-range-wrapper"},e._l(e.list,(function(i){return t("div",{key:i.type,style:{color:i.type==e.type?"#409EFF":""},on:{click:function(t){return e.selectDate(i.type)}}},[e._v(e._s(i.label))])})),0),t("div",{staticClass:"quick-time-range-space"}),t("div",{staticClass:"quick-time-range-btn",on:{click:function(t){e.isCollapse=!e.isCollapse}}},[e.isCollapse?t("i",{staticClass:"el-icon-arrow-right"}):t("i",{staticClass:"el-icon-arrow-left"})])])},n=[],s=i("5101"),r={name:"QuickTimeRange",props:{value:{type:Array,default:function(){return[]}},dateType:{type:String,default:"date"}},watch:{isCollapse:function(){this.setList()}},data:function(){return{isCollapse:!0,type:0,list:[]}},methods:{setList:function(){this.isCollapse?this.list=[{label:this.$t("reportForm.toDay"),type:0},{label:this.$t("reportForm.yesterDay"),type:1},{label:this.$t("reportForm.recent3Days"),type:3}]:this.list=[{label:this.$t("reportForm.recent7Days"),type:7},{label:this.$t("reportForm.recent10Days"),type:10},{label:this.$t("reportForm.recent30Days"),type:30}]},selectDate:function(e){var t="datetimerange"==this.dateType,i=[],a=new Date,n=new Date;switch(t&&(a=new Date(s["a"].format(new Date,"yyyy-MM-dd")+" 00:00:00"),n=new Date(s["a"].format(new Date,"yyyy-MM-dd")+" 23:59:59")),e){case 0:i=[new Date(s["a"].format(a,"yyyy-MM-dd")+" 00:00:00"),new Date(s["a"].format(n,"yyyy-MM-dd")+" 23:59:59")];break;case 1:a.setTime(a.getTime()-864e5),i=[a,n];break;case 3:a.setTime(a.getTime()-2592e5),i=[a,n];break;case 7:a.setTime(a.getTime()-6048e5),i=[a,n];break;case 10:a.setTime(a.getTime()-864e6),i=[a,n];break;case 30:a.setTime(a.getTime()-2592e6),i=[a,n];break}this.type=e,this.$emit("input",i)}},mounted:function(){var e=this;this.$nextTick((function(){e.setList()}))}},o=r,c=(i("c51d"),i("2877")),l=Object(c["a"])(o,a,n,!1,null,null,null);t["a"]=l.exports},"26c6":function(e,t,i){"use strict";var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"multi-choice single-choice-vehicle",style:{width:e.width}},[e.showLabel?t("div",{staticClass:"multi-choice-label"},[e._v(" "+e._s(e.$t("common.selectDevice"))+" ")]):e._e(),t("div",{staticClass:"multi-choice-input"},[t("ZtreeDeviceDropdown",{attrs:{placeholder:e.placeholder,disableShare:e.disableShare,isQueryInitData:e.isQueryInitData},model:{value:e.deviceid,callback:function(t){e.deviceid=t},expression:"deviceid"}})],1)])},n=[],s=i("5530"),r=i("2f62"),o=i("2df7"),c={props:{value:{type:String,default:""},width:{type:String,default:"230px"},showLabel:{type:Boolean,default:!1},disableShare:{type:Boolean,default:!1},placeholder:{type:String,default:""}},name:"SingleChoiceVehicle",data:function(){return{deviceid:""}},watch:{value:function(e){e&&(this.deviceid=e)},deviceid:function(e){this.$emit("input",e)}},computed:Object(s["a"])({},Object(r["b"])(["isQueryInitData"])),components:{ZtreeDeviceDropdown:o["a"]},methods:{},mounted:function(){this.value&&(this.deviceid=this.value)}},l=c,d=(i("facb"),i("2877")),h=Object(d["a"])(l,a,n,!1,null,null,null);t["a"]=h.exports},"271ae":function(e,t,i){},"2ddc":function(e,t,i){"use strict";var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"multi-choice",style:e.warpStyle},[t("div",{staticClass:"multi-choice-input"},["daterange"==e.dateType?t("div",[t("el-date-picker",{attrs:{type:e.dateType,"picker-options":e.pickerOptions,"range-separator":"-",align:"center","unlink-panels":"",clearable:!1,"start-placeholder":e.$t("device.driverinitialdate"),"end-placeholder":e.$t("device.drivereffectivedate")},on:{change:e.onChange},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1):e._e(),"date"==e.dateType?t("div",[t("el-date-picker",{attrs:{type:"date","picker-options":e.datePickerOptions},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1):e._e(),"datetimerange"==e.dateType?t("div",{staticClass:"datetimerange"},[t("el-date-picker",{attrs:{type:e.dateType,"range-separator":"-","picker-options":e.pickerOptionsTime,align:"center","unlink-panels":"",clearable:!1,"start-placeholder":e.$t("device.driverinitialdate"),"end-placeholder":e.$t("device.drivereffectivedate"),"default-time":["00:00:00","23:59:59"]},on:{change:e.onChange},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1):e._e(),"month"==e.dateType?t("div",[t("el-date-picker",{attrs:{type:"month"},model:{value:e.month,callback:function(t){e.month=t},expression:"month"}})],1):e._e()])])},n=[],s=(i("99af"),i("5101")),r=i("5867"),o={name:"SelectDate",props:{value:{type:Array|Date,default:function(){return[]}},dateType:{type:String,default:"daterange"},label:{type:String,default:function(){return this.$t("common.selectTime")}}},computed:{isDaterange:function(){return"daterange"==this.dateType},warpStyle:function(){var e=200;switch(this.dateType){case"date":e=120;break;case"daterange":e=230;break;case"datetimerange":e=310;break}return{width:"".concat(e,"px")}}},mixins:[r["a"]],data:function(){var e=864e5;return{dateRange:[],date:new Date,month:new Date,pickerOptions:{shortcuts:[{text:this.$t("reportForm.toDay"),onClick:function(e){var t=new Date;e.$emit("pick",[t,t])}},{text:this.$t("reportForm.yesterDay"),onClick:function(t){var i=new Date;i.setTime(i.getTime()-e),t.$emit("pick",[i,i])}},{text:this.$t("missing.theWeek"),onClick:function(t){var i=new Date,a=new Date,n=i.getDay();i.setTime(i.getTime()-e*(n-1)),a.setTime(i.getTime()+6*e),t.$emit("pick",[i,a])}},{text:this.$t("missing.lastWeek"),onClick:function(t){var i=new Date,a=new Date,n=i.getDay(),s=i.getTime()-e*(n-1);i.setTime(s-7*e),a.setTime(s-e),t.$emit("pick",[i,a])}},{text:this.$t("missing.thisMonth"),onClick:function(e){var t=new Date,i=t.getFullYear(),a=t.getMonth()+1,n=new Date("".concat(i,"-").concat(a,"-01")),s=new Date("".concat(i,"-").concat(a,"-01 00:00:00"));s.setMonth(s.getMonth()+1),s=new Date(s.getTime()-1e3),e.$emit("pick",[n,s])}},{text:this.$t("missing.lastMonth"),onClick:function(e){var t=new Date;t.setMonth(t.getMonth()-1);var i=t.getFullYear(),a=t.getMonth()+1,n=new Date(new Date(i,a,1)-1).getDate(),s=new Date("".concat(i,"-").concat(a,"-01")),r=new Date("".concat(i,"-").concat(a,"-").concat(n));e.$emit("pick",[s,r])}}]},pickerOptionsTime:{shortcuts:[{text:this.$t("reportForm.toDay"),onClick:function(e){var t=new Date(s["a"].format(new Date,"yyyy-MM-dd")+" 00:00:00"),i=new Date(s["a"].format(new Date,"yyyy-MM-dd")+" 23:59:59");e.$emit("pick",[t,i])}},{text:this.$t("reportForm.yesterDay"),onClick:function(t){var i=new Date;i.setTime(i.getTime()-e),t.$emit("pick",[new Date(s["a"].format(i,"yyyy-MM-dd")+" 00:00:00"),new Date(s["a"].format(i,"yyyy-MM-dd")+" 23:59:59")])}},{text:this.$t("missing.theWeek"),onClick:function(t){var i=new Date,a=new Date,n=i.getDay();i.setTime(i.getTime()-e*(n-1)),a.setTime(i.getTime()+6*e),t.$emit("pick",[new Date(s["a"].format(i,"yyyy-MM-dd")+" 00:00:00"),new Date(s["a"].format(a,"yyyy-MM-dd")+" 23:59:59")])}},{text:this.$t("missing.lastWeek"),onClick:function(t){var i=new Date,a=new Date,n=i.getDay(),r=i.getTime()-e*(n-1);i.setTime(r-7*e),a.setTime(r-e),t.$emit("pick",[new Date(s["a"].format(i,"yyyy-MM-dd")+" 00:00:00"),new Date(s["a"].format(a,"yyyy-MM-dd")+" 23:59:59")])}},{text:this.$t("missing.thisMonth"),onClick:function(e){var t=new Date,i=t.getFullYear(),a=t.getMonth()+1,n=new Date("".concat(i,"-").concat(a,"-01")),r=new Date("".concat(i,"-").concat(a,"-01 00:00:00"));r.setMonth(r.getMonth()+1),r=new Date(r.getTime()-1e3),e.$emit("pick",[new Date(s["a"].format(n,"yyyy-MM-dd")+" 00:00:00"),new Date(s["a"].format(r,"yyyy-MM-dd")+" 23:59:59")])}},{text:this.$t("missing.lastMonth"),onClick:function(e){var t=new Date;t.setMonth(t.getMonth()-1);var i=t.getFullYear(),a=t.getMonth()+1,n=new Date(new Date(i,a,1)-1).getDate(),r=new Date("".concat(i,"-").concat(a,"-01")),o=new Date("".concat(i,"-").concat(a,"-").concat(n));e.$emit("pick",[new Date(s["a"].format(r,"yyyy-MM-dd")+" 00:00:00"),new Date(s["a"].format(o,"yyyy-MM-dd")+" 23:59:59")])}}]}}},watch:{dateRange:function(e){null==e?this.$emit("input",[]):this.$emit("input",e)},value:function(e){this.dateRange=e},date:function(e){this.$emit("input",e)},month:function(e){this.$emit("input",e)}},methods:{onChange:function(e){this.$emit("input",e)}},mounted:function(){"date"==this.dateType?this.date=this.value:"month"==this.dateType?this.month=this.value:this.dateRange=this.value}},c=o,l=(i("e716"),i("2877")),d=Object(l["a"])(c,a,n,!1,null,"5dbb8594",null);t["a"]=d.exports},"2df7":function(e,t,i){"use strict";i("498a");var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ztree-device"},[t("el-popover",{attrs:{placement:"bottom",width:"320",trigger:"manual","append-to-body":!0,"popper-options":{boundariesElement:"body",gpuAcceleration:!0,positionFixed:!0,preventOverflow:!0}},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[t("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.handleClickOutside,expression:"handleClickOutside"}],staticClass:"ztree-drapdown",staticStyle:{height:"360px",width:"100%",overflow:"hidden"}},[t("el-scrollbar",{staticStyle:{height:"100%"}},[t("ul",{staticClass:"ztree",attrs:{id:e.ztreeId}})])],1),t("el-input",{attrs:{slot:"reference",placeholder:e.placeholder,"prefix-icon":"el-icon-search"},on:{input:e.onChange},nativeOn:{click:function(t){return e.handleClickInput.apply(null,arguments)}},slot:"reference",model:{value:e.textVal,callback:function(t){e.textVal="string"===typeof t?t.trim():t},expression:"textVal"}},[t("span",{staticClass:"el-input__suffix-inner",staticStyle:{cursor:"pointer"},attrs:{slot:"suffix"},on:{click:e.clearText},slot:"suffix"},[t("i",{staticClass:"el-input__icon el-icon-circle-close"})])])],1)],1)},n=[],s=i("5530"),r=(i("99af"),i("4de4"),i("c975"),i("d81d"),i("14d9"),i("b0c0"),i("d3b7"),i("159b"),i("4795"),i("cd6d")),o=i.n(r),c=i("6e52"),l=i("c276"),d=i("9169"),h=i("2f62"),u=i("0d33"),p=i("7fa8"),m={name:"ZtreeDeviceDropdown",props:{value:{type:String,default:""},isCheck:{type:Boolean,default:!1},isClickAll:{type:Boolean,default:!1},disableShare:{type:Boolean,default:!1},selectDeviceIds:{type:Array,default:function(){return[]}},isQueryInitData:{type:Boolean,default:!1},placeholder:{type:String,default:""}},directives:{Clickoutside:d["a"]},computed:Object(s["a"])(Object(s["a"])({},Object(h["b"])(["isZh"])),{},{ztreeId:function(){return"ztreeEl_".concat(this._uid)}}),data:function(){return{textVal:"",show:!1}},watch:{textVal:function(e){this.isClickAll?this.$emit("input",e):0==this.isCheck?e||this.$emit("input",""):e||this.$emit("onTreeCheck",[])},isQueryInitData:function(e){var t=this;this.$nextTick((function(){t.init()}))}},created:function(){this.ztreeIns=null,this.setting={view:{addDiyDom:this.addDiyDom,dblClickExpand:!1},check:{enable:!0,chkStyle:this.isCheck?"checkbox":"radio",radioType:"all"},callback:{onCheck:this.onTreeCheck,onClick:this.zTreeOnClick}}},mounted:function(){var e=this;this.$nextTick((function(){e.init()}))},destroyed:function(){this.ztreeIns&&this.ztreeIns.destroy()},methods:{init:function(){var e=this;if(this.isQueryInitData&&null==this.ztreeIns)if(this.initZtree(),0==this.isCheck){if(this.value){var t=c["a"].deviceInfos[this.value].devicename;this.textVal=t;var i=Object(l["gb"])(this.ztreeIns.getNodes(),this.value);i?this.ztreeIns.checkNode(i):console.log("ZtreeDeviceDropdown 没找到node this.textVal = ",this.textVal)}}else if(this.selectDeviceIds.length>0){var a=this.ztreeIns.getNodes();this.selectDeviceIds.forEach((function(t){var i=Object(l["gb"])(a,t);i&&e.ztreeIns.checkNode(i,!0)})),this.isZh?this.textVal="已选中".concat(this.selectDeviceIds.length,"个单位"):this.textVal="".concat(this.selectDeviceIds.length," is selected"),this.$emit("onTreeCheck",this.selectDeviceIds)}},handleClickInput:function(){var e=this;if(this.show=!0,0==this.isCheck){var t=c["a"].deviceInfos[this.value],i=t?t.devicename:null;if(i&&(this.textVal=i,this.ztreeIns&&this.ztreeIns.getNodes)){var a=Object(l["gb"])(this.ztreeIns.getNodes(),this.value);a&&setTimeout((function(){e.ztreeIns.selectNode(a)}),30)}}},clearText:function(){this.textVal="",this.ztreeIns&&(this.ztreeIns.destroy(),this.ztreeIns=null),this.treeNodeChildren.length&&(this.treeNodeChildren[0].open=!0),this.ztreeIns=$.fn.zTree.init($("#".concat(this.ztreeId)),this.setting,this.treeNodeChildren),this.isCheck?this.$emit("onTreeCheck",[]):this.$emit("input","")},handleClickOutside:function(){this.show=!1},searchDevice:Object(l["e"])((function(e,t){if(0==e.show&&(e.show=!0),e.ztreeIns.destroy(),0==t.length)e.treeNodeChildren.length&&(e.treeNodeChildren[0].open=!0),e.ztreeIns=$.fn.zTree.init($("#".concat(e.ztreeId)),e.setting,e.treeNodeChildren);else{t=t.trim();var i=e.variableDeepSearch(e.treeNodeChildren,t,0);e.ztreeIns=$.fn.zTree.init($("#".concat(e.ztreeId)),e.setting,i)}}),300),variableDeepSearch:function(e,t,i){t=t.toLowerCase();for(var a=[],n=this,s=0;s<e.length;s++){var r=null,c=e[s];if(null!=c){var l=!1;if((-1!=c.name.toLowerCase().indexOf(t)||c.showname&&-1!=c.showname.toLowerCase().indexOf(t)||c.deviceid&&-1!=c.deviceid.toLowerCase().indexOf(t)||c.simiccid&&-1!=c.simiccid.toLowerCase().indexOf(t)||c.loginname&&-1!=c.loginname.toLowerCase().indexOf(t)||c.remark&&-1!=c.remark.toLowerCase().indexOf(t)||c.remark2&&-1!=c.remark2.toLowerCase().indexOf(t)||c.simiccid&&-1!=c.simiccid.toLowerCase().indexOf(t)||c.simnum&&-1!=c.simnum.toLowerCase().indexOf(t))&&(r=c,r.open=!1,l=!0),0==l&&c.children&&c.children.length>0){var d=n.variableDeepSearch(c.children,t,i);d&&d.length>0&&(r=o()(c),r.children=d,r.open=!0,l=!0)}if(1==l&&(i++,a.push(r),i>1e3))break}}return a},onChange:function(e){this.searchDevice(this,e)},getCheckedDeviceIds:function(){var e=this.ztreeIns.getCheckedNodes(),t=[];return e.forEach((function(e){var i=e.deviceid;void 0!=i&&t.push(i)})),t},initZtree:function(){var e=this.castUsersTreeToDevicesTree(c["a"].rootuser);this.isCheck?this.treeNodeChildren=[e]:e.children&&e.children.length?this.treeNodeChildren=e.children:this.treeNodeChildren=[],this.ztreeIns=$.fn.zTree.init($("#".concat(this.ztreeId)),this.setting,this.treeNodeChildren)},addDiyDom:function(e,t){var i=$("#"+t.tId+"_check"),a=$("#"+t.tId+"_ico");a.remove(),i.before(a)},selectNode:function(e){var t=this;if(0==this.isCheck){var i=c["a"].deviceInfos[e],a=i?i.devicename:null;if(a&&(this.textVal=a,this.$emit("input",e),this.ztreeIns&&this.ztreeIns.getNodes)){var n=Object(l["gb"])(this.ztreeIns.getNodes(),this.value);n&&setTimeout((function(){t.ztreeIns.selectNode(n)}),30)}}},onTreeCheck:function(e,t,i){var a=this.ztreeIns.getCheckedNodes();if(this.isClickAll){var n=i.nodeType;if(n==c["a"].NodeType_User)this.textVal=i.username,this.$emit("input",this.textVal);else if(n==c["a"].NodeType_Group)this.textVal=i.groupname,this.$emit("input",this.textVal);else{var s=i.deviceid,r=c["a"].deviceInfos[s].devicename;this.textVal=r,this.$emit("input",s)}}else if(0==a.length)this.textVal="";else if(this.isCheck){var o=a.filter((function(e){return void 0==e.children})).map((function(e){return e.deviceid}));this.isZh?this.textVal="已选中".concat(o.length,"个单位"):this.textVal="".concat(o.length," is selected"),this.$emit("onTreeCheck",o)}else if(i.deviceid){var l=i.deviceid,d=c["a"].deviceInfos[l].devicename;this.textVal=d,this.$emit("input",l),this.show=!1}},zTreeOnClick:function(e,t,i){$("#"+i.tId+"_switch").click(),i.nodeType!=c["a"].NodeType_Device_Normal&&i.nodeType!=c["a"].NodeType_Device_Video||(this.ztreeIns.checkNode(i,!i.checked,!0),this.onTreeCheck(e,t,i))},castUsersTreeToDevicesTree:function(e){var t=this,i={name:"空",children:[],open:!0,icon:u,nodeType:c["a"].NodeType_User,nocheck:!this.isCheck};if(e){var a=e.username,n=e.subusers;i.name=a,i.username=a,i.id=a;var s=Object(l["n"])(e.groups),r=Object(l["D"])(s,e.groups,n),o=null;null!=s&&(o=e.groups[s]);var d=this.getDeviceListGroups(e.groups,a,r);if(null!=a&&null!=n&&n.length>0){var h=this.doCastUsersTreeToDevicesTree(n);i.children=d.concat(h)}else i.children=d;i.children.forEach((function(e){e.nocheck=!t.isCheck})),Object(l["Fb"])(i.children);var p=0,m=0;if(0==r&&o&&o.devices.length){var f=this.$dateformat.getCurrentUTC(),v=c["a"].lastPositions;o.devices.forEach((function(e){if(e){p++;var t=Object(l["E"])(v[e.deviceid],f);t&&m++;var a=Object(l["s"])(e,t,f);i.children.push(a)}})),Object(l["Eb"])(i.children)}if(i.children)for(var g=0;g<i.children.length;++g){var y=i.children[g];void 0!=y.totalCount&&(p+=y.totalCount,m+=y.onlineCount)}i.totalCount=p,i.name+="("+m+"/"+p+")"}return i},doCastUsersTreeToDevicesTree:function(e){var t=this,i=[];if(null!=e&&e.length>0)for(var a,n,s,r,o,d,h,p,m,f,v,g,y,b=function(){if(a=e[k],n=a.username,s=a.subusers,r=a.showname,o=0,d={name:r||n,username:n,showname:r,icon:u,nodeType:c["a"].NodeType_User},h=Object(l["n"])(a.groups),p=Object(l["D"])(h,i.groups,s),m=null,null!=h&&(m=a.groups[h]),f=t.getDeviceListGroups(a.groups,n,p),f.forEach((function(e){o+=e.onlineCount})),null!=n&&null!=s&&s.length>0?(v=t.doCastUsersTreeToDevicesTree(s),v.forEach((function(e){o+=e.onlineCount})),v=f.concat(v),d.children=v):d.children=f,Object(l["Fb"])(d.children),d.children.forEach((function(e){e.nocheck=!t.isCheck})),0==p&&m&&m.devices.length){var b=t.$dateformat.getCurrentUTC(),D=c["a"].lastPositions;m.devices.forEach((function(e){if(e){var t=Object(l["E"])(D[e.deviceid],b);t&&o++;var i=Object(l["s"])(e,t,b);d.children.push(i)}})),Object(l["Eb"])(d.children)}if(g=0,d.children)for(y=0;y<d.children.length;++y){var w=d.children[y];void 0!=w.totalCount?g+=w.totalCount:g++}d.totalCount=g,d.onlineCount=o,d.name+="("+o+"/"+g+")",i.push(d)},k=0;k<e.length;++k)b();return i},getDeviceListGroups:function(e,t,i){var a=[],n=c["a"].lastPositions,s=this.$t("common.defaultGroup");if(e)for(var r=this.$dateformat.getCurrentUTC(),o=0;o<e.length;++o){var d=e[o],h=(void 0===d.shared||d.shared,d.groupid>0);if(i||h){var u=h?d.groupname:s,m=__pinyin.get(u),f=m.l,v=m.p,g={groupid:d.groupid,name:u,label:u,groupname:u,icon:p,username:t,nodeType:c["a"].NodeType_Group,l:f,p:v,status:""},y=0;if(d.devices&&(g.totalCount=d.devices.length,g.children=[],d.devices.forEach((function(e){if(e){var t=Object(l["E"])(n[e.deviceid],r);t&&y++;var i=Object(l["s"])(e,t,r);g.children.push(i)}})),Object(l["Eb"])(g.children)),g.onlineCount=y,g.name+="("+y+"/"+d.devices.length+")",g.label+="(".concat(g.children.length,")"),h){if(this.disableShare&&1==d.shared)continue;a.push(g)}else g.children.length&&a.push(g)}}return a}}},f=m,v=(i("eca4"),i("2877")),g=Object(v["a"])(f,a,n,!1,null,"98b76e1e",null),y=g.exports;t["a"]=y},"4c3c":function(e,t,i){"use strict";i("4e82");t["a"]={data:function(){return{sortConfig:{sortMethod:function(e){var t=e.data,i=e.sortList,a=i[0],n=a.property,s=a.order,r=[];return r="desc"===s?t.sort((function(e,t){var i=e[n],a=t[n];if(isNaN(i)&&!isNaN(Date.parse(i))&&isNaN(a)&&!isNaN(Date.parse(a)))return Date.parse(a)-Date.parse(i);if(i=parseFloat(i),a=parseFloat(a),isNaN(i)||isNaN(a)){var s=t[n]+"";return s.localeCompare(e[n])}return a-i})):"asc"===s?t.sort((function(e,t){var i=e[n],a=t[n];if(isNaN(i)&&!isNaN(Date.parse(i))&&isNaN(a)&&!isNaN(Date.parse(a)))return Date.parse(i)-Date.parse(a);if(i=parseFloat(e[n]),a=parseFloat(t[n]),isNaN(i)||isNaN(a)){var s=e[n]+"";return s.localeCompare(t[n])}return i-a})):t.sort(),r}}}}}},"57c9":function(e,t,i){"use strict";var a=i("0595");t["a"]=a["a"]},a749:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"report-form full"},[t("div",{staticClass:"report-form-inner"},[t("div",{staticClass:"report-form-inner-header",staticStyle:{height:"35px"}},[t("div",{staticClass:"f_left"},[t("SingleChoiceVehicle",{attrs:{placeholder:this.$t("tips.selectSingleDevice"),width:"230px"},model:{value:e.deviceid,callback:function(t){e.deviceid=t},expression:"deviceid"}})],1),t("div",{staticClass:"f_left"},[t("SelectDate",{model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),t("div",{staticClass:"f_left"},[t("QuickTimeRange",{model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),t("div",{staticClass:"f_left"},[t("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.handleQuery}},[e._v(e._s(e.$t("common.query")))])],1),t("div",{staticClass:"f_left"},[t("el-button",{attrs:{type:"primary",loading:e.exportLoading1},on:{click:e.exportData}},[e._v(e._s(e.$t("common.export")))])],1)]),t("div",{staticClass:"report-form-inner-content",staticStyle:{top:"39px"}},[t("vxe-table",{attrs:{"sort-config":e.sortConfig,"menu-config":e.tableMenu,border:"",resizable:"","auto-resize":"","show-overflow":"","highlight-hover-row":"",size:"mini",height:"auto",data:e.totalList},on:{"menu-click":e.handleClickTableMenu}},[t("vxe-table-column",{attrs:{type:"seq",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{field:"devicename",width:"140",title:e.$t("alarm.devName"),sortable:""}}),t("vxe-table-column",{attrs:{field:"deviceid",width:"140",title:e.$t("alarm.devNum"),sortable:""}}),t("vxe-table-column",{attrs:{field:"creater",title:e.$t("reportForm.creater"),width:"100",sortable:""},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-popover",{attrs:{placement:"bottom",trigger:"click"}},[t("div",{staticClass:"parents-wrapper"},e._l(e.parentsList,(function(i){return t("div",{key:i.username},[e._v(e._s(i.username)+"("+e._s(i.usertypeStr)+")")])})),0),t("el-button",{staticStyle:{color:"#000000"},attrs:{slot:"reference",type:"text"},on:{click:function(t){return e.queryParents(i.row.creater)}},slot:"reference"},[e._v(e._s(i.row.creater))])],1)]}}])}),t("vxe-table-column",{attrs:{field:"groupname",title:e.$t("reportForm.groupName"),width:"100",sortable:""}}),t("vxe-table-column",{attrs:{field:"fileext",title:e.$t("reportForm.fileType"),sortable:""}}),t("vxe-table-column",{attrs:{field:"channelid",title:e.$t("reportForm.channel"),width:"80",sortable:""}}),t("vxe-table-column",{attrs:{field:"eventcodeStr",title:e.$t("alarm.alarmType"),sortable:""}}),t("vxe-table-column",{attrs:{field:"endtimeStr",title:e.$t("reportForm.time"),sortable:""}}),t("vxe-table-column",{attrs:{field:"address",title:e.$t("reportForm.address"),sortable:""}}),t("vxe-table-column",{attrs:{field:"usertype",title:e.$t("reportForm.action"),width:"150",sortable:""},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleSeeMap(i)}}},[e._v(e._s(e.$t("reportForm.seeMap")))]),t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleSeeImages(i)}}},[e._v(e._s(e.$t("reportForm.seeImg")))])]}}])})],1)],1)]),t("el-dialog",{attrs:{title:e.$t("reportForm.seeMap"),visible:e.mapDialog,width:"560px","append-to-body":"","close-on-click-modal":!1},on:{close:function(t){e.mapDialog=!1}}},[t("div",{staticStyle:{width:"100%",height:"400px"}},[t("ReportMap",{ref:"mapIns"})],1)]),t("PhotographDialog",{attrs:{imageUrl:e.imageUrl,deviceName:e.deviceName},model:{value:e.photographDialog,callback:function(t){e.photographDialog=t},expression:"photographDialog"}})],1)},n=[],s=i("5530"),r=(i("99af"),i("14d9"),i("4e82"),i("d3b7"),i("159b"),i("4795"),i("2f62")),o=i("d03a"),c=i("d462"),l=i("57c9"),d=i("5101"),h=i("6e52"),u=i("32eb"),p=i("1c31"),m=i("ec6a"),f=i("c276"),v=i("4c3c"),g=i("a05b"),y=i("0c87"),b={name:"multiMedia",data:function(){return{loading:!1,mapDialog:!1,exportLoading1:!1,deviceid:"",photographDialog:!1,dateRange:[new Date,new Date],totalList:[],imageUrl:"",deviceName:""}},mixins:[v["a"],g["a"],y["a"]],components:{SingleChoiceVehicle:o["a"],SelectDate:c["a"],QuickTimeRange:l["a"],ReportMap:u["a"],PhotographDialog:m["a"]},computed:Object(s["a"])({},Object(r["b"])(["isZh","singleDeviceid"])),watch:{dateRange:function(){this.loading||this.handleQuery()},deviceid:function(e){this.setSingleDeviceid(e)}},methods:Object(s["a"])(Object(s["a"])({},Object(r["c"])(["setSingleDeviceid"])),{},{handleSeeMap:function(e){var t=this,i=e.row;this.mapDialog=!0,setTimeout((function(){t.$refs.mapIns.singleMarkerToMap(i)}),300)},handleSeeImages:function(e){var t=e.row;this.deviceName=t.devicename,this.imageUrl=t.url,this.photographDialog=!0},onSelectDevice:function(e){this.deviceids=e},exportData:function(){if(0!=this.totalList.length){var e=[[this.$t("reportForm.index"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("reportForm.creater"),this.$t("reportForm.groupName"),this.$t("reportForm.fileType"),this.$t("reportForm.channel"),this.$t("alarm.alarmType"),this.$t("reportForm.time"),this.$t("reportForm.address"),this.$t("monitor.coordinate")]],t="",i="";this.totalList.forEach((function(a,n){var s=[];t=a.devicename,i=a.deviceid,s.push(a.index),s.push(a.devicename),s.push(a.deviceid),s.push(a.creater),s.push(a.groupname),s.push(a.fileext),s.push(a.channelid),s.push(a.eventcodeStr),s.push(a.endtimeStr),s.push(a.address),s.push(a.callon+","+a.callat),e.push(s)}));var a={title:this.$t("reportForm.multiMedia")+" ".concat(t,"-").concat(i),data:e,dateRange:this.queryDateRange};this.exportLoading1=!0,new ExcelCls(a).exportExcel(this)}},handleQuery:function(){var e=this,t=this.deviceid;if(""!=t){var i=this.dateRange;if(0==i.length)return void this.$XModal.message({message:this.$t("tips.selectTime"),status:"error",zIndex:9999});this.loading=!0;var a=d["a"].format(i[0],"yyyy-MM-dd"),n=d["a"].format(i[1],"yyyy-MM-dd"),s={startday:a,endday:n,offset:d["a"].getOffset(),deviceids:[t]};Object(p["U"])(s).then((function(t){var i=t.status,s=t.records,r=t.addressmap;e.queryDateRange=a+" "+n;var o=[];if(0==i){var c=0;s.forEach((function(t,i){var a=t.deviceid,n=h["a"].deviceInfos[a];t.records.forEach((function(t){t.index=++c,t.deviceid=a,t.address=Object(f["L"])(r||{},t.callat,t.callon),t.endtimeStr=d["a"].longToLocalDateTimeStr(t.endtime),t.eventcodeStr=e.getEventcodeStr(t),t.devicename=n.devicename,t.creater=h["a"].getShowName(n.creater),t.groupname=n.groupname,o.push(t)}))})),o.sort((function(e,t){return t.endtime-e.endtime})),e.totalList=o}else e.totalList=[];e.loading=!1})).catch((function(t){console.log(t),e.loading=!1}))}else this.$XModal.message({message:this.$t("tips.selectDevice"),status:"error",zIndex:9999})},getEventcodeStr:function(e){var t=e.eventcode,i="";switch(t){case 0:i=this.$t("alarm.terraceIssued");break;case 1:i=this.$t("alarm.timingAction");break;case 2:i=this.$t("alarm.robberyReport");break;case 3:i=this.$t("alarm.impactRollover");break;default:i=this.$t("alarm.retain")}return i}}),mounted:function(){this.deviceids=[],this.singleDeviceid&&(console.log(this.singleDeviceid),this.deviceid=this.singleDeviceid)}},k=b,D=(i("fdb1"),i("2877")),w=Object(D["a"])(k,a,n,!1,null,null,null),C=w.exports;t["default"]=C},ae51:function(e,t,i){},b174:function(e,t,i){},c51d:function(e,t,i){"use strict";i("ecfc")},d03a:function(e,t,i){"use strict";var a=i("26c6");t["a"]=a["a"]},d462:function(e,t,i){"use strict";var a=i("2ddc");t["a"]=a["a"]},e716:function(e,t,i){"use strict";i("271ae")},ec11:function(e,t,i){},ec6a:function(e,t,i){"use strict";var a=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:e.dialogTitle,center:"",visible:e.value,width:"480px","append-to-body":"","close-on-click-modal":!1},on:{close:e.handleClose}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.show,expression:"show"}],staticStyle:{height:"290px"}},[e.show?e._e():t("img",{staticStyle:{width:"100%",height:"280px"},attrs:{src:e.imageUrl}})]),t("el-row",[t("el-col",{attrs:{span:6,offset:4}},[t("el-button",{staticStyle:{width:"100%"},attrs:{size:"mini",type:"primary"},on:{click:e.downloadImg}},[e._v(e._s(e.$t("videoback.download")))])],1),t("el-col",{attrs:{span:6,offset:4}},[t("el-button",{staticStyle:{width:"100%"},attrs:{size:"mini"},on:{click:e.handleClose}},[e._v(e._s(e.$t("device.close")))])],1)],1)],1)},n=[],s=(i("99af"),{name:"PhotographDialog",props:{value:{type:Boolean,default:!1},imageUrl:{type:String,default:""},deviceName:{type:String,default:""}},data:function(){return{show:!0}},watch:{value:function(e){var t=this;if(e){var i=new Image;i.onload=function(){t.show=!1},i.src=this.imageUrl}else this.show=!0}},computed:{dialogTitle:function(){return"".concat(this.$t("monitor.photograph")," - ").concat(this.deviceName)}},methods:{handleClose:function(){this.$emit("input",!1)},downloadImg:function(){this.imageUrl&&window.open(this.imageUrl)}}}),r=s,o=i("2877"),c=Object(o["a"])(r,a,n,!1,null,null,null);t["a"]=c.exports},eca4:function(e,t,i){"use strict";i("b174")},ecfc:function(e,t,i){},facb:function(e,t,i){"use strict";i("ec11")},fdb1:function(e,t,i){"use strict";i("ae51")}}]);