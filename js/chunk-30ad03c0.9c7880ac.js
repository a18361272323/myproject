(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-30ad03c0"],{"09d7":function(e,t,a){"use strict";a("a239")},"1d28":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"repair-record full"},[t("div",{staticClass:"repair-record-header"},[t("div",{staticClass:"f_left"},[t("MultiChoiceVehicle",{attrs:{disableShare:""},on:{onSelectDevice:e.onSelectDevice}})],1),t("div",{staticClass:"f_left"},[t("SelectDate",{model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),t("div",{staticClass:"f_left"},[t("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.handleQuery}},[e._v(e._s(e.$t("common.query")))])],1),t("div",{staticClass:"f_left"},[t("el-button",{attrs:{type:"success"},on:{click:e.handleClickAdd}},[e._v(e._s(e.$t("common.add")))])],1),t("div",{staticClass:"f_left"},[t("el-button",{attrs:{type:"primary",loading:e.exportLoading1},on:{click:e.exportData}},[e._v(e._s(e.$t("common.export")))])],1)]),t("div",{staticClass:"repair-record-content"},[t("vxe-table",{attrs:{"sort-config":e.sortConfig,border:"","auto-resize":"",resizable:"","show-overflow":"","highlight-hover-row":"",size:"mini",height:"auto",data:e.tableList},on:{"cell-dblclick":e.handleDbclick}},[t("vxe-table-column",{attrs:{type:"seq",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{field:"devicename",sortable:"",title:e.$t("alarm.devName"),width:"130"}}),t("vxe-table-column",{attrs:{field:"deviceid",sortable:"",title:e.$t("alarm.devNum"),width:"130"}}),t("vxe-table-column",{attrs:{field:"repairitem",title:e.$t("insure.repairItem"),width:"100"}}),t("vxe-table-column",{attrs:{field:"fee",title:e.$t("insure.repairFee"),width:"100"}}),t("vxe-table-column",{attrs:{field:"repairagent",title:e.$t("insure.repairShop"),width:"100"}}),t("vxe-table-column",{attrs:{field:"repairaddress",title:e.$t("insure.repairAddress"),width:"130"}}),t("vxe-table-column",{attrs:{field:"repairphone",title:e.$t("insure.repairShopPhone"),width:"130"}}),t("vxe-table-column",{attrs:{field:"repairname",title:e.$t("insure.repairShopName"),width:"140"}}),t("vxe-table-column",{attrs:{field:"createtimeStr",title:e.$t("insure.deliveryTime"),width:"145"}}),t("vxe-table-column",{attrs:{field:"submitrepairname",title:e.$t("insure.submitRepairName"),width:"100"}}),t("vxe-table-column",{attrs:{field:"submitrepairphone",title:e.$t("insure.submitRepairPhone"),width:"100"}}),t("vxe-table-column",{attrs:{field:"remark",title:e.$t("reportForm.remarks"),width:"130"}}),t("vxe-table-column",{attrs:{title:e.$t("reportForm.action"),width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticStyle:{"padding-top":"7px"}},[t("span",{staticStyle:{padding:"0px 10px 0px 0px"}},[t("img",{staticStyle:{width:"20px",cursor:"pointer"},attrs:{src:e.editIcon},on:{click:function(t){return e.handleEdit(a)}}})]),t("el-popconfirm",{attrs:{placement:"top",icon:"el-icon-info","confirm-button-text":e.$t("common.confirm"),"cancel-button-text":e.$t("common.cancel"),"icon-color":"red",title:e.$t("tips.confirmDelete")},on:{confirm:function(t){return e.handleDelete(a)}}},[t("span",{attrs:{slot:"reference"},slot:"reference"},[t("img",{staticStyle:{width:"20px",cursor:"pointer"},attrs:{src:e.deleteIcon}})])])],1)]}}])})],1)],1),t("el-dialog",{attrs:{title:e.title,visible:e.addDialog,center:"",width:"420px","append-to-body":"","close-on-click-modal":!1},on:{close:function(t){e.addDialog=!1}}},[t("div",[t("el-row",{staticClass:"margin_b10"},[e.isAdd?t("el-col",{attrs:{span:24}},[t("SingleChoiceVehicle",{attrs:{placeholder:this.$t("tips.selectSingleDevice"),width:"180px",showLabel:""},model:{value:e.deviceid,callback:function(t){e.deviceid=t},expression:"deviceid"}})],1):t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("alarm.devName")}},[t("div",{staticStyle:{height:"34px","line-height":"34px","padding-left":"18px"}},[e._v(e._s(e.devicename))])])],1)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("insure.repairItem")}},[t("el-input",{model:{value:e.repairitem,callback:function(t){e.repairitem=t},expression:"repairitem"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("insure.repairFee")}},[t("el-input",{model:{value:e.fee,callback:function(t){e.fee=e._n(t)},expression:"fee"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("insure.repairShop")}},[t("el-input",{model:{value:e.repairagent,callback:function(t){e.repairagent=t},expression:"repairagent"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("insure.repairAddress")}},[t("el-input",{model:{value:e.repairaddress,callback:function(t){e.repairaddress=t},expression:"repairaddress"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("insure.repairShopPhone")}},[t("el-input",{model:{value:e.repairphone,callback:function(t){e.repairphone=e._n(t)},expression:"repairphone"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("insure.repairShopName")}},[t("el-input",{model:{value:e.repairname,callback:function(t){e.repairname=t},expression:"repairname"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("insure.submitRepairName")}},[t("el-input",{model:{value:e.submitrepairname,callback:function(t){e.submitrepairname=t},expression:"submitrepairname"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("insure.submitRepairPhone")}},[t("el-input",{model:{value:e.submitrepairphone,callback:function(t){e.submitrepairphone=e._n(t)},expression:"submitrepairphone"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("reportForm.remarks")}},[t("el-input",{model:{value:e.remark,callback:function(t){e.remark=t},expression:"remark"}})],1)],1)],1),t("el-row",[e.isAdd?t("el-col",{attrs:{span:8,offset:8}},[t("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.addRepairRecord}},[e._v(e._s(e.$t("common.determine")))])],1):t("el-col",{attrs:{span:8,offset:8}},[t("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.editRepairRecord}},[e._v(e._s(e.$t("common.determine")))])],1)],1)],1)])],1)},r=[],n=(a("14d9"),a("d3b7"),a("159b"),a("e285")),s=a("201d"),o=a("26c6"),c=a("ea22"),l=a("2ddc"),d=a("5101"),p=a("6e52"),m=a("4c3c"),u=a("61fc"),h=a("e173"),f={name:"RepairRecord",data:function(){return{editIcon:u,deleteIcon:h,isAdd:!1,addDialog:!1,exportLoading1:!1,loading:!1,dateRange:[new Date,new Date],tableList:[],devicename:"",deviceid:"",repairitem:"",fee:"",repairagent:"",repairaddress:"",repairphone:"",repairname:"",submitrepairname:"",submitrepairphone:"",remark:""}},mixins:[m["a"]],components:{SelectDate:l["a"],MultiChoiceVehicle:c["a"],SingleChoiceVehicle:o["a"],LabelWrap:s["a"]},computed:{title:function(){return this.isAdd?this.$t("insure.addRepairInfo"):this.$t("insure.editRepairInfo")}},methods:{handleDbclick:function(e){this.handleEdit(e)},onSelectDevice:function(e){this.deviceids=e},handleQuery:function(){var e=this,t=this.deviceids;if(t.length>0){var a=d["a"].format(this.dateRange[0],"yyyy-MM-dd"),i=d["a"].format(this.dateRange[1],"yyyy-MM-dd"),r={deviceids:t,offset:d["a"].getOffset(),startday:a,endday:i};this.loading=!0,Object(n["Ib"])(r).then((function(t){var a=t.records;e.loading=!1;var i=[];a&&a.forEach((function(e){var t=e.deviceid,a=e.records,r=p["a"].getDeviceNameByDeviceId(t);a.forEach((function(e){e.devicename=r,e.deviceid=t,e.createtimeStr=d["a"].longToLocalDateTimeStr(e.createtime),i.push(e)}))})),e.tableList=i}))}else this.$XModal.message({message:this.$t("tips.selectDevice"),status:"error",zIndex:9999})},handleEdit:function(e){var t=e.row;this.isAdd=!1,this.addDialog=!0,this.row=t,this.devicename=p["a"].deviceInfos[t.deviceid].devicename,this.deviceid=t.deviceid,this.repairitem=t.repairitem,this.fee=t.fee,this.repairagent=t.repairagent,this.repairaddress=t.repairaddress,this.repairphone=t.repairphone,this.repairname=t.repairname,this.submitrepairname=t.submitrepairname,this.submitrepairphone=t.submitrepairphone,this.remark=t.remark},exportData:function(){if(0!=this.tableList.length){var e=[[this.$t("reportForm.index"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("insure.repairItem"),this.$t("insure.repairFee"),this.$t("insure.repairShop"),this.$t("insure.repairAddress"),this.$t("insure.repairShopPhone"),this.$t("insure.repairShopName"),this.$t("insure.deliveryTime"),this.$t("insure.submitRepairName"),this.$t("insure.submitRepairPhone"),this.$t("reportForm.remarks")]];this.tableList.forEach((function(t,a){var i=[];i.push(a+1),i.push(t.devicename),i.push(t.deviceid),i.push(t.repairitem),i.push(t.fee),i.push(t.repairagent),i.push(t.repairaddress),i.push(t.repairphone),i.push(t.repairname),i.push(t.createtimeStr),i.push(t.submitrepairname),i.push(t.submitrepairphone),i.push(t.remark),e.push(i)}));var t={title:this.$t("bgManage.repairRecord"),data:e};this.exportLoading1=!0,new ExcelCls(t).exportExcel(this)}},handleDelete:function(e){var t=this,a=e.rowIndex,i=e.row;Object(n["F"])({repairrecordid:i.repairrecordid}).then((function(e){0==e.status?(t.$delete(t.tableList,a),t.$XModal.message({message:t.$t("tips.deleteSucc"),status:"error",zIndex:9999})):t.$XModal.message({message:t.$t("tips.deleteFail"),status:"error",zIndex:9999})}))},handleClickAdd:function(){this.isAdd=!0,this.addDialog=!0,this.row=null,this.deviceid="",this.repairitem="",this.fee="",this.repairagent="",this.repairaddress="",this.repairphone="",this.repairname="",this.submitrepairname="",this.submitrepairphone="",this.remark=""},addRepairRecord:function(){var e=this,t=this.deviceid;if(""!=t){var a={deviceid:t,repairitem:this.repairitem,fee:this.fee,repairagent:this.repairagent,repairaddress:this.repairaddress,repairphone:this.repairphone,repairname:this.repairname,submitrepairname:this.submitrepairname,submitrepairphone:this.submitrepairphone,remark:this.remark};Object(n["g"])(a).then((function(i){var r=i.status;0==r?(e.addDialog=!1,a.devicename=p["a"].getDeviceNameByDeviceId(t),a.createtimeStr=d["a"].longToLocalDateTimeStr(Date.now()),e.tableList.push(a),e.$XModal.message({message:e.$t("tips.addSucc"),status:"success",zIndex:9999})):e.$XModal.message({message:e.$t("tips.addFail"),status:"error",zIndex:9999})}))}else this.$XModal.message({message:this.$t("tips.selectDevice"),status:"error",zIndex:9999})},editRepairRecord:function(){var e=this,t=this.row,a={deviceid:this.deviceid,repairitem:this.repairitem,fee:this.fee,repairagent:this.repairagent,repairaddress:this.repairaddress,repairphone:this.repairphone,repairname:this.repairname,submitrepairname:this.submitrepairname,submitrepairphone:this.submitrepairphone,remark:this.remark,repairrecordid:t.repairrecordid};Object(n["S"])(a).then((function(i){var r=i.status;0==r?(e.addDialog=!1,t.repairitem=a.repairitem,t.fee=a.fee,t.repairagent=a.repairagent,t.repairaddress=a.repairaddress,t.repairphone=a.repairphone,t.repairname=a.repairname,t.submitrepairname=a.submitrepairname,t.submitrepairphone=a.submitrepairphone,t.remark=a.remark,e.$XModal.message({message:e.$t("tips.editSucc"),status:"success",zIndex:9999})):e.$XModal.message({message:e.$t("tips.editFail"),status:"error",zIndex:9999})}))}},mounted:function(){this.deviceids=[]}},v=f,g=(a("09d7"),a("2877")),b=Object(g["a"])(v,i,r,!1,null,null,null),y=b.exports;t["default"]=y},"26c6":function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"multi-choice single-choice-vehicle",style:{width:e.width}},[e.showLabel?t("div",{staticClass:"multi-choice-label"},[e._v(" "+e._s(e.$t("common.selectDevice"))+" ")]):e._e(),t("div",{staticClass:"multi-choice-input"},[t("ZtreeDeviceDropdown",{attrs:{placeholder:e.placeholder,disableShare:e.disableShare,isQueryInitData:e.isQueryInitData},model:{value:e.deviceid,callback:function(t){e.deviceid=t},expression:"deviceid"}})],1)])},r=[],n=a("5530"),s=a("2f62"),o=a("2df7"),c={props:{value:{type:String,default:""},width:{type:String,default:"230px"},showLabel:{type:Boolean,default:!1},disableShare:{type:Boolean,default:!1},placeholder:{type:String,default:""}},name:"SingleChoiceVehicle",data:function(){return{deviceid:""}},watch:{value:function(e){e&&(this.deviceid=e)},deviceid:function(e){this.$emit("input",e)}},computed:Object(n["a"])({},Object(s["b"])(["isQueryInitData"])),components:{ZtreeDeviceDropdown:o["a"]},methods:{},mounted:function(){this.value&&(this.deviceid=this.value)}},l=c,d=(a("facb"),a("2877")),p=Object(d["a"])(l,i,r,!1,null,null,null);t["a"]=p.exports},"271ae":function(e,t,a){},"2ddc":function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"multi-choice",style:e.warpStyle},[t("div",{staticClass:"multi-choice-input"},["daterange"==e.dateType?t("div",[t("el-date-picker",{attrs:{type:e.dateType,"picker-options":e.pickerOptions,"range-separator":"-",align:"center","unlink-panels":"",clearable:!1,"start-placeholder":e.$t("device.driverinitialdate"),"end-placeholder":e.$t("device.drivereffectivedate")},on:{change:e.onChange},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1):e._e(),"date"==e.dateType?t("div",[t("el-date-picker",{attrs:{type:"date","picker-options":e.datePickerOptions},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1):e._e(),"datetimerange"==e.dateType?t("div",{staticClass:"datetimerange"},[t("el-date-picker",{attrs:{type:e.dateType,"range-separator":"-","picker-options":e.pickerOptionsTime,align:"center","unlink-panels":"",clearable:!1,"start-placeholder":e.$t("device.driverinitialdate"),"end-placeholder":e.$t("device.drivereffectivedate"),"default-time":["00:00:00","23:59:59"]},on:{change:e.onChange},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1):e._e(),"month"==e.dateType?t("div",[t("el-date-picker",{attrs:{type:"month"},model:{value:e.month,callback:function(t){e.month=t},expression:"month"}})],1):e._e()])])},r=[],n=(a("99af"),a("5101")),s=a("5867"),o={name:"SelectDate",props:{value:{type:Array|Date,default:function(){return[]}},dateType:{type:String,default:"daterange"},label:{type:String,default:function(){return this.$t("common.selectTime")}}},computed:{isDaterange:function(){return"daterange"==this.dateType},warpStyle:function(){var e=200;switch(this.dateType){case"date":e=120;break;case"daterange":e=230;break;case"datetimerange":e=310;break}return{width:"".concat(e,"px")}}},mixins:[s["a"]],data:function(){var e=864e5;return{dateRange:[],date:new Date,month:new Date,pickerOptions:{shortcuts:[{text:this.$t("reportForm.toDay"),onClick:function(e){var t=new Date;e.$emit("pick",[t,t])}},{text:this.$t("reportForm.yesterDay"),onClick:function(t){var a=new Date;a.setTime(a.getTime()-e),t.$emit("pick",[a,a])}},{text:this.$t("missing.theWeek"),onClick:function(t){var a=new Date,i=new Date,r=a.getDay();a.setTime(a.getTime()-e*(r-1)),i.setTime(a.getTime()+6*e),t.$emit("pick",[a,i])}},{text:this.$t("missing.lastWeek"),onClick:function(t){var a=new Date,i=new Date,r=a.getDay(),n=a.getTime()-e*(r-1);a.setTime(n-7*e),i.setTime(n-e),t.$emit("pick",[a,i])}},{text:this.$t("missing.thisMonth"),onClick:function(e){var t=new Date,a=t.getFullYear(),i=t.getMonth()+1,r=new Date("".concat(a,"-").concat(i,"-01")),n=new Date("".concat(a,"-").concat(i,"-01 00:00:00"));n.setMonth(n.getMonth()+1),n=new Date(n.getTime()-1e3),e.$emit("pick",[r,n])}},{text:this.$t("missing.lastMonth"),onClick:function(e){var t=new Date;t.setMonth(t.getMonth()-1);var a=t.getFullYear(),i=t.getMonth()+1,r=new Date(new Date(a,i,1)-1).getDate(),n=new Date("".concat(a,"-").concat(i,"-01")),s=new Date("".concat(a,"-").concat(i,"-").concat(r));e.$emit("pick",[n,s])}}]},pickerOptionsTime:{shortcuts:[{text:this.$t("reportForm.toDay"),onClick:function(e){var t=new Date(n["a"].format(new Date,"yyyy-MM-dd")+" 00:00:00"),a=new Date(n["a"].format(new Date,"yyyy-MM-dd")+" 23:59:59");e.$emit("pick",[t,a])}},{text:this.$t("reportForm.yesterDay"),onClick:function(t){var a=new Date;a.setTime(a.getTime()-e),t.$emit("pick",[new Date(n["a"].format(a,"yyyy-MM-dd")+" 00:00:00"),new Date(n["a"].format(a,"yyyy-MM-dd")+" 23:59:59")])}},{text:this.$t("missing.theWeek"),onClick:function(t){var a=new Date,i=new Date,r=a.getDay();a.setTime(a.getTime()-e*(r-1)),i.setTime(a.getTime()+6*e),t.$emit("pick",[new Date(n["a"].format(a,"yyyy-MM-dd")+" 00:00:00"),new Date(n["a"].format(i,"yyyy-MM-dd")+" 23:59:59")])}},{text:this.$t("missing.lastWeek"),onClick:function(t){var a=new Date,i=new Date,r=a.getDay(),s=a.getTime()-e*(r-1);a.setTime(s-7*e),i.setTime(s-e),t.$emit("pick",[new Date(n["a"].format(a,"yyyy-MM-dd")+" 00:00:00"),new Date(n["a"].format(i,"yyyy-MM-dd")+" 23:59:59")])}},{text:this.$t("missing.thisMonth"),onClick:function(e){var t=new Date,a=t.getFullYear(),i=t.getMonth()+1,r=new Date("".concat(a,"-").concat(i,"-01")),s=new Date("".concat(a,"-").concat(i,"-01 00:00:00"));s.setMonth(s.getMonth()+1),s=new Date(s.getTime()-1e3),e.$emit("pick",[new Date(n["a"].format(r,"yyyy-MM-dd")+" 00:00:00"),new Date(n["a"].format(s,"yyyy-MM-dd")+" 23:59:59")])}},{text:this.$t("missing.lastMonth"),onClick:function(e){var t=new Date;t.setMonth(t.getMonth()-1);var a=t.getFullYear(),i=t.getMonth()+1,r=new Date(new Date(a,i,1)-1).getDate(),s=new Date("".concat(a,"-").concat(i,"-01")),o=new Date("".concat(a,"-").concat(i,"-").concat(r));e.$emit("pick",[new Date(n["a"].format(s,"yyyy-MM-dd")+" 00:00:00"),new Date(n["a"].format(o,"yyyy-MM-dd")+" 23:59:59")])}}]}}},watch:{dateRange:function(e){null==e?this.$emit("input",[]):this.$emit("input",e)},value:function(e){this.dateRange=e},date:function(e){this.$emit("input",e)},month:function(e){this.$emit("input",e)}},methods:{onChange:function(e){this.$emit("input",e)}},mounted:function(){"date"==this.dateType?this.date=this.value:"month"==this.dateType?this.month=this.value:this.dateRange=this.value}},c=o,l=(a("e716"),a("2877")),d=Object(l["a"])(c,i,r,!1,null,"5dbb8594",null);t["a"]=d.exports},"4c3c":function(e,t,a){"use strict";a("4e82");t["a"]={data:function(){return{sortConfig:{sortMethod:function(e){var t=e.data,a=e.sortList,i=a[0],r=i.property,n=i.order,s=[];return s="desc"===n?t.sort((function(e,t){var a=e[r],i=t[r];if(isNaN(a)&&!isNaN(Date.parse(a))&&isNaN(i)&&!isNaN(Date.parse(i)))return Date.parse(i)-Date.parse(a);if(a=parseFloat(a),i=parseFloat(i),isNaN(a)||isNaN(i)){var n=t[r]+"";return n.localeCompare(e[r])}return i-a})):"asc"===n?t.sort((function(e,t){var a=e[r],i=t[r];if(isNaN(a)&&!isNaN(Date.parse(a))&&isNaN(i)&&!isNaN(Date.parse(i)))return Date.parse(a)-Date.parse(i);if(a=parseFloat(e[r]),i=parseFloat(t[r]),isNaN(a)||isNaN(i)){var n=e[r]+"";return n.localeCompare(t[r])}return a-i})):t.sort(),s}}}}}},a239:function(e,t,a){},e716:function(e,t,a){"use strict";a("271ae")},ec11:function(e,t,a){},facb:function(e,t,a){"use strict";a("ec11")}}]);