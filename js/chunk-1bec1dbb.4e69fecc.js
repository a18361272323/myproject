(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1bec1dbb"],{"0a71":function(e,t,a){},"1d35":function(e,t){e.exports="data:image/png;base64,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"},"23b8":function(e,t,a){"use strict";a("50ce")},3640:function(e,t,a){},"50ce":function(e,t,a){},"59d2":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"batch-manage full"},[t("div",{staticClass:"batch-manage-left"},[t("div",{staticClass:"batch-manage-inner full"},[t("div",{staticClass:"batch-manage-inner-title"},[t("i",{staticClass:"circle"}),t("b",{domProps:{textContent:e._s(e.$t("systemManage.serverList"))}}),t("span",{domProps:{textContent:e._s(e.$t("systemManage.editServer"))}})]),t("div",{staticClass:"batch-manage-inner-content"},[t("SerevrTree",{ref:"tree",on:{drawPolygons:e.drawPolygons,removeFence:e.removeFence}})],1)])]),t("div",{staticClass:"batch-manage-right noselect"},[t("div",{staticClass:"batch-manage-inner-title"},[t("i",{staticClass:"circle"}),t("b",{domProps:{textContent:e._s(e.$t("reportForm.seeMap"))}}),t("div",{staticClass:"batch-manage-btns"},[t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handleDraw}},[e._v(e._s(e.$t("systemManage.addRegion")))])],1)]),t("div",{staticClass:"batch-manage-inner-content"},[t("SerevrMap",{ref:"serevrMap",on:{drawend:e.onDrawend}})],1)]),t("el-dialog",{attrs:{title:e.$t("systemManage.selectServer"),center:"",visible:e.dialog,width:"320px","append-to-body":"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialog=t}}},[t("div",{staticClass:"margin_b10"},[t("LabelWrap",{attrs:{label:e.$t("systemManage.server")}},[t("el-select",{model:{value:e.mediaserverid,callback:function(t){e.mediaserverid=t},expression:"mediaserverid"}},e._l(e.serverOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-row",[t("el-col",{attrs:{span:8,offset:8}},[t("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.handleEdit}},[e._v(e._s(e.$t("common.add")))])],1)],1)],1)],1)},s=[],n=a("5530"),r=(a("14d9"),a("b0c0"),a("e9c4"),a("a9e3"),a("b680"),a("b64b"),a("d3b7"),a("159b"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"serevr-map full"},[t("div",{staticClass:"full",attrs:{id:e.mapId}}),t("SwitchMapType",{attrs:{mapType:e.myMapType},on:{"select-map":e.onSelectMap,"switch-traffic":e.onSwitchTraffic}}),t("SearchAddress")],1)}),o=[],l=(a("d9e2"),a("99af"),a("ac1f"),a("5319"),a("2f62")),c=a("44ca"),d=a("a167"),p=a("532f"),m=a("b4aa"),u=a("c276"),h={name:"SerevrMap",data:function(){return{myMapType:""}},mounted:function(){var e=this;if(void 0==window.maptalks){var t=document.createElement("script");t.src="./maptalks/maptalks.min.js",t.onload=function(){var t=document.createElement("script");t.src="./maptalks/maptalks.markercluster.js",t.onload=function(){e.$nextTick(e.initMap)},document.head.appendChild(t);var a=document.createElement("script");a.src="./js/MyAreaTool.js",document.head.appendChild(a)},document.head.appendChild(t)}else e.$nextTick(e.initMap)},computed:Object(n["a"])(Object(n["a"])({},Object(l["b"])(["mapType"])),{},{mapId:function(){return"map".concat(this._uid)}}),components:{SwitchMapType:p["a"],SearchAddress:m["a"]},methods:{onSelectMap:function(e){this.convertLongitudeAndLatitude(e.mapType),this.setMapTypeLayer(e)},convertLongitudeAndLatitude:function(e){var t=this.myMapType,a="bMap"==t,i=!1;(a&&"bMap"!=e||0==a&&"bMap"==e)&&(i=!0);var s=this.fenceLayer;if(i&&s){var n="bMap"==e,r=s.getGeometries();r.forEach((function(e){var t=e.type;if("Polygon"==t){var a=e.getCoordinates();if(a instanceof Array)a.forEach((function(e){e.forEach((function(e){var t=[];t=n?Object(d["g"])(e.x,e.y):Object(d["c"])(e.x,e.y),e.x=t[0],e.y=t[1]}))})),e.setCoordinates(a);else{var i=[];i=n?Object(d["g"])(a.x,a.y):Object(d["c"])(a.x,a.y),a.x=i[0],a.y=i[1],e.setCoordinates(a)}}}))}},initMap:function(){var e=this;this.symbol={lineColor:"#e4393c",lineWidth:2,polygonFill:"rgb(135,196,240)",polygonOpacity:.4},this.geometry=null,this.lastMapType=this.mapType,this.googleTrafficLayer=null,this.baiduTrafficLayer=null,this.textlayer=null;var t=Object(u["L"])(this.currentDeviceId);this.mapIns=new maptalks.Map(this.mapId,{centerCross:!0,center:t,zoom:5,minZoom:4,maxZoom:18,scaleControl:!0,dragRotate:!1,dragPitch:!1,zoomAnimation:!1,panAnimation:!1,enableInfoWindow:!0}),this.setMapTypeLayer({mapType:this.mapType,traffic:!1,xiansu:!1,satelliteMap:!1}),this.fenceLayer=new maptalks.VectorLayer("fenceLayer").addTo(this.mapIns),this.fenceLayer.setZIndex(1),this.markLayer=new maptalks.VectorLayer("markLayer").addTo(this.mapIns),this.markLayer.setZIndex(2),this.addressLayer=new maptalks.VectorLayer("addressLayer").addTo(this.mapIns),this.addressLayer.setZIndex(3),this.mapIns.on("mousemove",(function(t){var a=t.coordinate;e.mouseLabel&&e.mouseLabel.setCoordinates(a)})),this.drawTool=new maptalks.DrawTool({mode:"Point",symbol:{lineColor:"#e4393c",lineWidth:2,polygonFill:"rgb(135,196,240)",polygonOpacity:.7}}).addTo(this.mapIns).disable(),this.drawTool.on("drawstart",(function(t){e.initMouseLabel(),e.mouseLabel&&e.mouseLabel.setContent(e.$t("monitor.doubleClickMouseEnd"))})),this.drawTool.on("drawend",(function(t){var a=t.geometry;e.drawTool.disable(),e.removeMouseLabel(),e.markLayer.addGeometry(a),e.geometry=a,e.$emit("drawend",a)}))},startDraw:function(){this.$XModal.message({message:this.$t("systemManage.drawRegionTip"),status:"success"}),this.drawTool.setMode("Polygon").enable()},initMouseLabel:function(){this.mouseLabel=new maptalks.Label("",[0,0],{cursor:"pointer",textSymbol:{textFill:"#000000",textSize:12,textWeight:"normal",textDx:65,textDy:25},boxStyle:{padding:[5,4],verticalAlignment:"top",horizontalAlignment:"middle",symbol:{markerType:"square",markerFill:"#FFFFFF",markerLineColor:"#E4E7ED",markerLineWidth:1,markerFillOpacity:1,markerLineOpacity:1}}}).addTo(this.markLayer).setZIndex(9999)},removeMouseLabel:function(){this.mouseLabel&&this.mouseLabel.remove(),this.mouseLabel=null},onSwitchTraffic:function(e){var t="bMap"==this.mapType;e?t?this.baiduTrafficLayer.show():this.googleTrafficLayer.show():t?this.baiduTrafficLayer.hide():this.googleTrafficLayer.hide()},setMapTypeLayer:function(e){var t=this,a=this.lastMapType,i="bMap"==a,s=this.mapIns.getCenter();this.mapIns.removeLayer("baiduText"),this.mapIns.removeLayer("aliText");var n=e.mapType,r=e.satelliteMap,o=e.traffic;if("bMap"==n){t.mapIns.setSpatialReference({projection:"baidu"});var l=new maptalks.TileLayer("base",r?c["e"]:c["d"]);if(t.mapIns.setBaseLayer(l),r){var p=new maptalks.TileLayer("baiduText",c["f"]);t.mapIns.addLayer(p)}if(a!=n){t.mapIns.setMaxZoom(19);var m=Object(d["g"])(s.x,s.y);t.mapIns.setCenter({x:m[0],y:m[1]})}}else if("gMap"==n){l=new maptalks.TileLayer("base",r?c["m"]:c["l"]);if(t.mapIns.setSpatialReference({}),t.mapIns.setBaseLayer(l),t.mapIns.setMaxZoom(19),i){var u=Object(d["c"])(s.x,s.y);t.mapIns.setCenter({x:u[0],y:u[1]})}}else if("aMap"==n){l=new maptalks.TileLayer("base",r?c["b"]:c["a"]);if(t.mapIns.setSpatialReference({}),t.mapIns.setBaseLayer(l),r){p=new maptalks.TileLayer("aliText",c["c"]);t.mapIns.addLayer(p)}if(t.mapIns.setMaxZoom(18),i){var h=Object(d["c"])(s.x,s.y);t.mapIns.setCenter({x:h[0],y:h[1]})}}else if("gChinaMap"==n){if(this.isZh)var f=r?c["k"]:c["i"];else f=r?c["j"]:c["h"];l=new maptalks.TileLayer("base",f);if(t.mapIns.setSpatialReference({}),t.mapIns.setBaseLayer(l),t.mapIns.setMaxZoom(19),i){var v=Object(d["c"])(s.x,s.y);t.mapIns.setCenter({x:v[0],y:v[1]})}}t.addTrafficLayer(o),t.lastMapType=n,t.myMapType=n},addTrafficLayer:function(e){null==this.baiduTrafficLayer&&(this.baiduTrafficLayer=new maptalks.TileLayer("baidutraffic",{urlTemplate:function(e,t,a){var i="",s={x:e,y:t,z:a,domain:i,time:Date.now()},n=/\{ *([\w_]+) *\}/g;return c["g"].replace(n,(function(e,t){var a=s[t];if(void 0===a)throw new Error("No value provided for variable "+e);return"function"===typeof a&&(a=a(s)),a}))}}),this.mapIns.addLayer(this.baiduTrafficLayer),this.baiduTrafficLayer.hide()),null==this.googleTrafficLayer&&(this.googleTrafficLayer=new maptalks.TileLayer("googletraffic",{urlTemplate:function(e,t,a){t=Math.pow(2,a)-1-t;var i="",s={x:e,y:t,z:a,domain:i,time:Date.now()},n=/\{ *([\w_]+) *\}/g;return googleTrafficUrlTemplate.replace(n,(function(e,t){var a=s[t];if(void 0===a)throw new Error("No value provided for variable "+e);return"function"===typeof a&&(a=a(s)),a}))}}),this.mapIns.addLayer(this.googleTrafficLayer),this.googleTrafficLayer.hide()),this.onSwitchTraffic(e)},drawPolygons:function(e){var t=this,a=e.nodes,i=e.center,s=this.$parent,n=this.fenceLayer,r="bMap"==this.myMapType;n.clear();var o=[];null!=i&&i.points&&i.points.length&&(o=r?Object(d["k"])(i.points):Object(d["l"])(i.points)),a.forEach((function(e){var a=e.points,l=[];l=r?Object(d["k"])(a):Object(d["l"])(a);var c=new maptalks.Polygon(l,{symbol:t.symbol}).addTo(n);c.mediaserverid=e.serverid,null==i&&(o=o.concat(l));var p=t.getPolygonCenter(l);t.addFenceLabel(s.getMediaserverNameById(e.serverid),p)})),this.setViewPortCenter(o)},getPolygonCenter:function(e){var t=[];if(null!=e&&e.length>0){for(var a=0,i=0,s=0,n=e.length,r=1;r<=n;++r){var o=e[r%n],l=o.y,c=o.x,d=e[r-1],p=d.y,m=d.x,u=(l*m-c*p)/2;a+=u,s+=u*(l+p)/3,i+=u*(c+m)/3}i/=a,s/=a,t.push(i),t.push(s)}return t},addFenceLabel:function(e,t,a){this.fenceLabel=new maptalks.Label(e,t,{cursor:"pointer",textSymbol:{textFill:"#000000",textSize:12,textWeight:"normal",textDy:12},boxStyle:{padding:[5,4],verticalAlignment:"top",horizontalAlignment:"middle",symbol:{markerType:"square",markerFill:"#FFFFFF",markerLineColor:"#000000",markerLineWidth:2,markerFillOpacity:1,markerLineOpacity:1}}}).addTo(this.fenceLayer)},setViewPortCenter:function(e){var t=new maptalks.Polygon(e);this.mapIns.fitExtent(t.getExtent(),0),t=null}}},f=h,v=(a("e5a5"),a("2877")),y=Object(v["a"])(f,r,o,!1,null,null,null),b=y.exports,g=function(){var e=this,t=e._self._c;return t("div",{staticClass:"serevr-tree full"},[t("div",{staticClass:"serevr-tree-search"},[t("el-input",{on:{input:e.onInputQuery},model:{value:e.queryText,callback:function(t){e.queryText=t},expression:"queryText"}},[t("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),t("div",{staticClass:"serevr-tree-addserver",on:{click:e.handleOpenDialog}},[t("el-tooltip",{attrs:{effect:"dark",content:e.$t("systemManage.addServer"),placement:"top"}},[t("i",{staticClass:"el-icon-plus"})])],1),t("div",{staticClass:"serevr-tree-box"},[t("el-scrollbar",{staticStyle:{height:"100%"}},[t("ul",{staticClass:"ztree",attrs:{id:e.ztreeId}})])],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.isRemove,expression:"isRemove"}],staticClass:"serevr-tree-mask"},[t("div",{staticClass:"el-popover el-popper",staticStyle:{width:"180px",margin:"30px auto"}},[t("div",[t("p",{staticClass:"el-popconfirm__main"},[t("i",{staticClass:"el-popconfirm__icon el-icon-info",staticStyle:{color:"red"}}),e._v(" "+e._s(e.$t("tips.confirmDelete"))+" ")]),t("div",{staticClass:"el-row",staticStyle:{"margin-left":"-5px","margin-right":"-5px"}},[t("div",{staticClass:"el-col el-col-12",staticStyle:{"padding-left":"5px","padding-right":"5px"}},[t("button",{staticClass:"el-button el-button--default el-button--mini",attrs:{type:"button"},on:{click:e.cancelDeleteFence}},[t("span",[e._v(e._s(e.$t("common.cancel")))])])]),t("div",{staticClass:"el-col el-col-12",staticStyle:{"padding-left":"5px","padding-right":"5px"}},[t("button",{staticClass:"el-button el-button--primary el-button--mini",attrs:{type:"button"},on:{click:e.handleDeleteFence}},[t("span",[e._v(e._s(e.$t("common.determine")))])])])])])])]),t("AddSerevrDialog",{ref:"server",attrs:{isAdd:e.isAdd},on:{addMediaServer:e.addServer,editMediaServer:e.editServer},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}})],1)},A=[],x=(a("4de4"),a("c975"),a("4e82"),a("ada3")),k=a.n(x),w=a("f68d"),C=a.n(w),M=a("93b4"),L=a.n(M),T=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:e.dialogTitle,center:"",visible:e.value,width:"480px","append-to-body":"","close-on-click-modal":!1},on:{close:e.handleClose}},[e.isAdd?e._e():t("div",{staticClass:"margin_b10"},[t("LabelWrap",{attrs:{label:e.$t("reportForm.updatetimeStr")}},[t("div",{staticStyle:{"padding-left":"15px","line-height":"32px"},domProps:{textContent:e._s(e.updatetimeStr)}})])],1),t("div",{staticClass:"margin_b10"},[t("LabelWrap",{attrs:{label:e.$t("systemManage.name")}},[t("el-input",{model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1)],1),t("div",{staticClass:"margin_b10"},[t("LabelWrap",{attrs:{label:e.$t("systemManage.serverType")}},[t("div",{staticStyle:{padding:"6px 0px 0px 10px"}},[t("el-checkbox-group",{model:{value:e.servicetypeArr,callback:function(t){e.servicetypeArr=t},expression:"servicetypeArr"}},[t("el-checkbox",{attrs:{label:1}},[e._v(e._s(e.$t("systemManage.realtimePlay")))]),t("el-checkbox",{attrs:{label:2}},[e._v(e._s(e.$t("monitor.activeSafety")))]),t("el-checkbox",{attrs:{label:4}},[e._v("FTP")])],1)],1)])],1),t("div",{staticClass:"margin_b10"},[t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{span:8}},[t("LabelWrap",{attrs:{label:e.$t("systemManage.default")}},[t("div",{staticStyle:{padding:"6px 0px 0px 10px"}},[t("el-checkbox",{model:{value:e.asdefault,callback:function(t){e.asdefault=t},expression:"asdefault"}})],1)])],1),t("el-col",{attrs:{span:8}},[t("LabelWrap",{attrs:{label:e.$t("systemManage.enabled")}},[t("div",{staticStyle:{padding:"6px 0px 0px 10px"}},[t("el-checkbox",{model:{value:e.enabled,callback:function(t){e.enabled=t},expression:"enabled"}})],1)])],1),t("el-col",{attrs:{span:8}},[t("LabelWrap",{attrs:{label:e.$t("systemManage.china")}},[t("div",{staticStyle:{padding:"6px 0px 0px 10px"}},[t("el-checkbox",{model:{value:e.inchina,callback:function(t){e.inchina=t},expression:"inchina"}})],1)])],1)],1)],1),t("div",{staticClass:"margin_b10"},[t("LabelWrap",{attrs:{label:e.$t("systemManage.publicIp")}},[t("el-input",{model:{value:e.publicip,callback:function(t){e.publicip=t},expression:"publicip"}})],1)],1),t("div",{staticClass:"margin_b10"},[t("LabelWrap",{attrs:{label:e.$t("systemManage.playDomain")}},[t("el-input",{model:{value:e.playdomain,callback:function(t){e.playdomain=t},expression:"playdomain"}})],1)],1),t("div",{staticClass:"margin_b10"},[t("LabelWrap",{attrs:{label:e.$t("reportForm.remarks")}},[t("el-input",{model:{value:e.remark,callback:function(t){e.remark=t},expression:"remark"}})],1)],1),t("el-row",[t("el-col",{attrs:{span:8,offset:8}},[e.isAdd?t("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v(e._s(e.$t("common.submit")))]):t("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.handleEdit}},[e._v(e._s(e.$t("common.submit")))])],1)],1)],1)},O=[],I=(a("caad"),a("2532"),a("201d")),S=a("b562"),F=a("5101"),j={props:{value:{type:Boolean,default:!1},isAdd:{type:Boolean,default:!0}},data:function(){return{name:"",servicetype:0,servicetypeArr:[1,2,4],asdefault:!1,enabled:!1,inchina:!1,publicip:"",internatip:"",playdomain:"",remark:"",updatetimeStr:""}},computed:{dialogTitle:function(){return this.isAdd?this.$t("systemManage.addServer"):this.$t("systemManage.editServer")}},components:{LabelWrap:I["a"]},mounted:function(){this.regions=""},methods:{handleClose:function(){this.$emit("input",!1)},handleAdd:function(){var e=this,t={name:this.name,servicetype:this.getServicetype(),publicip:this.publicip,internatip:this.internatip,playdomain:this.playdomain,remark:this.remark,regions:"",asdefault:this.asdefault?1:0,enabled:this.enabled?1:0,inchina:this.inchina?1:0};Object(S["c"])(t).then((function(t){0==t.status?(e.$XModal.message({message:e.$t("tips.addSucc"),status:"success",zIndex:9999}),e.$emit("addMediaServer",t.mediaserver)):e.$XModal.message({message:t.cause,status:"error",zIndex:9999})}))},handleEdit:function(){var e=this,t={mediaserverid:this.mediaserverid,name:this.name,servicetype:this.getServicetype(),publicip:this.publicip,internatip:this.internatip,playdomain:this.playdomain,remark:this.remark,regions:this.regions,asdefault:this.asdefault?1:0,enabled:this.enabled?1:0,inchina:this.inchina?1:0};Object(S["y"])(t).then((function(t){0==t.status?(e.$XModal.message({message:e.$t("tips.editSucc"),status:"success",zIndex:9999}),e.$emit("editMediaServer",t.mediaserver)):e.$XModal.message({message:t.cause,status:"error",zIndex:9999})}))},getServicetype:function(){var e=0,t=this.servicetypeArr;return t.includes(1)&&(e|=1),t.includes(2)&&(e|=2),t.includes(4)&&(e|=4),e},setServicetype:function(e){var t=[];1==(1&e)&&t.push(1),2==(2&e)&&t.push(2),4==(4&e)&&t.push(4),this.servicetypeArr=t},setServerInfo:function(e){this.name=e?e.name:"",this.mediaserverid=e?e.mediaserverid:"",this.servicetype=e?e.servicetype:"",e?this.setServicetype(e.servicetype):this.servicetypeArr=[],this.publicip=e?e.publicip:"",this.internatip=e?e.internatip:"",this.playdomain=e?e.playdomain:"",this.remark=e?e.remark:"",this.regions=e?e.regions:"",this.asdefault=!!e&&1==e.asdefault,this.enabled=!!e&&1==e.enabled,this.inchina=!!e&&1==e.inchina,this.updatetimeStr=e?F["a"].longToLocalDateTimeStr(e.updatetime):""}}},E=j,B=Object(v["a"])(E,T,O,!1,null,null,null),z=B.exports,D={name:"SerevrTree",data:function(){return{queryText:"",isRemove:!1,dialog:!1,isAdd:!0}},created:function(){var e=this;this.setting={edit:{enable:!0,showRenameBtn:!1,removeTitle:this.$t("common.delete")},view:{dblClickExpand:!1,addDiyDom:this.addDiyDom},check:{enable:!0,chkStyle:"checkbox",chkboxType:{Y:"ps",N:"ps"}},callback:{onCheck:this.onTreeCheck,onClick:this.zTreeOnClick,onDblClick:this.zTreeOnDbClick,beforeRemove:function(t,a){return e.treeNode=a,e.isRemove=!0,!1}}}},components:{AddSerevrDialog:z},computed:Object(n["a"])(Object(n["a"])({},Object(l["b"])(["isQueryInitData"])),{},{ztreeId:function(){return"ztreeEl_".concat(this._uid)}}),mounted:function(){var e=this;this.mediaserversObjct={},this.ztreeIns=null,Object(S["W"])().then((function(t){var a=t.mediaservers;a&&a.forEach((function(t){e.mediaserversObjct[t.mediaserverid]=t})),e.$nextTick(e.initZtree)}))},methods:{onInputQuery:function(){var e=this.queryText;this.searchZtree(this,e)},searchZtree:Object(u["e"])((function(e,t){e.initZtree(t)}),1e3),initZtree:function(e){null!=this.ztreeIns&&this.ztreeIns.destroy();var t=this.getTreeNodes(e);this.ztreeIns=$.fn.zTree.init($("#".concat(this.ztreeId)),this.setting,t),this.ztreeIns.expandAll(!0)},getTreeNodes:function(e){var t=this,a=this.mediaserversObjct,i=[],s=function(s){var n=a[s],r={name:t.getServerName(n),sortname:n.name,mediaserverid:s,children:[],icon:1==n.enabled?k.a:C.a};if(n.regions){var o=JSON.parse(n.regions);o.forEach((function(e,t){r.children.push({index:t,serverid:s,name:"区域"+(t+1),points:e,icon:L.a})}))}(void 0==e||""==e||n.name&&-1!=n.name.indexOf(e))&&i.push(r)};for(var n in a)s(n);return i.sort((function(e,t){return e.sortname.localeCompare(t.sortname,"zh-CN")})),i},addDiyDom:function(e,t,a){},onTreeCheck:function(e,t,a){var i=this.ztreeIns.getCheckedNodes(),s=i.filter((function(e){return void 0==e.mediaserverid}));this.$emit("drawPolygons",{nodes:s,center:null})},zTreeOnClick:function(e,t,a){this.ztreeIns.checkNode(a,!0,!0);var i=a.mediaserverid;if(i)this.onTreeCheck(e,t,a);else{var s=this.ztreeIns.getCheckedNodes(),n=s.filter((function(e){return void 0==e.mediaserverid}));n&&n.length&&this.$emit("drawPolygons",{nodes:n,center:a})}},zTreeOnDbClick:function(e,t,a){if(a){this.selectNode=a;var i=a.mediaserverid;i&&(this.isAdd=!1,this.dialog=!0,this.$refs.server.setServerInfo(this.mediaserversObjct[i]))}},cancelDeleteFence:function(){this.isRemove=!1},handleDeleteFence:function(){var e=this,t=this.treeNode,a=t.mediaserverid;if(void 0!=a)Object(S["q"])({mediaserverid:a}).then((function(i){0==i.status?(delete e.mediaserversObjct[a],e.ztreeIns.removeNode(t),e.$XModal.message({message:e.$t("tips.deleteSucc"),status:"success",zIndex:9999}),e.isRemove=!1,t.regions&&e.$emit("removeFence")):e.$XModal.message({message:e.$t("tips.deleteFail"),status:"error",zIndex:9999})}));else{var i=t.serverid,s=t.index,r=this.mediaserversObjct[i],o=r.regions?JSON.parse(r.regions):[],l=o.filter((function(e,t){return s!=t})),c=Object(n["a"])({},r);c.regions=l.length?JSON.stringify(l):"",Object(S["y"])(c).then((function(t){0==t.status?(e.mediaserversObjct[i]=t.mediaserver,e.isRemove=!1,e.initZtree(),e.$emit("removeFence")):e.$XModal.message({message:t.cause,status:"error",zIndex:9999})}))}},addServer:function(e){var t=e.mediaserverid;this.mediaserversObjct[t]=e;var a={mediaserverid:t,name:this.getServerName(e),sortname:e.name,children:[],open:!0,icon:1==e.enabled?k.a:C.a};this.ztreeIns.addNodes(null,a),this.dialog=!1},getServerName:function(e){var t=(1==e.asdefault?"★ ":"")+e.name,a=e.servicetype,i="";return 1==(1&a)&&(i+=this.$t("systemManage.realtimePlay")),2==(2&a)&&(i.length&&(i+="+"),i+=this.$t("monitor.activeSafety")),4==(4&a)&&(i.length&&(i+="+"),i+="FTP"),t+(i.length?"(".concat(i,")"):"")},editServer:function(e){var t=e.mediaserverid;this.mediaserversObjct[t]=e,this.selectNode.name=this.getServerName(e),this.selectNode.sortname=e.name,this.selectNode.icon=1==e.enabled?k.a:C.a,this.ztreeIns.updateNode(this.selectNode),this.dialog=!1},handleOpenDialog:function(){this.isAdd=!0,this.dialog=!0,this.$refs.server.setServerInfo(null)},getServerOptions:function(){var e=[],t=this.mediaserversObjct;for(var a in t){var i=t[a];e.push({value:a,label:i.name})}return e},getMediaServerBymediaserverid:function(e){return this.mediaserversObjct[e]}}},P=D,N=(a("5dcc"),Object(v["a"])(P,g,A,!1,null,null,null)),W=N.exports,Z={data:function(){return{dialog:!1,mediaserverid:"",serverOptions:[]}},components:{SerevrTree:W,SerevrMap:b,LabelWrap:I["a"]},mounted:function(){},watch:{dialog:function(e){0==e&&this.$refs.serevrMap.markLayer.clear()}},methods:{drawPolygons:function(e){this.$refs.serevrMap.drawPolygons(e)},handleDraw:function(){this.$refs.serevrMap.startDraw()},onDrawend:function(e){this.geometry=e,this.serverOptions=this.$refs.tree.getServerOptions(),!this.mediaserverid&&this.serverOptions.length>0&&(this.mediaserverid=this.serverOptions[0].value),this.dialog=!0},getMediaserverNameById:function(e){var t=this.$refs.tree.getMediaServerBymediaserverid(e);return t.name},removeFence:function(){this.$refs.serevrMap.fenceLayer.clear(),this.$refs.serevrMap.markLayer.clear()},handleEdit:function(){var e=this;if(this.mediaserverid){var t="bMap"==this.$refs.serevrMap.myMapType,a=this.$refs.tree.getMediaServerBymediaserverid(this.mediaserverid),i=a.regions?JSON.parse(a.regions):[],s=this.geometry,r=s.getCoordinates()[0],o=[];o=t?Object(d["e"])(r):Object(d["j"])(r),o.forEach((function(e){e.x=Number(e.x.toFixed(5)),e.y=Number(e.y.toFixed(5))})),i.push(o);var l=Object(n["a"])({},a);l.regions=JSON.stringify(i),Object(S["y"])(l).then((function(t){0==t.status?(e.$XModal.message({message:e.$t("tips.addSucc"),status:"success",zIndex:9999}),a.regions=l.regions,e.$refs.tree.initZtree(),e.$refs.serevrMap.fenceLayer.clear(),e.$refs.serevrMap.markLayer.clear(),e.dialog=!1):e.$XModal.message({message:t.cause,status:"error",zIndex:9999})}))}}}},U=Z,J=(a("23b8"),Object(v["a"])(U,i,s,!1,null,null,null)),R=J.exports;t["default"]=R},"5dcc":function(e,t,a){"use strict";a("0a71")},"6e6c":function(e,t,a){"use strict";a("f58b")},"93b4":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAP9JREFUOE/lkU1uwjAQheeZFCSc5ABI5QTddEWXXIAcoxcg2yqgbsMFegxzgW5hg8QBumDBAZJYBQU8yOZHVAIRKcvOavzJ8/w8D1SzYOf7CXthqGe2zzLZ+x5jd5cFes5EJs/lm73nBKKJ/iDmFyIIAi3VUH5WZUeBtPgtm9zFBg1P0I+K/XaUFpuyyc+P2FmAVez/6aO0uM+YEU20sTOg42GvYl+c3HCWy6cw0OW16C32mssG7EsuCGBExoCA5BJMBYYkYbEInIPLF1pd6W1XeveIqaEU9Xdwy8F/28E5exejLeaR3b6LtwJzKQxS/Q42HTcPsZ7G8qsqcwJ16gCDaUG23KGUnAAAAABJRU5ErkJggg=="},ada3:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAQJJREFUOE+lU7FOAkEUnHmJhQlf4C/wE9ALjTG2VFpIKPyB42iBloTOxsJcaWui9rZ8BSWhQnZwOfbgwIB3bPPyNm8mb2dmed2f1czsBdAVChwBU0KPbA7nEaCuiE8u9ZXjMEY7fQLgFkCogFPMZn/WhTHyBG9PlXoAhHvfr8mlEcAedXEj/nwDuswRFNh+8rtFdT2fbVAAvT9KL+IZeGQalCLZF/GYCwSeBbQEvRK8y2uwcUFLxWETA2renU2fSHwn1XFObTN+HBCc94RS6BSUinjsmAnOEaFmb0zvy7jwR5BORDnNv5JtlBee5PAv/OszOcWZOz4HjcH8ntS4jI4SH1as+p1OHc26IAAAAABJRU5ErkJggg=="},b4aa:function(e,t,a){"use strict";a("b0c0"),a("498a");var i=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.handleClickOutside,expression:"handleClickOutside"}],staticClass:"search-address"},[t("div",{staticClass:"search-address-input"},[t("el-input",{ref:"input",style:e.inputStyle,attrs:{placeholder:e.$t("tips.searchAddress"),"prefix-icon":"el-icon-search",clearable:""},on:{focus:function(t){e.isFocus=!0},blur:e.onBlur},nativeOn:{click:function(t){e.show=!0}},model:{value:e.textVal,callback:function(t){e.textVal="string"===typeof t?t.trim():t},expression:"textVal"}})],1),e.show&&e.addressList.length>0?t("div",{staticClass:"search-address-list"},[t("el-scrollbar",{staticStyle:{height:"100%"}},e._l(e.addressList,(function(a,i){return t("div",{staticClass:"search-address-list-item",on:{click:function(t){return e.handleClickItem(a)}}},[t("div",{domProps:{textContent:e._s(a.name)}}),t("div",{staticClass:"ellipsis",domProps:{textContent:e._s(a.address)}})])})),0)],1):e._e()])},s=[],n=a("5530"),r=(a("99af"),a("14d9"),a("d3b7"),a("159b"),a("9169")),o=a("c276"),l=a("2f62"),c=a("7cf8"),d=a("a167"),p=a("1d35"),m={name:"SearchAddress",data:function(){return{show:!1,isFocus:!1,textVal:"",addressList:[]}},watch:{textVal:function(e){this.onSearchAddress(this,e)},isFocus:function(e){e&&0==this.addressList.length&&this.textVal.length>0&&this.queryList(this.textVal)}},computed:Object(n["a"])(Object(n["a"])({},Object(l["b"])(["isZh","mapType"])),{},{inputStyle:function(){return{width:this.isFocus?"230px":"160px",transition:"width 0.3s ease 0s"}}}),directives:{Clickoutside:r["a"]},mounted:function(){this.addressMarker=null},methods:{onBlur:function(){this.isFocus=this.show},handleClickOutside:function(){this.isFocus=!1,this.show=!1,this.$refs.input.blur()},handleClickItem:function(e){var t=this;this.isFocus=!0;var a=this.$parent,i="bMap"==this.mapType,s=i?e.bpoint:e.gpoint;e.point=s,null==this.addressMarker?(this.addressMarker=this.createPointMarker(e).on("mousedown",(function(){this.openInfoWindow(this.getCoordinates())})),a.addressLayer.addGeometry(this.addressMarker)):this.addressMarker.hide(),a.setMarkCircularInfo&&a.setMarkCircularInfo(e);var n=this.getInfoOptions(e);a.mapIns.setCenter(s),a.mapIns.setZoom(18),this.addressMarker.setInfoWindow(n),this.addressMarker.openInfoWindow(s),this.addressMarker.setCoordinates(s),this.addressMarker.show();var r=this.addressMarker.getInfoWindow(),o=function e(a){a.target.removeEventListener("hide",e),t.addressMarker.hide()};r.addEventListener("hide",o)},createPointMarker:function(e){var t="bMap"==this.mapType,a=e.gpoint,i=e.bpoint,s=t?[i.x,i.y]:[a.x,a.y];return new maptalks.Marker(s,{symbol:{markerFile:p,markerWidth:30,markerHeight:30,markerRotation:-0,markerDy:0,markerDx:0}})},onSearchAddress:Object(o["e"])((function(e,t){""==t?(e.show=!1,e.addressList=[]):e.queryList(t)}),1e3),queryList:function(e){var t=this,a="bMap"==this.mapType,i=this.$parent.mapIns,s=i.getCenter(),n=null,r=null;if(a){var l=Object(d["d"])(s.x,s.y);n=l[0],r=l[1]}else{var p=Object(d["h"])(s.x,s.y);n=p[0],r=p[1]}var m={keyword:e,lon:n,lat:r,map:this.mapType};Object(c["gb"])(m).then((function(e){var a=e.places,i=[];a&&a.forEach((function(e){var t=Object(d["n"])(e.lon,e.lat);e.gpoint={y:t[1],x:t[0]};var a=Object(d["m"])(e.lon,e.lat);e.bpoint={y:a[1],x:a[0]},e.lon=Object(o["Ob"])(e.lon),e.lat=Object(o["Ob"])(e.lat),e.address=null==e.address?"-":e.address,e.telephone=null==e.telephone?"-":e.telephone,i.push(e)})),t.show=i.length>0,t.addressList=i}))},getInfoOptions:function(e){var t=this.$t("home.phone"),a=this.$t("monitor.coordinate"),i="".concat(e.name,"-").concat(t,":").concat(e.telephone,"-").concat(a,":").concat(e.lat,",").concat(e.lon,"-").concat(e.address),s={content:'\n                    <div class="search-address-info">\n                        <div class="search-address-info-title">'.concat(e.name,' <i class="el-icon-document-copy" style="font-size:12px;cursor: pointer;" onclick="onClikCopyDevice(\'').concat(i,"')\"></i></div>\n                        ").concat("-"==e.telephone?"":"<div>".concat(t,":").concat(e.telephone,"</div>"),"   \n                        <div>").concat(e.address,' <i class="el-icon-document-copy" style="font-size:12px;cursor: pointer;" onclick="onClikCopyDevice(\'').concat(e.address,"')\"></i></div>\n                        <div>").concat(a,":").concat(e.lon,",").concat(e.lat,' <i class="el-icon-document-copy" style="font-size:12px;cursor: pointer;" onclick="onClikCopyDevice(\'').concat(e.lon,",").concat(e.lat,"')\"></i></div>\n                    </div>\n                "),width:"240",autoOpenOn:null,autoCloseOn:!1,animation:!1,autoPan:!1,animationDuration:0};return s}}},u=m,h=(a("6e6c"),a("2877")),f=Object(h["a"])(u,i,s,!1,null,null,null);t["a"]=f.exports},e5a5:function(e,t,a){"use strict";a("3640")},f58b:function(e,t,a){},f68d:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAPtJREFUOE+tUzFOAzEQnFlXfCFf4BPJGyJEmwoKEOW1SWhOp+sj0dFQoHwhEkdPyyt4gz2JoxiZXBR8AkvWyqvd8e7OLOu6HjvnXgCMMOBI+iJ5x7Zt55IWADpJ7zkGyXn2XgO4ApAsJC3ZNM3iENhVVTVJCZk/ujoAKwCPZjYNIXwAuDgGKG3gc1fFZQz+BijNPBXHOMQ/ARz1OgirN8RfWHgGMAPwCuD6xwwSC977ZSrBzMYZjWtJG5IP3vt759zbKYBB5f8fC3GI5742M4UQmGzW4t6fK7G0hb6QCqQc9R9vknIE6e9CyTLtuT8sWdLBDcmn0vrzOEm3W18+nzmdi3b3AAAAAElFTkSuQmCC"}}]);