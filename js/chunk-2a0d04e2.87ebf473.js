(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2a0d04e2"],{"0595":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"quick-time-range"},[e("div",{staticClass:"quick-time-range-wrapper"},t._l(t.list,(function(a){return e("div",{key:a.type,style:{color:a.type==t.type?"#409EFF":""},on:{click:function(e){return t.selectDate(a.type)}}},[t._v(t._s(a.label))])})),0),e("div",{staticClass:"quick-time-range-space"}),e("div",{staticClass:"quick-time-range-btn",on:{click:function(e){t.isCollapse=!t.isCollapse}}},[t.isCollapse?e("i",{staticClass:"el-icon-arrow-right"}):e("i",{staticClass:"el-icon-arrow-left"})])])},n=[],r=a("5101"),s={name:"QuickTimeRange",props:{value:{type:Array,default:function(){return[]}},dateType:{type:String,default:"date"}},watch:{isCollapse:function(){this.setList()}},data:function(){return{isCollapse:!0,type:0,list:[]}},methods:{setList:function(){this.isCollapse?this.list=[{label:this.$t("reportForm.toDay"),type:0},{label:this.$t("reportForm.yesterDay"),type:1},{label:this.$t("reportForm.recent3Days"),type:3}]:this.list=[{label:this.$t("reportForm.recent7Days"),type:7},{label:this.$t("reportForm.recent10Days"),type:10},{label:this.$t("reportForm.recent30Days"),type:30}]},selectDate:function(t){var e="datetimerange"==this.dateType,a=[],i=new Date,n=new Date;switch(e&&(i=new Date(r["a"].format(new Date,"yyyy-MM-dd")+" 00:00:00"),n=new Date(r["a"].format(new Date,"yyyy-MM-dd")+" 23:59:59")),t){case 0:a=[new Date(r["a"].format(i,"yyyy-MM-dd")+" 00:00:00"),new Date(r["a"].format(n,"yyyy-MM-dd")+" 23:59:59")];break;case 1:i.setTime(i.getTime()-864e5),a=[i,n];break;case 3:i.setTime(i.getTime()-2592e5),a=[i,n];break;case 7:i.setTime(i.getTime()-6048e5),a=[i,n];break;case 10:i.setTime(i.getTime()-864e6),a=[i,n];break;case 30:i.setTime(i.getTime()-2592e6),a=[i,n];break}this.type=t,this.$emit("input",a)}},mounted:function(){var t=this;this.$nextTick((function(){t.setList()}))}},o=s,c=(a("c51d"),a("2877")),l=Object(c["a"])(o,i,n,!1,null,null,null);e["a"]=l.exports},"271ae":function(t,e,a){},"2ddc":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"multi-choice",style:t.warpStyle},[e("div",{staticClass:"multi-choice-input"},["daterange"==t.dateType?e("div",[e("el-date-picker",{attrs:{type:t.dateType,"picker-options":t.pickerOptions,"range-separator":"-",align:"center","unlink-panels":"",clearable:!1,"start-placeholder":t.$t("device.driverinitialdate"),"end-placeholder":t.$t("device.drivereffectivedate")},on:{change:t.onChange},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1):t._e(),"date"==t.dateType?e("div",[e("el-date-picker",{attrs:{type:"date","picker-options":t.datePickerOptions},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1):t._e(),"datetimerange"==t.dateType?e("div",{staticClass:"datetimerange"},[e("el-date-picker",{attrs:{type:t.dateType,"range-separator":"-","picker-options":t.pickerOptionsTime,align:"center","unlink-panels":"",clearable:!1,"start-placeholder":t.$t("device.driverinitialdate"),"end-placeholder":t.$t("device.drivereffectivedate"),"default-time":["00:00:00","23:59:59"]},on:{change:t.onChange},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1):t._e(),"month"==t.dateType?e("div",[e("el-date-picker",{attrs:{type:"month"},model:{value:t.month,callback:function(e){t.month=e},expression:"month"}})],1):t._e()])])},n=[],r=(a("99af"),a("5101")),s=a("5867"),o={name:"SelectDate",props:{value:{type:Array|Date,default:function(){return[]}},dateType:{type:String,default:"daterange"},label:{type:String,default:function(){return this.$t("common.selectTime")}}},computed:{isDaterange:function(){return"daterange"==this.dateType},warpStyle:function(){var t=200;switch(this.dateType){case"date":t=120;break;case"daterange":t=230;break;case"datetimerange":t=310;break}return{width:"".concat(t,"px")}}},mixins:[s["a"]],data:function(){var t=864e5;return{dateRange:[],date:new Date,month:new Date,pickerOptions:{shortcuts:[{text:this.$t("reportForm.toDay"),onClick:function(t){var e=new Date;t.$emit("pick",[e,e])}},{text:this.$t("reportForm.yesterDay"),onClick:function(e){var a=new Date;a.setTime(a.getTime()-t),e.$emit("pick",[a,a])}},{text:this.$t("missing.theWeek"),onClick:function(e){var a=new Date,i=new Date,n=a.getDay();a.setTime(a.getTime()-t*(n-1)),i.setTime(a.getTime()+6*t),e.$emit("pick",[a,i])}},{text:this.$t("missing.lastWeek"),onClick:function(e){var a=new Date,i=new Date,n=a.getDay(),r=a.getTime()-t*(n-1);a.setTime(r-7*t),i.setTime(r-t),e.$emit("pick",[a,i])}},{text:this.$t("missing.thisMonth"),onClick:function(t){var e=new Date,a=e.getFullYear(),i=e.getMonth()+1,n=new Date("".concat(a,"-").concat(i,"-01")),r=new Date("".concat(a,"-").concat(i,"-01 00:00:00"));r.setMonth(r.getMonth()+1),r=new Date(r.getTime()-1e3),t.$emit("pick",[n,r])}},{text:this.$t("missing.lastMonth"),onClick:function(t){var e=new Date;e.setMonth(e.getMonth()-1);var a=e.getFullYear(),i=e.getMonth()+1,n=new Date(new Date(a,i,1)-1).getDate(),r=new Date("".concat(a,"-").concat(i,"-01")),s=new Date("".concat(a,"-").concat(i,"-").concat(n));t.$emit("pick",[r,s])}}]},pickerOptionsTime:{shortcuts:[{text:this.$t("reportForm.toDay"),onClick:function(t){var e=new Date(r["a"].format(new Date,"yyyy-MM-dd")+" 00:00:00"),a=new Date(r["a"].format(new Date,"yyyy-MM-dd")+" 23:59:59");t.$emit("pick",[e,a])}},{text:this.$t("reportForm.yesterDay"),onClick:function(e){var a=new Date;a.setTime(a.getTime()-t),e.$emit("pick",[new Date(r["a"].format(a,"yyyy-MM-dd")+" 00:00:00"),new Date(r["a"].format(a,"yyyy-MM-dd")+" 23:59:59")])}},{text:this.$t("missing.theWeek"),onClick:function(e){var a=new Date,i=new Date,n=a.getDay();a.setTime(a.getTime()-t*(n-1)),i.setTime(a.getTime()+6*t),e.$emit("pick",[new Date(r["a"].format(a,"yyyy-MM-dd")+" 00:00:00"),new Date(r["a"].format(i,"yyyy-MM-dd")+" 23:59:59")])}},{text:this.$t("missing.lastWeek"),onClick:function(e){var a=new Date,i=new Date,n=a.getDay(),s=a.getTime()-t*(n-1);a.setTime(s-7*t),i.setTime(s-t),e.$emit("pick",[new Date(r["a"].format(a,"yyyy-MM-dd")+" 00:00:00"),new Date(r["a"].format(i,"yyyy-MM-dd")+" 23:59:59")])}},{text:this.$t("missing.thisMonth"),onClick:function(t){var e=new Date,a=e.getFullYear(),i=e.getMonth()+1,n=new Date("".concat(a,"-").concat(i,"-01")),s=new Date("".concat(a,"-").concat(i,"-01 00:00:00"));s.setMonth(s.getMonth()+1),s=new Date(s.getTime()-1e3),t.$emit("pick",[new Date(r["a"].format(n,"yyyy-MM-dd")+" 00:00:00"),new Date(r["a"].format(s,"yyyy-MM-dd")+" 23:59:59")])}},{text:this.$t("missing.lastMonth"),onClick:function(t){var e=new Date;e.setMonth(e.getMonth()-1);var a=e.getFullYear(),i=e.getMonth()+1,n=new Date(new Date(a,i,1)-1).getDate(),s=new Date("".concat(a,"-").concat(i,"-01")),o=new Date("".concat(a,"-").concat(i,"-").concat(n));t.$emit("pick",[new Date(r["a"].format(s,"yyyy-MM-dd")+" 00:00:00"),new Date(r["a"].format(o,"yyyy-MM-dd")+" 23:59:59")])}}]}}},watch:{dateRange:function(t){null==t?this.$emit("input",[]):this.$emit("input",t)},value:function(t){this.dateRange=t},date:function(t){this.$emit("input",t)},month:function(t){this.$emit("input",t)}},methods:{onChange:function(t){this.$emit("input",t)}},mounted:function(){"date"==this.dateType?this.date=this.value:"month"==this.dateType?this.month=this.value:this.dateRange=this.value}},c=o,l=(a("e716"),a("2877")),d=Object(l["a"])(c,i,n,!1,null,"5dbb8594",null);e["a"]=d.exports},"94cd":function(t,e,a){"use strict";a("b520")},b520:function(t,e,a){},c51d:function(t,e,a){"use strict";a("ecfc")},c596:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"transfer-records"},[e("div",{staticClass:"transfer-records-header"},[e("div",{staticClass:"f_left"},[e("SelectDate",{model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1),e("div",{staticClass:"f_left"},[e("QuickTimeRange",{model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1),e("div",{staticClass:"f_left"},[e("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.handleQuery}},[t._v(t._s(t.$t("common.query")))])],1),e("div",{staticClass:"f_right"},[e("el-button",{attrs:{type:"primary",loading:t.exportLoading1},on:{click:t.exportData}},[t._v(t._s(t.$t("common.exportData")))])],1),e("div",{staticClass:"f_right"},[e("span",[t._v(t._s(t.$t("bgManage.totalGoldenBeans")))]),t._v(" : "),e("span",{domProps:{textContent:t._s(t.bonuspoints)}})])]),e("div",{staticClass:"transfer-records-table"},[e("vxe-table",{attrs:{border:"",resizable:"","auto-resize":"","show-overflow":"","highlight-hover-row":"",size:"mini",height:"auto",data:t.tableList,"row-class-name":t.rowClassName}},[e("vxe-table-column",{attrs:{type:"seq",width:"60",title:t.$t("reportForm.index")}}),e("vxe-table-column",{attrs:{field:"assigntypeStr",title:t.$t("bgManage.type"),width:"80"}}),e("vxe-table-column",{attrs:{field:"eventtypeStr",title:t.$t("bgManage.event"),width:"100"}}),e("vxe-table-column",{attrs:{field:"createtimeStr",title:t.$t("bgManage.operationTime"),width:"155",sortable:""}}),e("vxe-table-column",{attrs:{field:"otherusername",title:t.$t("bgManage.operationAccount")}}),e("vxe-table-column",{attrs:{field:"points",title:t.$t("bgManage.operatingGoldenBeans"),sortable:""}}),e("vxe-table-column",{attrs:{field:"prepoints",title:t.$t("bgManage.beforeJindou"),sortable:""}}),e("vxe-table-column",{attrs:{field:"postpoints",title:t.$t("bgManage.afterJindou"),sortable:""}}),e("vxe-table-column",{attrs:{field:"remark",title:t.$t("reportForm.remarks"),width:"100"}}),e("vxe-table-column",{attrs:{title:t.$t("bgManage.deviceList"),width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.handleClickRow(a.row)}}},[t._v(t._s(t.$t("common.see")))])]}}])})],1)],1),e("div",{staticClass:"transfer-records-footer"},[t._v(" "+t._s(t.$t("reportForm.total"))+" "),e("span",{domProps:{textContent:t._s(t.total)}}),t._v(", "+t._s(t.$t("bgManage.switchOut"))+": "),e("span",{domProps:{textContent:t._s(t.switchOut)}}),t._v(", "+t._s(t.$t("bgManage.switchIn"))+": "),e("span",{domProps:{textContent:t._s(t.switchIn)}})]),e("DeviceListDialog",{ref:"dialog",model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}})],1)},n=[],r=(a("99af"),a("14d9"),a("4e82"),a("a9e3"),a("b680"),a("d3b7"),a("159b"),a("e285")),s=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:t.title,visible:t.value,center:"",width:"980px","append-to-body":"","close-on-click-modal":!1},on:{close:t.handleClose}},[e("vxe-table",{staticClass:"mytable-scrollbar",attrs:{"menu-config":t.tableMenu,border:"",resizable:"","show-overflow":"","highlight-hover-row":"",size:"mini",height:"460",data:t.tableList},on:{"menu-click":t.handleClickTableMenu}},[e("vxe-table-column",{attrs:{type:"seq",width:"60",title:t.$t("reportForm.index")}}),e("vxe-table-column",{attrs:{field:"creater",title:t.$t("reportForm.creater"),width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-popover",{attrs:{placement:"bottom",trigger:"click"}},[e("div",{staticClass:"parents-wrapper"},t._l(t.parentsList,(function(a){return e("div",{key:a.username},[t._v(t._s(a.username)+"("+t._s(a.usertypeStr)+")")])})),0),e("el-button",{staticStyle:{color:"#000000"},attrs:{slot:"reference",type:"text"},on:{click:function(e){return t.queryParents(a.row.creater)}},slot:"reference"},[t._v(t._s(a.row.creater))])],1)]}}])}),e("vxe-table-column",{attrs:{field:"groupname",title:t.$t("reportForm.groupName"),width:"100"}}),e("vxe-table-column",{attrs:{field:"devicename",title:t.$t("alarm.devName"),width:"100"}}),e("vxe-table-column",{attrs:{field:"deviceid",title:t.$t("alarm.devNum"),width:"80"}}),e("vxe-table-column",{attrs:{field:"simnum",title:t.$t("reportForm.sim"),width:"80"}}),e("vxe-table-column",{attrs:{field:"simiccid",title:"ICCID",width:"80"}}),e("vxe-table-column",{attrs:{field:"devicetypename",title:t.$t("reportForm.deviceType"),width:"100",sortable:""}}),e("vxe-table-column",{attrs:{field:"chargepoints",title:t.$t("bgManage.goldenBeanNumber"),width:"100"}}),e("vxe-table-column",{attrs:{field:"chargeyears",title:t.$t("bgManage.renewYears"),width:"100",sortable:""}}),e("vxe-table-column",{attrs:{field:"peryearpoints",title:t.$t("bgManage.totalAmount"),width:"100",sortable:""}}),e("vxe-table-column",{attrs:{field:"preoverduetimeStr",title:t.$t("bgManage.renewBefore"),width:"100"}}),e("vxe-table-column",{attrs:{field:"postoverduetimeStr",title:t.$t("bgManage.renewAfter"),width:"100"}})],1),e("el-row",{staticStyle:{"margin-top":"10px"}},[e("el-col",{attrs:{span:8,offset:3}},[e("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:t.handleClose}},[t._v(" "+t._s(t.$t("common.determine")))])],1),e("el-col",{attrs:{span:8,offset:2}},[e("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:t.exportLoading1},on:{click:t.exportData}},[t._v(" "+t._s(t.$t("common.exportData")))])],1)],1)],1)},o=[],c=a("5101"),l=a("6e52"),d=a("a05b"),u=a("0c87"),p={name:"DeviceListDialog",props:{value:{type:Boolean,default:!1}},data:function(){return{exportLoading1:!1,tableList:[]}},watch:{value:function(t){t||(this.tableList=[])}},computed:{title:function(){var t=this.tableList[0];return t?this.$t("bgManage.renewList")+(t?"  "+t.chargetimeStr:""):this.$t("bgManage.renewList")}},mixins:[d["a"],u["a"]],methods:{handleClose:function(){this.$emit("input",!1)},exportData:function(){var t=[[this.$t("reportForm.index"),this.$t("reportForm.creater"),this.$t("reportForm.groupName"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("reportForm.sim"),"ICCID",this.$t("reportForm.deviceType"),this.$t("bgManage.goldenBeanNumber"),this.$t("bgManage.renewYears"),this.$t("bgManage.totalAmount"),this.$t("bgManage.renewTime"),this.$t("bgManage.renewBefore"),this.$t("bgManage.renewAfter")]];if(0!=this.tableList.length){this.tableList.forEach((function(e,a){var i=[];i.push(a+1),i.push(e.creater),i.push(e.groupname),i.push(e.devicename),i.push(e.deviceid),i.push(e.simnum?e.simnum:""),i.push(e.simiccid?e.simiccid:""),i.push(e.devicetypename),i.push(e.chargepoints),i.push(e.chargeyears),i.push(e.peryearpoints),i.push(e.chargetimeStr),i.push(e.preoverduetimeStr),i.push(e.postoverduetimeStr),t.push(i)}));var e={title:this.$t("bgManage.renewList"),data:t,dateRange:null};this.exportLoading1=!0,new ExcelCls(e).exportExcel(this)}},queryChargeDevices:function(t){var e=this;Object(r["ib"])(t).then((function(t){var a=t.records;a&&a.length?(a.forEach((function(t){var e=t.deviceid,a=l["a"].deviceInfos[e];t.creater=a?a.creater:"",t.groupname=a?a.groupname:"",t.chargetimeStr=0!=t.chargetime?c["a"].longToLocalDateTimeStr(t.chargetime):"-",t.postoverduetimeStr=0!=t.postoverduetime?c["a"].format(new Date(t.postoverduetime),"yyyy-MM-dd"):"-",t.preoverduetimeStr=0!=t.preoverduetime?c["a"].format(new Date(t.preoverduetime),"yyyy-MM-dd"):"-"})),e.tableList=a):e.tableList=[]}))}}},m=p,h=a("2877"),g=Object(h["a"])(m,s,o,!1,null,null,null),y=g.exports,f=a("2ddc"),v=a("0595"),b=a("c276"),w={name:"transferRecords",data:function(){return{loading:!1,dialog:!1,exportLoading1:!1,dateRange:[new Date,new Date],tableList:[],bonuspoints:"",total:0,switchOut:0,switchIn:0}},components:{SelectDate:f["a"],QuickTimeRange:v["a"],DeviceListDialog:y},methods:{exportData:function(){var t=[[this.$t("reportForm.index"),this.$t("bgManage.event"),this.$t("bgManage.type"),this.$t("bgManage.operationTime"),this.$t("bgManage.operationAccount"),this.$t("bgManage.operatingGoldenBeans"),this.$t("bgManage.beforeJindou"),this.$t("bgManage.afterJindou"),this.$t("reportForm.remarks")]];this.tableList.forEach((function(e,a){var i=[];i.push(++a),i.push(e.eventtypeStr),i.push(e.assigntypeStr),i.push(e.createtimeStr),i.push(e.otherusername),i.push(e.points),i.push(e.prepoints),i.push(e.postpoints),i.push(e.remark),t.push(i)}));var e={title:this.$t("bgManage.transferRecords"),data:t,dateRange:this.dateRangeRecords};this.exportLoading1=!0,new ExcelCls(e).exportExcel(this)},rowClassName:function(t){var e=t.row;t.rowIndex;return 0===e.assigntype?"row-blue":"row-red"},handleQuery:function(){var t=this,e=this.dateRange,a=c["a"].format(e[0],"yyyy-MM-dd"),i=c["a"].format(e[1],"yyyy-MM-dd"),n={startday:a,endday:i,offset:c["a"].getOffset(),notifytype:0};this.loading=!0,this.dateRangeRecords="".concat(a," - ").concat(i),Object(r["Db"])(n).then((function(e){var a=e.records;if(t.loading=!1,a&&a.length){t.tableList=[];var i=0,n=0,r=0;a.sort((function(t,e){return e.createtime-t.createtime})),a.forEach((function(e){i+=e.points,e.eventtypeStr=Object(b["z"])(e.eventtype),e.assigntypeStr=0===e.assigntype?t.$t("bgManage.switchIn"):t.$t("bgManage.switchOut"),e.createtimeStr=c["a"].longToLocalDateTimeStr(e.createtime),e.points=Number(e.points.toFixed(2)),e.prepoints=Number(e.prepoints.toFixed(2)),e.postpoints=Number(e.postpoints.toFixed(2)),0===e.assigntype?n+=e.points:r+=e.points})),t.tableList=a,t.total=Number(i.toFixed(2)),t.switchIn=Number(n.toFixed(2)),t.switchOut=Math.abs(Number(r.toFixed(2)))}else t.tableList=[],t.total=0,t.switchIn=0,t.switchOut=0})).catch((function(e){t.loading=!1}))},handleClickRow:function(t){this.dialog=!0,this.$refs.dialog.queryChargeDevices(t.devicechargeuuid)}},mounted:function(){var t=this;this.dateRangeRecords=null,Object(r["gb"])().then((function(e){var a=e.bonuspoints;t.bonuspoints=Number(a.toFixed(2))}))}},$=w,D=(a("94cd"),Object(h["a"])($,i,n,!1,null,null,null)),M=D.exports;e["default"]=M},e716:function(t,e,a){"use strict";a("271ae")},ecfc:function(t,e,a){}}]);