(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ca4c1ce4"],{1078:function(t,e,i){"use strict";var r=function(){var t=this,e=t._self._c;return e("div",{ref:"wraper",class:t.wraperClasses,on:{mouseup:t.handleMouseup,mousemove:t.handleMousemove,mouseleave:t.handleMouseout}},[e("div",{class:"".concat(t.prefix,"-container")},[e("div",{class:"".concat(t.prefix,"-top-area-oil"),style:{height:"move"==t.verticalMode?t.leftSize:"100%"}},[t._t("top")],2),t._t("trigger",(function(){return[e("div",{ref:"trigger",class:"".concat(t.prefix,"-trigger-oil"),style:t.verticalTriggerStyle},[e("div",{class:"".concat(t.prefix,"-trigger-oil-wrap"),attrs:{unselectable:"on"},on:{mousedown:t.handleMousedown}})])]})),e("div",{class:"".concat(t.prefix,"-bottom-area"),style:{height:"move"==t.verticalMode?t.rightSize:"100%"}},[t._t("bottom")],2)],2)])},a=[],o=(i("c975"),i("a9e3"),function(t,e){return e.indexOf(t)>=0}),s={name:"MySplitPane",props:{value:{type:[Number,String],default:50},horizontalModeShowLeft:{type:Boolean,default:!0},verticalMode:{type:String,default:"move"},direction:{type:String,default:"horizontal",validator:function(t){return o(t,["vertical","horizontal"])}},min:{type:[Number,String],default:3},max:{type:[Number,String],default:97},maxRight:{type:Boolean,default:!1},right:{type:Boolean,default:!1},triggerStyle:{type:Object,default:function(){return{height:"4px",background:"#ffffff"}}}},data:function(){return{prefix:"split-pane",canMove:!1,triggerOffset:50,triggerOldOffset:50,offset:{},atMin:!1,atMax:!1,directionMark:0}},computed:{wraperClasses:function(){return[this.prefix,"vertical"===this.direction?"".concat(this.prefix,"-vertical"):"".concat(this.prefix,"-horizontal")]},leftSize:function(){return this.right?"".concat(100-this.triggerOffset,"%"):"".concat(this.triggerOffset,"%")},rightSize:function(){return this.right?"".concat(this.triggerOffset,"%"):"".concat(100-this.triggerOffset,"%")},triggerLeft:function(){return this.right?"".concat(100-this.triggerOffset,"%"):"".concat(this.triggerOffset,"%")},minTransed:function(){return this.transValue(this.min)},maxTransed:function(){var t=this.right?100-this.transValue(this.max):this.transValue(this.max);return this.maxRight?100-t:t},horizontalTriggerStyle:function(){return Object.assign({left:this.triggerLeft,borderTop:"1px solid #E2E3E5"},this.triggerStyle)},verticalTriggerStyle:function(){return Object.assign({top:this.triggerLeft},this.triggerStyle)}},methods:{handleMouseup:function(t){1==this.canMove&&(this.canMove=!1,this.$emit("on-resizing-end",t))},transValue:function(t){return"number"===typeof t?t:Math.floor(parseFloat(t)/this.$refs.wraper.offsetWidth*1e4)/100},handleMousedown:function(t){this.canMove=!0,this.triggerOldOffset=this.triggerOffset,this.offset={x:t.pageX,y:t.pageY},this.$emit("on-resizing-start",t),t.preventDefault()},handleMouseout:function(){this.canMove=!1},handleMousemove:function(t){if(this.canMove){var e,i=0;if("horizontal"===this.direction?(i=Math.floor((t.clientX-this.offset.x)/this.$refs.wraper.offsetWidth*1e4)/100,e=this.triggerOldOffset+(this.right?-i:i)):(i=Math.floor((t.clientY-this.offset.y)/this.$refs.wraper.offsetHeight*1e4)/100,e=this.triggerOldOffset+(this.right?-i:i)),this.right){var r=100-e;r<=this.minTransed?this.triggerOffset=100-Math.max(r,this.minTransed):this.triggerOffset=100-Math.min(r,this.maxTransed)}else e<=this.minTransed?this.triggerOffset=Math.max(e,this.minTransed):this.triggerOffset=Math.min(e,this.maxTransed);t.atMin=100-e<=this.minTransed,t.atMax=100-e>=this.maxTransed,t.pageX>this.directionMark?t.direction=1:t.direction=0,this.directionMark=t.pageX,this.$emit("input",this.triggerOffset),this.$emit("on-resizing",t)}},setTriggerOffset:function(t){var e=this;this.$nextTick((function(){e.triggerOffset="number"===typeof t?t:Math.floor(parseInt(t)/e.$refs.wraper.offsetWidth*1e4)/100,e.$emit("input",e.triggerOffset)}))}},watch:{value:function(t){var e=this;this.$nextTick((function(){e.triggerOffset="number"===typeof t?t:Math.floor(parseInt(t)/e.$refs.wraper.offsetWidth*1e4)/100}))}},mounted:function(){var t=this;void 0!==this.value&&(this.$nextTick((function(){t.triggerOffset="number"===typeof t.value?t.value:Math.floor(parseInt(t.value)/t.$refs.wraper.offsetWidth*1e4)/100})),this.triggerOffset="number"===typeof this.value?this.value:Math.floor(parseInt(this.value)/this.$refs.wraper.offsetWidth*1e4)/100)}},l=s,n=(i("acd3"),i("2877")),d=Object(n["a"])(l,r,a,!1,null,null,null),c=d.exports;e["a"]=c},"4b0a4":function(t,e,i){"use strict";i("b5ed")},9758:function(t,e,i){},acd3:function(t,e,i){"use strict";i("9758")},b5ed:function(t,e,i){},d3e4:function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"report-form full time-oil"},[e("div",{staticClass:"report-form-inner"},[e("div",{staticClass:"report-form-inner-header",staticStyle:{height:"35px"}},[e("div",{staticClass:"f_left"},[e("SingleChoiceVehicle",{attrs:{placeholder:this.$t("tips.selectSingleDevice"),width:"230px"},model:{value:t.deviceid,callback:function(e){t.deviceid=e},expression:"deviceid"}})],1),e("div",{staticClass:"f_left"},[e("SelectDate",{model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1),e("div",{staticClass:"f_left"},[e("QuickTimeRange",{model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1),e("div",{staticClass:"f_left"},[e("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.handleQuery}},[t._v(t._s(t.$t("common.query")))])],1),e("div",{staticClass:"f_left"},[e("el-button",{attrs:{type:"primary",loading:t.exportLoading1},on:{click:t.exportData}},[t._v(t._s(t.$t("common.export")))])],1)]),e("div",{staticClass:"report-form-inner-content",staticStyle:{top:"45px"}},[e("split-pane",{style:{height:"100%"},attrs:{direction:"vertical",showBtn:!1,min:25,max:75},on:{"on-resizing-end":t.onResizingEnd},model:{value:t.triggerOffsetV,callback:function(e){t.triggerOffsetV=e},expression:"triggerOffsetV"}},[e("div",{staticStyle:{height:"100%"},attrs:{slot:"top"},slot:"top"},[e("div",{staticClass:"time-oil-echarts"},[e("TimeOilEcharts",{ref:"echartsIns",on:{"legend-changed":t.onLegendChanged,"select-index":t.scrollToRow,onClickMarkPoint:t.onClickMarkPoint}})],1)]),e("div",{staticStyle:{height:"100%"},attrs:{slot:"bottom"},slot:"bottom"},[e("div",{staticClass:"report-form-inner-content-bottom"},[e("div",{staticClass:"tabs-warpper"},[e("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:t.$t("reportForm.addOrLeakOilList")+"(".concat(t.totalList.length,")"),name:"tabTotal"}}),e("el-tab-pane",{attrs:{label:t.$t("reportForm.oilRecordList")+"(".concat(t.detailsList.length,")"),name:"details"}})],1),e("div",{staticClass:"tableTitle"},[e("b",{domProps:{textContent:t._s(t.tableTitle)}})]),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.isDisabledOilRecords,expression:"!isDisabledOilRecords"}],staticClass:"batch-time"},[e("span",{staticClass:"record-value",domProps:{textContent:t._s(t.begintimeStr)}}),e("span",{staticClass:"record-value",staticStyle:{"padding-left":"10px"},domProps:{textContent:t._s(t.oilVolume)}}),""!=t.oilVolume?e("span",{staticClass:"record-value",staticStyle:{"padding-right":"10px"}},[t._v("L")]):t._e(),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.changeStatrOil}},[t._v(t._s(t.$t("reportForm.addStart")))]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.changeEndOilRecord}},[t._v(t._s(t.$t("reportForm.addEnd")))]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.addOilRecord}},[t._v(t._s(t.$t("reportForm.newAdd")))])],1)],1),e("div",{staticClass:"report-form-inner-content-bottom-tables"},[e("div",{style:t.statisticsStyle},[e("vxe-table",{ref:"oilxTable",staticClass:"mytable-scrollbar",attrs:{"menu-config":t.tableMenu,"auto-resize":"","keep-source":"","row-class-name":t.rowClassName,"cell-class-name":t.cellClassName,"highlight-current-row":"","edit-config":{trigger:"manual",mode:"row",showIcon:!1,autoClear:!1},border:"",resizable:"","show-overflow":"","highlight-hover-row":"",size:"mini",height:"auto",data:t.totalList},on:{"menu-click":t.handleClickTableMenu,"current-change":t.handleCurrentRow}},[e("vxe-table-column",{attrs:{field:"action",title:t.$t("reportForm.action"),width:"100"},scopedSlots:t._u([{key:"default",fn:function(i){return[t.$refs.oilxTable.isActiveByRow(i.row)?[e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.saveRowEvent(i.row)}}},[t._v(t._s(t.$t("common.save")))]),e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.cancelRowEvent(i.row)}}},[t._v(t._s(t.$t("common.cancel")))])]:[t.isDisabledOilRecords?t._e():e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.editRowEvent(i.row)}}},[t._v(t._s(t.$t("common.edit")))]),e("el-popconfirm",{attrs:{placement:"top",icon:"el-icon-info","icon-color":"red",title:t.$t("tips.confirmDelete"),"confirm-button-text":t.$t("common.confirm"),"cancel-button-text":t.$t("common.cancel")},on:{confirm:function(e){return t.delOilRecord(i)}}},[e("span",{staticStyle:{padding:"0px 6px"},attrs:{slot:"reference"},slot:"reference"},[e("el-button",{attrs:{type:"text",size:"mini"}},[t._v(t._s(t.$t("common.delete")))])],1)])]]}}])}),e("vxe-table-column",{attrs:{type:"seq",width:"60",title:t.$t("reportForm.index")}}),e("vxe-table-column",{attrs:{field:"oilindex",title:t.$t("reportForm.oilIndex"),"edit-render":{name:"$select",options:t.oilIndexList,props:{multiple:!1}},width:"100",sortable:""}}),e("vxe-table-column",{attrs:{field:"oilstateStr",title:t.$t("reportForm.status"),width:"100",sortable:""}}),e("vxe-table-column",{attrs:{field:"oilVolume",formatter:t.numberToFixed2,align:"right",title:t.$t("reportForm.oil"),width:"100",sortable:""}}),e("vxe-table-column",{attrs:{field:"soil100",formatter:t.numberToFixed2,align:"right",title:t.$t("reportForm.startOil"),width:"80","edit-render":{name:"$input",props:{type:"text"}},sortable:""}}),e("vxe-table-column",{attrs:{field:"eoil100",formatter:t.numberToFixed2,align:"right",title:t.$t("reportForm.endOil"),width:"80","edit-render":{name:"$input",props:{type:"text"}},sortable:""}}),e("vxe-table-column",{attrs:{field:"begintimeStr",title:t.$t("reportForm.startTime"),"edit-render":{name:"$input",props:{type:"text"}},width:"150",sortable:""}}),e("vxe-table-column",{attrs:{field:"endtimeStr",title:t.$t("reportForm.endTime"),"edit-render":{name:"$input",props:{type:"text"}},width:"150",sortable:""}}),e("vxe-table-column",{attrs:{field:"marker",title:t.$t("reportForm.remarks"),"edit-render":{name:"$input",props:{type:"string"}},width:"160",sortable:""}}),e("vxe-table-column",{attrs:{field:"address",title:t.$t("reportForm.address"),width:"220",sortable:""},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",{staticStyle:{"text-decoration":"underline",cursor:"pointer",color:"#388CFE"},domProps:{textContent:t._s(i.row.address)},on:{click:function(e){return t.queryTracks(i.row)}}})]}}])}),e("vxe-table-column",{attrs:{field:"distance",title:t.$t("reportForm.distance")+"("+t.$t("common.metre")+")",width:"100",sortable:""}}),e("vxe-table-column",{attrs:{field:"avgspeed",formatter:t.numberToFixed2,align:"right",title:t.$t("reportForm.avgSpeed"),width:"110",sortable:""}}),e("vxe-table-column",{attrs:{field:"durationStr",formatter:t.numberToFixed2,align:"right",title:t.$t("reportForm.duration"),width:"100",sortable:""}}),e("vxe-table-column",{attrs:{field:"threshold",title:t.$t("reportForm.threshold"),width:"100",sortable:""}}),e("vxe-table-column",{attrs:{field:"mauneditStr",title:t.$t("reportForm.artificialEdit"),width:"110",sortable:""}})],1)],1),e("div",{style:t.detailsStyle},[e("vxe-table",{ref:"xTable",staticClass:"mytable-scrollbar",attrs:{"menu-config":t.tableMenu,border:"",resizable:"","auto-resize":"","show-overflow":"","highlight-current-row":"","highlight-hover-row":"",size:"mini",height:"auto",data:t.detailsList},on:{"menu-click":t.handleClickTableMenu,"cell-click":t.cellclick,"cell-dblclick":t.cellDblclick}},[e("vxe-table-column",{attrs:{type:"seq",width:"60",title:t.$t("reportForm.index")}}),e("vxe-table-column",{attrs:{field:"updatetimeStr",title:t.$t("reportForm.updatetimeStr"),width:"150",sortable:""}}),e("vxe-table-column",{attrs:{field:"arrivedtimeStr",title:t.$t("reportForm.arrivedtimeStr"),width:"150",sortable:""}}),t._l(t.tableColumn,(function(i,r){return e("vxe-table-column",t._b({key:r,attrs:{formatter:t.numberToFixed2,align:"right",sortable:""}},"vxe-table-column",i,!1))})),e("vxe-table-column",{attrs:{field:"reissue",title:t.$t("reportForm.reissue"),width:"80",sortable:""}}),e("vxe-table-column",{attrs:{field:"status",title:t.$t("reportForm.status"),width:"200",sortable:""}}),e("vxe-table-column",{attrs:{field:"lonLat",title:t.$t("reportForm.lonLat"),width:"140",sortable:""}}),e("vxe-table-column",{attrs:{title:t.$t("reportForm.address"),width:"240"},scopedSlots:t._u([{key:"default",fn:function(i){var r=i.row;return[r.address?e("div",[t._v(t._s(r.address))]):e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.queryAddress(r)}}},[t._v(t._s(t.$t("reportForm.getAddress")))])]}}])})],2)],1)])])])])],1)]),e("transition",{attrs:{name:"el-zoom-in-bottom"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"transition-box"},[e("el-card",[e("div",{staticStyle:{position:"absolute",right:"10px",top:"0px"}},[e("i",{staticClass:"el-icon-close",staticStyle:{float:"right",padding:"3px 0","font-size":"20px",cursor:"pointer"},on:{click:function(e){t.show=!1}}})]),e("div",{staticStyle:{margin:"10px 0px","white-space":"normal","word-break":"break-all",height:"210px","overflow-y":"auto","font-size":"12px"},domProps:{textContent:t._s(t.messageBody)}})])],1)]),e("el-dialog",{attrs:{title:t.$t("reportForm.seeMap"),visible:t.dialogMap,width:"500",center:"","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogMap=e}}},[e("div",{staticStyle:{width:"100%",height:"400px"}},[e("ReportMap",{ref:"mapIns"})],1)])],1)},a=[],o=i("c7eb"),s=i("1da1"),l=i("5530"),n=(i("99af"),i("14d9"),i("4e82"),i("3c65"),i("e9c4"),i("a9e3"),i("b680"),i("b64b"),i("d3b7"),i("159b"),i("4795"),i("2f62")),d=i("d03a"),c=i("d462"),u=i("57c9"),h=i("80f4"),m=i("c1f2"),p=i("1078"),f=i("1c31"),g=i("5101"),v=i("6e52"),b=i("c276"),$=i("7cf8"),x=i("a05b"),w={name:"timeOil",data:function(){return{tableTitle:"",deviceid:"",loading:!1,exportLoading1:!1,dialogMap:!1,activeName:"tabTotal",dateRange:[new Date,new Date],totalList:[],detailsList:[],triggerOffsetV:45,oilIndexList:[{label:this.$t("reportForm.totalDriving"),value:"0"},{label:this.$t("reportForm.tank1"),value:"1"},{label:this.$t("reportForm.tank2"),value:"2"},{label:this.$t("reportForm.tank3"),value:"3"},{label:this.$t("reportForm.tank4"),value:"4"},{label:this.$t("reportForm.totalNotRun"),value:"99"}],oilStateList:[{label:this.$t("reportForm.refuel"),value:1},{label:this.$t("reportForm.leak"),value:-1}],begintimeStr:"",oilVolume:"",show:!1,messageBody:"",tableColumn:[{field:"speed",title:this.$t("reportForm.speed"),width:80},{field:"totalMileage",title:this.$t("reportForm.totalMileage"),width:120},{field:"totalad",title:this.$t("reportForm.totalOil"),width:100},{field:"totalnotrunningad",title:this.$t("reportForm.notRunTotalad"),width:120}]}},mixins:[x["a"]],components:{SingleChoiceVehicle:d["a"],SelectDate:c["a"],QuickTimeRange:u["a"],TimeOilEcharts:m["a"],ReportMap:h["a"],SplitPane:p["a"]},computed:Object(l["a"])(Object(l["a"])({},Object(n["b"])(["isZh","singleDeviceid","jumpOilReportDate","isDisabledOilRecords"])),{},{statisticsStyle:function(){return{zIndex:"tabTotal"==this.activeName?999:0}},detailsStyle:function(){return{zIndex:"details"==this.activeName?999:0}}}),watch:{dateRange:function(){this.loading||this.handleQuery()},deviceid:function(t){this.setSingleDeviceid(t)}},methods:Object(l["a"])(Object(l["a"])({},Object(n["c"])(["setSingleDeviceid","setJumpOilReportDate"])),{},{numberToFixed2:b["ob"],onResizingEnd:function(){var t=this;setTimeout((function(){t.$refs.echartsIns.resize()}),300)},queryAddress:function(t){var e=Object(b["Ob"])(t.callat),i=Object(b["Ob"])(t.callon),r=[{lat:e,lon:i}];Object($["u"])(r).then((function(e){var i=e.points;if(i.length>0){var r=i[0],a=r.address,o=r.status;0==o&&null!=a&&(Object(b["pb"])(t,a),t.address=a)}}))},queryTracks:function(t){var e=this;this.dialogMap=!0;var i=g["a"].longToLocalDateTimeStr(t.begintime-6e5),r=g["a"].longToLocalDateTimeStr(t.endtime+6e5),a={deviceid:t.deviceid,begintime:i,endtime:r,timezone:g["a"].getOffset()};Object($["X"])(a).then((function(t){var i=t.records;setTimeout((function(){i?e.$refs.mapIns.markersAndLineLayerToMap(i):e.$refs.mapIns.markersAndLineLayerToMap([])}),300)}))},delOilRecord:function(t){var e=this,i=t.rowIndex,r=t.row;Object(f["b"])(r).then((function(t){var r=t.status;0==r?(e.$delete(e.totalList,i),e.$XModal.message({message:e.$t("tips.deleteSucc"),status:"success",zIndex:9999})):e.$XModal.message({message:e.$t("tips.recordInUse"),status:"error",zIndex:9999})}))},cellclick:function(t){var e=t.row,i=t.rowIndex,r=e.updatetimeStr;this.$refs.echartsIns.chartsIns.setOption({xAxis:{axisPointer:{value:r}}});var a=this.detailsList.length-i-1;a>0&&this.$refs.echartsIns.chartsIns.dispatchAction({type:"showTip",seriesIndex:2,dataIndex:a})},cellDblclick:function(t){var e=this,i=t.row,r={deviceid:this.deviceid,updatetime:i.updatetime,trackid:i.trackid};Object(f["u"])(r).then((function(t){e.messageBody=JSON.stringify(t.track),e.show=!0}))},addOilRecord:function(){var t=this;if(this.deviceid){var e=g["a"].format(this.dateRange[0],"yyyy-MM-dd"),i=g["a"].format(this.dateRange[1],"yyyy-MM-dd"),r={deviceid:this.deviceid,begintime:g["a"].dateTimeStrToLong(e+" 00:00:00",0),endtime:g["a"].dateTimeStrToLong(i+" 23:59:59",0)},a=v["a"].deviceInfos[r.deviceid].devicename;Object(f["a"])(r).then((function(e){var i=e.status,r=e.oilRecord;0==i&&(r.devicename=a,r.oilindexStr=Object(b["V"])(r.oilindex),r.oilstateStr=1==r.oilstate?t.$t("reportForm.refuel"):t.$t("reportForm.leak"),r.begintimeStr=g["a"].longToLocalDateTimeStr(r.begintime),r.endtimeStr=g["a"].longToLocalDateTimeStr(r.endtime),r.oilstate=String(r.oilstate),r.oilindex=String(r.oilindex),r.editting=!1,r.saving=!1,r.oilVolume=0,r.soil=0,r.eoil=0,r.soil100=0,r.eoil100=0,r.durationStr=0,r.isSelected=!1,r.mauneditStr=1==r.maunedit?t.$t("header.yes"):t.$t("header.no"),t.totalList.push(r))}))}else this.$XModal.message({message:this.$t("tips.selectDevice"),status:"error",zIndex:9999})},rowClassName:function(t){var e=t.row;t.rowIndex;return e.isSelected?"row--current":1==e.maunedit?"row-yellow":""},cellClassName:function(t){var e=t.row,i=t.column;return"oilstateStr"===i.property&&1!=e.oilstate?"cell-color-red":""},onLegendChanged:function(t){var e=this.$t("reportForm.speed"),i=this.$t("reportForm.mileage"),r=this.$t("reportForm.totalOil"),a=this.$t("reportForm.notRunTotalad"),o=this.$t("reportForm.oil1"),s=this.$t("reportForm.oil2"),l=this.$t("reportForm.oil3"),n=this.$t("reportForm.oil4"),d=this.$t("reportForm.srcad0"),c=this.$t("reportForm.srcad1"),u=this.$t("reportForm.srcad2"),h=this.$t("reportForm.srcad3"),m=this.$t("reportForm.altitude"),p=this.$t("reportForm.voltage"),f=[];for(var g in t){var v=t[g];if(v)switch(g){case e:f.push({field:"speed",title:this.$t("reportForm.speed"),width:80});break;case i:f.push({field:"totalMileage",title:this.$t("reportForm.totalMileage"),width:120});break;case r:f.push({field:"totalad",title:this.$t("reportForm.totalOil"),width:100});break;case a:f.push({field:"totalnotrunningad",title:this.$t("reportForm.notRunTotalad"),width:120});break;case o:f.push({field:"ad0",title:this.$t("reportForm.oil1"),width:80});break;case s:f.push({field:"ad1",title:this.$t("reportForm.oil2"),width:80});break;case l:f.push({field:"ad2",title:this.$t("reportForm.oil3"),width:80});break;case n:f.push({field:"ad3",title:this.$t("reportForm.oil4"),width:80});break;case d:f.push({field:"srcad0",title:this.$t("reportForm.srcad0"),width:80});break;case c:f.push({field:"srcad1",title:this.$t("reportForm.srcad1"),width:80});break;case u:f.push({field:"srcad2",title:this.$t("reportForm.srcad2"),width:80});break;case h:f.push({field:"srcad3",title:this.$t("reportForm.srcad3"),width:80});break;case m:f.push({field:"altitude",title:this.$t("reportForm.altitude"),width:80});break;case p:f.push({field:"voltage",title:this.$t("reportForm.voltage"),width:80});break}}this.tableColumn=f},scrollToRow:function(t){var e=t.rowIndex,i=this.detailsList[this.detailsList.length-1-e];this.$refs.xTable.setCurrentRow(i),this.$refs.xTable.scrollToRow(i,null),this.begintimeStr=i.updatetimeStr,this.oilVolume=i.totalad},onClickMarkPoint:function(t){this.handleCurrentRow({row:t}),this.$refs.oilxTable.setCurrentRow(t),this.$refs.oilxTable.scrollToRow(t,null)},handleCurrentRow:function(t){var e=t.row;this.totalList.forEach((function(t){t.isSelected=!1})),e.isSelected=!0},handleQuery:function(){var t=this;return Object(s["a"])(Object(o["a"])().mark((function e(){var i,r,a,s,l,n,d,c,u,h,m,p,$;return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i=t.isZh,r=t.deviceid,a=t.dateRange,""!=r){e.next=6;break}return t.$XModal.message({message:t.$t("tips.selectDevice"),status:"error",zIndex:9999}),e.abrupt("return");case 6:if(0!=a.length){e.next=9;break}return t.$XModal.message({message:t.$t("tips.selectTime"),status:"error",zIndex:9999}),e.abrupt("return");case 9:return t.loading=!0,e.next=12,t.queryOilRecords();case 12:s=e.sent,l=s.records,n=s.addressmap,d=l?l[0]:null,c=[],d?(u=d.deviceid,h=d.records,c=t.getOilRecordsList(u,h,n)):t.tableTitle="",t.totalList=c,m=g["a"].format(a[0],"yyyy-MM-dd"),p=g["a"].format(a[1],"yyyy-MM-dd"),$={startday:m,endday:p,offset:g["a"].getOffset(),devices:[r]},t.tableTitle=v["a"].getDeviceNameByDeviceId(r)+" - "+r+" "+t.tableTitle,Object(f["fb"])($).then((function(e){var r=e.records;t.loading=!1;var a=r[0],o=[];if(a&&a.records){var s=a.deviceid,l=v["a"].deviceInfos[s].devicename,n=a.records;n&&n.sort((function(t,e){return t.updatetime-e.updatetime})),n.forEach((function(e){var r=Object(b["J"])(e);e.devicename=l,e.deviceid=s,e.totalad=e.totalad/100,e.totalnotrunningad=e.totalnotrunningad/100,e.updatetimeStr=g["a"].longToLocalDateTimeStr(e.updatetime),e.arrivedtimeStr=g["a"].longToLocalDateTimeStr(e.arrivedtime),e.reissue=0==e.reissue?"":t.$t("header.yes"),e.status=i?e.strstatus:e.strstatusen,e.speed=Number((e.speed/1e3).toFixed(0)),e.totalMileage=e.totaldistance/1e3,e.lonLat="".concat(e.callon,",").concat(e.callat),e.ad0=e.ad0/100,e.ad1=e.ad1/100,e.ad2=e.ad2/100,e.ad3=e.ad3/100,e.address=r,o.unshift(e)}))}o.sort((function(t,e){return e.updatetime-t.updatetime})),t.detailsList=o,t.$refs.echartsIns.updateChartsOption(a.records,t.totalList)}));case 23:case"end":return e.stop()}}),e)})))()},queryOilRecords:function(){var t=this.deviceid,e=this.dateRange;if(""!=t){if(0!=e.length){var i=g["a"].format(e[0],"yyyy-MM-dd"),r=g["a"].format(e[1],"yyyy-MM-dd"),a={startday:i,endday:r,offset:g["a"].getOffset(),devices:[t],oilstate:99,oilindex:0};return Object(f["db"])(a)}this.$XModal.message({message:this.$t("tips.selectTime"),status:"error",zIndex:9999})}else this.$XModal.message({message:this.$t("tips.selectDevice"),status:"error",zIndex:9999})},getOilRecordsList:function(t,e,i){var r=this,a=0,o=0,s=[],l=v["a"].deviceInfos[t].devicename;return e.forEach((function(e){if(e){var n=e.oilstate;-1!=n&&1!=n||(e.devicename=l||t,e.oilindexStr=Object(b["V"])(e.oilindex),e.oilstateStr=1==e.oilstate?r.$t("reportForm.refuel"):r.$t("reportForm.leak"),e.begintimeStr=g["a"].longToLocalDateTimeStr(e.begintime),e.endtimeStr=g["a"].longToLocalDateTimeStr(e.endtime),e.eoil100=e.eoil/100,e.soil100=e.soil/100,e.oilstate=String(n),e.oilindex=String(e.oilindex),e.editting=!1,e.saving=!1,e.oilVolume=Math.abs(e.eoil100-e.soil100),e.durationStr=e.duration/1e3/3600,e.mauneditStr=1==e.maunedit?r.$t("header.yes"):r.$t("header.no"),e.address=Object(b["M"])(i,e.slat,e.slon),e.isSelected=!1,s.push(e)),1==n?a+=e.oilVolume:-1==n&&(o+=e.oilVolume)}})),this.tableTitle=this.$t("reportForm.refuel")+":"+Number(a.toFixed(2))+"L "+this.$t("reportForm.leak")+":"+Number(o.toFixed(2))+"L",s.sort((function(t,e){return t.begintime-e.begintime})),s},changeOilRecord:function(){this.isEditing&&(this.editRow.oilVolume=1e3,this.editRow.eoil=999,console.log(this.editRow),this.editRow.begintimeStr="2022-0-22 00:00:10")},changeStatrOil:function(){if(this.isEditing){var t=this.editRow,e=this.begintimeStr,i=this.oilVolume;t.soil100=i,t.eoil100>t.soil100?(t.oilstate=1,t.oilstateStr=this.$t("reportForm.refuel"),t.begintimeStr=e):(t.oilstate=-1,t.oilstateStr=this.$t("reportForm.leak"),t.begintimeStr=e),t.oilVolume=Math.abs(Number((t.soil100-t.eoil100).toFixed(2)))}},changeEndOilRecord:function(){if(this.isEditing){var t=this.editRow,e=this.begintimeStr,i=this.oilVolume;t.eoil100=i,t.eoil100>t.soil100?(t.oilstate=1,t.oilstateStr=this.$t("reportForm.refuel"),t.endtimeStr=e):(t.oilstate=-1,t.oilstateStr=this.$t("reportForm.leak"),t.endtimeStr=e),t.oilVolume=Math.abs(Number((t.soil100-t.eoil100).toFixed(2)))}},editRowEvent:function(t){this.editRow=t,this.isEditing=!0,this.$refs.oilxTable.setActiveRow(t)},saveRowEvent:function(t){var e=this;this.isEditing=!1,t.begintime=new Date(t.begintimeStr).getTime(),t.endtime=new Date(t.endtimeStr).getTime(),t.oilVolume=Number(Math.abs(t.eoil100-t.soil100).toFixed(2));var i=JSON.parse(JSON.stringify(t));i.eoil=100*i.eoil100,i.soil=100*i.soil100,t.eoil100-t.soil100>0?(t.oilstate=1,t.oilstateStr=this.$t("reportForm.refuel")):(t.oilstate=-1,t.oilstateStr=this.$t("reportForm.leak")),Object(f["i"])(i).then((function(i){var r=i.status;i.cause;0==r?(t.maunedit=1,e.$refs.oilxTable.clearActived(),e.$XModal.message({message:e.$t("tips.editSucc"),status:"success",zIndex:9999})):1==r?e.$XModal.message({message:e.$t("tips.recordInUse"),status:"error",zIndex:9999}):(e.cancelRowEvent(t),e.$XModal.message({message:e.$t("tips.editFail"),status:"error",zIndex:9999}))}))},cancelRowEvent:function(t){var e=this,i=this.$refs.oilxTable;i.clearActived().then((function(){e.isEditing=!1,i.revertData(t)}))},exportData:function(){var t=[[this.$t("reportForm.index"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("reportForm.updatetimeStr"),this.$t("reportForm.arrivedtimeStr"),this.$t("reportForm.speed"),this.$t("reportForm.totalMileage"),this.$t("reportForm.totalOil"),this.$t("reportForm.notRunTotalad"),this.$t("reportForm.oil1"),this.$t("reportForm.oil2"),this.$t("reportForm.oil3"),this.$t("reportForm.oil4"),this.$t("reportForm.srcad0"),this.$t("reportForm.srcad1"),this.$t("reportForm.srcad2"),this.$t("reportForm.srcad3"),this.$t("reportForm.altitude"),this.$t("reportForm.voltage"),this.$t("reportForm.reissue"),this.$t("reportForm.status"),this.$t("reportForm.lonLat")]];if(0!=this.detailsList.length){var e="";this.detailsList.forEach((function(i,r){0==r&&(e=i.deviceid);var a=[];a.push(r+1),a.push(i.devicename),a.push(i.deviceid),a.push(i.updatetimeStr),a.push(i.arrivedtimeStr),a.push(Object(b["ob"])(i.speed)),a.push(Object(b["ob"])(i.totalMileage)),a.push(Object(b["ob"])(i.totalad)),a.push(Object(b["ob"])(i.totalnotrunningad)),a.push(i.ad0),a.push(i.ad1),a.push(i.ad2),a.push(i.ad3),a.push(i.srcad0),a.push(i.srcad1),a.push(i.srcad2),a.push(i.srcad3),a.push(i.altitude),a.push(i.voltage),a.push(i.reissue),a.push(i.status),a.push(i.lonLat),t.push(a)}));var i={title:this.$t("reportForm.timeOil")+"-"+e,data:t};this.exportLoading1=!0,new ExcelCls(i).exportExcel(this)}}}),mounted:function(){var t=this;this.singleDeviceid&&(this.deviceid=this.singleDeviceid,null!=this.jumpOilReportDate&&this.$nextTick((function(){var e=t.jumpOilReportDate;t.dateRange=[new Date(e),new Date(e)],t.setJumpOilReportDate(null)})))}},y=w,S=(i("4b0a4"),i("2877")),F=Object(S["a"])(y,r,a,!1,null,null,null),O=F.exports;e["default"]=O}}]);