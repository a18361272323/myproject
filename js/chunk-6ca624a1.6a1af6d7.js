(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6ca624a1"],{"4c3c":function(e,t,a){"use strict";a("4e82");t["a"]={data:function(){return{sortConfig:{sortMethod:function(e){var t=e.data,a=e.sortList,i=a[0],s=i.property,n=i.order,r=[];return r="desc"===n?t.sort((function(e,t){var a=e[s],i=t[s];if(isNaN(a)&&!isNaN(Date.parse(a))&&isNaN(i)&&!isNaN(Date.parse(i)))return Date.parse(i)-Date.parse(a);if(a=parseFloat(a),i=parseFloat(i),isNaN(a)||isNaN(i)){var n=t[s]+"";return n.localeCompare(e[s])}return i-a})):"asc"===n?t.sort((function(e,t){var a=e[s],i=t[s];if(isNaN(a)&&!isNaN(Date.parse(a))&&isNaN(i)&&!isNaN(Date.parse(i)))return Date.parse(a)-Date.parse(i);if(a=parseFloat(e[s]),i=parseFloat(t[s]),isNaN(a)||isNaN(i)){var n=e[s]+"";return n.localeCompare(t[s])}return a-i})):t.sort(),r}}}}}},"7a12":function(e,t,a){"use strict";a.r(t);a("498a");var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"unclaimed full"},[t("div",{staticClass:"unclaimed-header"},[t("div",{staticClass:"f_left",staticStyle:{width:"210px"}},[t("LabelWrap",{attrs:{label:e.$t("bgManage.queryDevice"),showLabel:!1}},[t("el-input",{attrs:{clearable:"",placeholder:e.$t("bgManage.pleaseEnterSearchDeviceid")},model:{value:e.queryText,callback:function(t){e.queryText="string"===typeof t?t.trim():t},expression:"queryText"}})],1)],1),t("div",{staticClass:"f_left"},[t("el-button",{staticStyle:{width:"90px"},attrs:{type:"primary",loading:e.loading},on:{click:e.handleClickQuery}},[e._v(e._s(e.$t("common.query")))])],1),t("div",{staticClass:"f_left",staticStyle:{"line-height":"34px"}},[t("span",{staticStyle:{"font-size":"12px"}},[e._v(" "+e._s(e.$t("bgManage.currentUnclaimedEquipment"))+" : "+e._s(e.totalcount))])])]),t("div",{staticClass:"unclaimed-content",staticStyle:{top:"39px"}},[t("vxe-table",{attrs:{"sort-config":e.sortConfig,"menu-config":e.tableMenu,border:"","auto-resize":"",resizable:"","show-overflow":"","highlight-current-row":"",size:"mini",height:"auto",data:e.tableList},on:{"menu-click":e.handleClickTableMenu}},[t("vxe-table-column",{attrs:{type:"seq",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{field:"deviceid",sortable:"",title:e.$t("alarm.devNum"),width:"120"}}),t("vxe-table-column",{attrs:{field:"updatetimeStr",sortable:"",title:e.$t("reportForm.time"),width:"145"}}),t("vxe-table-column",{attrs:{field:"protocolType",sortable:"",title:e.$t("bgManage.protocolType"),width:"100"}}),t("vxe-table-column",{attrs:{title:e.$t("reportForm.address"),width:"160"},scopedSlots:e._u([{key:"default",fn:function(a){return[null==a.row.address?t("el-button",{staticStyle:{color:"#000000"},attrs:{type:"text"},on:{click:function(t){return e.handleQueryAddress(a)}}},[e._v(e._s(e.$t("reportForm.getAddress")))]):t("span",[e._v(e._s(a.row.address))])]}}])}),t("vxe-table-column",{attrs:{title:e.$t("reportForm.lonLat"),width:"180"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{staticStyle:{color:"red"},attrs:{type:"text"},on:{click:function(t){return e.handleSeeMap(a)}}},[e._v(e._s(a.row.callon)+","+e._s(a.row.callat))])]}}])}),t("vxe-table-column",{attrs:{title:e.$t("reportForm.action"),width:"95"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleAdd(a)}}},[e._v(" "+e._s(e.$t("common.addDevice")))])]}}])}),t("vxe-table-column",{attrs:{field:"packetDescr",title:e.$t("bgManage.packetDescr")}})],1)],1),t("el-dialog",{attrs:{title:e.$t("bgManage.addDevice"),center:"",visible:e.visible,width:"360px","append-to-body":"","close-on-click-modal":!1},on:{close:function(t){e.visible=!1}}},[t("div",{staticClass:"margin_b10"},[t("DropdownZtreeUser",{attrs:{label:e.$t("reportForm.creater")},model:{value:e.creater,callback:function(t){e.creater=t},expression:"creater"}})],1),t("div",{staticClass:"margin_b10"},[t("LabelWrap",{attrs:{label:e.$t("alarm.devNum")}},[t("el-input",{attrs:{disabled:""},model:{value:e.deviceid,callback:function(t){e.deviceid=t},expression:"deviceid"}})],1)],1),t("div",{staticClass:"margin_b10"},[t("LabelWrap",{attrs:{label:e.$t("reportForm.deviceType")}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"","filter-method":e.deviceTypeFilterMethod},model:{value:e.deviceType,callback:function(t){e.deviceType=t},expression:"deviceType"}},e._l(e.deviceTypes,(function(e,a){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("div",{staticClass:"margin_b10"},[t("LabelWrap",{attrs:{label:e.$t("alarm.devName")}},[t("el-input",{model:{value:e.devicename,callback:function(t){e.devicename="string"===typeof t?t.trim():t},expression:"devicename"}})],1)],1),t("el-row",{attrs:{gutter:10}},[t("el-col",{staticStyle:{"text-align":"center"},attrs:{span:8,offset:8}},[t("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary",loading:e.addLoading},on:{click:e.handleAddDevice}},[e._v(e._s(e.$t("common.determine")))])],1),t("el-col",{staticStyle:{"line-height":"32px"},attrs:{span:2,offset:1}},[t("el-tooltip",{attrs:{placement:"top",effect:"light"}},[t("div",{attrs:{slot:"content"},slot:"content"},[t("div",[e._v(e._s(e.$t("tips.addNewDeviceTip1")))]),t("div",[e._v(e._s(e.$t("tips.addNewDeviceTip2")))]),t("div",[e._v(e._s(e.$t("tips.addNewDeviceTip3")))]),t("div",[e._v(e._s(e.$t("tips.addNewDeviceTip4")))])]),t("i",{staticClass:"el-icon-warning-outline new-add-tips-icon",staticStyle:{"font-size":"18px",cursor:"pointer"}})])],1)],1)],1),t("el-dialog",{attrs:{title:e.$t("reportForm.seeMap"),center:"",visible:e.mapDialog,width:"560px","append-to-body":"","close-on-click-modal":!1},on:{close:function(t){e.mapDialog=!1}}},[t("div",{staticStyle:{width:"100%",height:"400px"}},[t("ReportMap",{ref:"mapIns"})],1)])],1)},s=[],n=a("5530"),r=(a("d3b7"),a("159b"),a("4795"),a("32eb")),l=a("7ef3"),o=a("201d"),c=a("e285"),d=a("5101"),u=a("2f62"),p=a("c276"),v=a("6e52"),b=a("7cf8"),m=a("4c3c"),f=a("a05b"),h={name:"Unclaimed",data:function(){return{visible:!1,mapDialog:!1,loading:!1,addLoading:!1,queryText:"",tableList:[],deviceTypes:[],totalcount:"",creater:"",deviceid:"",devicename:"",deviceType:1}},mixins:[m["a"],f["a"]],components:{LabelWrap:o["a"],DropdownZtreeUser:l["a"],ReportMap:r["a"]},computed:Object(n["a"])(Object(n["a"])({},Object(u["b"])(["isZh","isQueryInitData","deviceTypeList","userName"])),{},{deviceObjectTypes:function(){return this.$store.state.deviceTypes}}),watch:{isQueryInitData:function(e){var t=this;e&&this.$nextTick((function(){t.deviceTypes=t.deviceTypeList}))}},methods:Object(n["a"])(Object(n["a"])({},Object(u["c"])(["setIsReloadRootuser","setIsUpdateVideoList","setReportTagList"])),{},{deviceTypeFilterMethod:p["h"],handleQueryAddress:function(e){var t=e.row,a=[{lat:t.callat,lon:t.callon}];Object(b["u"])(a).then((function(e){var a=e.points;if(a&&a.length>0){var i=a[0],s=i.status,n=i.address;0==s&&null!=n&&(Object(p["ob"])({callat:t.callat,callon:t.callon},n),t.address=n)}}))},handleSeeMap:function(e){var t=this;this.mapDialog=!0,setTimeout((function(){t.$refs.mapIns.singleMarkerToMap(e.row)}),300)},handleClickQuery:function(){var e=this;this.loading=!0;var t=this.queryText;Object(c["ab"])(t).then((function(t){var a=t.devices,i=t.totalcount;e.loading=!1;var s=[];a&&(a.forEach((function(e){e.callon=Object(p["Nb"])(e.callon),e.callat=Object(p["Nb"])(e.callat),e.address=Object(p["I"])(e),e.updatetimeStr=d["a"].longToLocalDateTimeStr(e.updatetime)})),s=a),e.totalcount=i,e.tableList=s})).catch((function(t){e.loading=!1}))},handleAdd:function(e){this.visible=!0;var t=e.row;this.rowIndex=e.rowIndex,this.creater=this.userName,this.deviceid=t.deviceid},handleAddDevice:function(){var e=this,t={deviceid:this.deviceid,devicename:this.devicename?this.devicename:this.deviceid,creater:this.creater,devicetype:this.deviceType,expirenotifytime:Date.now()+31536e6,loginenable:1,deviceenable:1,reportedpoint:0};this.addLoading=!0,Object(c["c"])(t).then((function(t){var a=t.status,i=t.device;e.addLoading=!1,0==a?(i.hasFunctions=Object(p["C"])(i,e.deviceObjectTypes),console.log("device.hasFunctions",i.hasFunctions),i.groupname=e.$t("common.defaultGroup"),v["a"].addDevice(i),v["a"].deviceInfos[i.deviceid]=i,i.hasFunctions.isHasVideo&&e.setIsUpdateVideoList(!0),e.setReportTagList([]),e.setIsReloadRootuser(!0),e.visible=!1,e.$delete(e.tableList,e.rowIndex),e.$XModal.message({message:e.$t("tips.addSucc"),status:"success",zIndex:9999})):91==a?e.$XModal.message({message:e.$t("tips.noPermission"),status:"error",zIndex:9999}):e.$XModal.message({message:e.$t("tips.addFail")+":"+cause,status:"error",zIndex:9999})}))}}),mounted:function(){var e=this;this.handleClickQuery(),this.isQueryInitData&&this.$nextTick((function(){e.deviceTypes=e.deviceTypeList}))}},y=h,g=(a("b2d6c"),a("2877")),x=Object(g["a"])(y,i,s,!1,null,null,null),w=x.exports;t["default"]=w},b2d6c:function(e,t,a){"use strict";a("ecd8")},ecd8:function(e,t,a){}}]);